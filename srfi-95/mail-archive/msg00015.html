<!-- MHonArc v2.6.15 -->
<!--X-Subject: Re: Wording of the rationale -->
<!--X-From-R13: =?WEA&#45;8859&#45;1?C?Xraf_Okry_E=T8tnneq?= <wrafnkryNfbrtnneq.arg> -->
<!--X-Date: Tue, 14 Nov 2006 14:55:28 +0100 (MET) -->
<!--X-Message-Id: 4559CAB4.6070601@soegaard.net -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 455080C2.2090103@soegaard.net -->
<!--X-Reference: 20061112234042.E84F051D732@home.voluntocracy.org -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Wording of the rationale</title>
<link rev="made" href="mailto:jensaxel@soegaard.net">
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00014.html">Date Prev</a>][<a href="msg00016.html">Date Next</a>][<a href="msg00014.html">Thread Prev</a>][<a href="msg00017.html">Thread Next</a>][<a href="maillist.html#00015">Date Index</a>][<a href="threads.html#00015">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: Wording of the rationale</h1>
<p style="max-width: 30em;">This page is part of the web mail archives of <a href="http://srfi.schemers.org/srfi-95">SRFI 95</a> from before July 7th, 2015.  The new archives for SRFI 95 are <a href="http://srfi-email.schemers.org/srfi-95/">here</a>.  The new archives contain all messages, not just those from before July 7th, 2015.</p>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: Aubrey Jaffer &lt;<a href="mailto:agj%40alum.mit.edu">agj@alum.mit.edu</a>&gt;</li>
<li><em>Subject</em>: Re: Wording of the rationale</li>
<li><em>From</em>: Jens Axel S&#xF8;gaard &lt;<a href="mailto:jensaxel%40soegaard.net">jensaxel@soegaard.net</a>&gt;</li>
<li><em>Date</em>: Tue, 14 Nov 2006 14:55:00 +0100</li>
<li><em>Cc</em>: <a href="mailto:srfi-95%40srfi.schemers.org">srfi-95@srfi.schemers.org</a></li>
<li><em>Delivered-to</em>: <a href="mailto:srfi-95%40srfi.schemers.org">srfi-95@srfi.schemers.org</a></li>
<li><em>In-reply-to</em>: &lt;<a href="mailto:20061112234042.E84F051D732%40home.voluntocracy.org"><a href="msg00010.html">20061112234042.E84F051D732@home.voluntocracy.org</a></a>&gt;</li>
<li><em>References</em>: &lt;<a href="mailto:455080C2.2090103%40soegaard.net"><a href="msg00006.html">455080C2.2090103@soegaard.net</a></a>&gt; &lt;<a href="mailto:20061112234042.E84F051D732%40home.voluntocracy.org"><a href="msg00010.html">20061112234042.E84F051D732@home.voluntocracy.org</a></a>&gt;</li>
<li><em>User-agent</em>: Thunderbird 1.5.0.8 (Windows/20061025)</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">
Aubrey Jaffer wrote:

&gt; | Date: Tue, 07 Nov 2006 13:55:54 +0100
&gt; | From: =?ISO-8859-1?Q?Jens_Axel_S=F8gaard?= &lt;jensaxel@soegaard.net&gt;
&gt; |
&gt; | I forgot to add the following.
&gt; |
&gt; | It would be a good idea to reformulate the rationale in its
&gt; | own terms, so it can be understood without knowing anything
&gt; | about srfi-32.

&gt; [I am redirecting this to D. Horn because it is an editorial
&gt; question.]

&gt; Are you suggesting that SRFI-95 list the 28 procedures of SRFI-32?

No.

&gt; What might make more sense is to remove mention of SRFI-32 altogether;
&gt; SRFI-95 is derived from SLIB.

That was what I was attempting to suggest.


To me a rationale explains the reasoning behind the choices made.
The rationales for srfi-32 and srfi-95 aren't the same. I was
trying to argue that both rationales are valid.

That's why I think the wording of the srfi-95 rationale should
be changes. For example in:

&gt;  |      These 28 arose for several reasons:
&gt;  |
&gt;  |         * List and Vector versions were separated, even though
&gt;  |         Scheme has manifest types which eliminate ambiguity as to
&gt;  |         the caller's intentions.

The &quot;even though&quot; implies that the choices Shivers made were wrong.
But given the srfi-32 rationale, they make perfect sense. Of course
under the srfi-95 rationale, different choices make sense.

Your formulations what general purpose libraries are about:

&gt; General purpose software libraries are about simplicity and ease of
&gt; use, not theoretical perfection in algorithm design.
&gt;
&gt; A library should be specified so that its routines will perform
&gt; moderately well for moderately sized inputs in the vast majority of
&gt; applications.  Having many variants has disadvantages:
&gt;
&gt;  * When there are only a few paths through the code, the code gets
&gt;    thoroughly tested and its behavior well understood.  When there are
&gt;    many paths, most of the code is not well tested and not well
&gt;    understood.
&gt;
&gt;  * To optimally choose algorithms requires nearly as much
&gt;    understanding as to write them.  Most users don't.
&gt;
&gt;  * A module with too many functions and voluminous documentation
&gt;    scares off the typical user looking to just sort a 50-element list;
&gt;    who then goes searching for any old sort algorithm to reinvent the
&gt;    wheel.
&gt;
&gt;  * If some of the default sorts are unstable, then users will be
&gt;    surprised that sorting their data twice results in different
&gt;    orders; or that vector and list sorts return different orders.

explanins much better, why the choices were made, than the current
wording which compares the choices of srfi-95 to srfi-32.


The above is the main point of this posting.


Aubrey Jaffer wrote:
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
 | Date: Tue, 07 Nov 2006 13:49:06 +0100
 | From: =?ISO-8859-1?Q?Jens_Axel_S=F8gaard?= &lt;jensaxel@soegaard.net&gt;
</pre></blockquote><pre style="margin: 0em;">
...
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
 |      These 28 arose for several reasons:
</pre><tt> | 
</tt><tt> |         * List and Vector versions were separated, even though
</tt><pre style="margin: 0em;">
 |         Scheme has manifest types which eliminate ambiguity as to
 |         the caller's intentions.
</pre><tt> | 
</tt><tt> | Separating list and vector functions are tradition.  In R5RS we
</tt><pre style="margin: 0em;">
 | have, for example list-ref, vector-ref and string-ref instead of
 | general ref.  One benefit of this choice is that compilers get a
 | fair chance to generate efficient code.

LIST-REF and VECTOR-REF are primitive operations which compilers can
inline.  It is conceivable that some really advanced compiler could
inline merge, but merge is alread restricted to lists!

Sort is a more complicated operation than merge.  The cost of the
single type predicate conditional to detect array versus list is going
to be significant only when sort is called with a trivially short
argument.  It is reasonable to expect that library routines will be
slower than inline code on these degenerate cases.
</pre></blockquote><pre style="margin: 0em;">

I am not disagreing. I merely saying, that there is more than one
valid view. The list-ref, vector-ref, ... way of constructing names
has, probably due to the lack of a module system, been in widespread
use. That's why I don't like the &quot;even though&quot;.

As a minor point, in

   (let ([v (vector-sort &lt;a-large-vector&gt;)])
     &lt;loop with (vector-ref v)&gt;)

the compiler has a better chance to figure out at compile time
that v is bound to a vector, than if a genereal sort is used.

</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
 |         * Four varieties of algorithms were provided (quick, heap,
 |         insert, merge) even though quick, heap, and insert sorts
 |         have no significant advantage over merge-sort.
</pre><tt> | 
</tt><tt> | First: The choice between these algorithms were in the &quot;How
</tt><pre style="margin: 0em;">
 | to&quot;-part of SRFI-32.  If a user doesn't care, which algorithm is
 | used, he can use list-sort!, vector-sort!.
</pre><tt> | 
</tt><tt> | Second: What does &quot;no significant advantage&quot; mean?
</tt><pre style="margin: 0em;">

It means that the asymptotics or functional properties are no better.
</pre></blockquote><pre style="margin: 0em;">

I like that formulation better.

The &quot;no significant advantage&quot; will be true most of the time, but
for some people for special programs, constant factors do matter.

</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
 | I were of the impression, that the &quot;hidden constants&quot; of O(n log
 | (n)) of vector-quick-sort were smaller than that of
 | vector-merge-sort.

Is that from reading SRFI-32?
</pre></blockquote><pre style="margin: 0em;">

No. It was just an impression.

</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
SRFI-95 does not mandate merge-sort.  It mandates that the sort
algorithm be stable and that asymptotic time for SORT be bounded by
O(n log(n)).
</pre></blockquote><pre style="margin: 0em;">

Again, I was trying to argue, that to some people it will be an
advantage to be able to choose the specific algorithm. With your
rationale (general purpose sorting) it is quite reasonable to
chose a single sorting algorithm. With the srfi-32 rationale,
where completeness is part of the rationale, it makes sense
to include all standard sorting algorithms.

That's why I think this section should be reworded:

    * Four varieties of algorithms were provided (quick,
      heap, insert, merge) even though quick, heap, and
      insert sorts have no significant advantage over
      merge-sort.

Based on the srfi-95 rationale the wording implies that
the srfi-32 choices were wrong.


</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
 | Third: The different algorithms have different memory requirements.
 | If very large vectors are sorted, it makes sense to choose a slower
 | algorithm that allocates very little extra memory.  Some versions
 | of vector-merge-sort! allocate a helper array the size of the
 | original.

<a  rel="nofollow" href="http://en.wikipedia.org/wiki/Sorting_algorithm">http://en.wikipedia.org/wiki/Sorting_algorithm</a> has a table of
properties for sort algorithms.  &quot;In-place merge sort&quot; is shown as
stable, O(n log(n)) time, and using no additional memory.

SRFI-95's requirement that the KEY argument be called at most once per
element necessitates allocation of O(n) storage for SORT when a KEY
argument is supplied.  The current reference implementation always
does; I will clone its routine to handle the no-KEY case efficiently.
</pre></blockquote><pre style="margin: 0em;">

Okay.

</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
 | Also: Is merge-sort the fastest algorithm, if the elements are
 | &quot;almost sorted&quot;?
</pre><tt> | 
</tt><tt> |        * Sort and stable-sort varieties were included, even though
</tt><pre style="margin: 0em;">
 |        an unstable sort has no performance advantage.
</pre><tt> | 
</tt><tt> | As I see it, the reason they are in SRFI-32 is not efficiency but
</tt><pre style="margin: 0em;">
 | completeness.  Nevertheless, if vector-quick-sort! (which is
 | unstable) is faster than vector-merge-sort! (which is stable) then

&quot;Faster&quot; _is_ about efficiency, isn't it?
</pre></blockquote><pre style="margin: 0em;">

Yes - I was contradicting myself.

Completeness allows efficiency in situations were you know enough
about the data, to be able to choose the best between several
algorithms.


--
Jens Axel S&#xF8;gaard


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00017" href="msg00017.html">Re: Wording of the rationale</a></strong>
<ul><li><em>From:</em> Jens Axel S&#xF8;gaard &lt;jensaxel@soegaard.net&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00006" href="msg00006.html">Wording of the rationale</a></strong>
<ul><li><em>From:</em> Jens Axel S&#xF8;gaard &lt;jensaxel@soegaard.net&gt;</li></ul></li>
<li><strong><a name="00010" href="msg00010.html">Re: Wording of the rationale</a></strong>
<ul><li><em>From:</em> Aubrey Jaffer &lt;agj@alum.mit.edu&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00014.html">Re: Wording of the rationale</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00016.html">Re: Memory use of sort!</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00014.html">Re: Wording of the rationale</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00017.html">Re: Wording of the rationale</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00015"><strong>Date</strong></a></li>
<li><a href="threads.html#00015"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
