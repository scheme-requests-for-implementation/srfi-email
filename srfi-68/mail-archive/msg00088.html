<!-- MHonArc v2.6.15 -->
<!--X-Subject: Re: Specification vs. Implementation -->
<!--X-From-R13: [vpunry Ecreore <fcreoreNvasbezngvx.hav&#45;ghrovatra.qr> -->
<!--X-Date: Thu, 25 Aug 2005 18:45:05 +0200 (MST) -->
<!--X-Message-Id: y9lslwyc6en.fsf@sams.informatik.uni&#45;tuebingen.de -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 5fb7e0870508221948311ded7f@mail.gmail.com -->
<!--X-Reference: y9loe7pnmiw.fsf@sams.informatik.uni&#45;tuebingen.de -->
<!--X-Reference: 5fb7e0870508231948c0506fa@mail.gmail.com -->
<!--X-Reference: y9lbr3njkjf.fsf@sams.informatik.uni&#45;tuebingen.de -->
<!--X-Reference: 5fb7e08705082418335a20cdf8@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Specification vs. Implementation</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00087.html">Date Prev</a>][<a href="msg00089.html">Date Next</a>][<a href="msg00084.html">Thread Prev</a>][<a href="msg00095.html">Thread Next</a>][<a href="maillist.html#00088">Date Index</a>][<a href="threads.html#00088">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: Specification vs. Implementation</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: Alex Shinn &lt;<a href="mailto:alexshinn@DOMAIN.HIDDEN">alexshinn@xxxxxxxxx</a>&gt;</li>
<li><em>Subject</em>: Re: Specification vs. Implementation</li>
<li><em>From</em>: Michael Sperber &lt;<a href="mailto:sperber@DOMAIN.HIDDEN">sperber@xxxxxxxxxxxxxxxxxxxxxxxxxxx</a>&gt;</li>
<li><em>Date</em>: Thu, 25 Aug 2005 18:45:04 +0200</li>
<li><em>Cc</em>: <a href="mailto:srfi-68@DOMAIN.HIDDEN">srfi-68@xxxxxxxxxxxxxxxxx</a></li>
<li><em>Delivered-to</em>: <a href="mailto:srfi-68@DOMAIN.HIDDEN">srfi-68@xxxxxxxxxxxxxxxxx</a></li>
<li><em>In-reply-to</em>: &lt;<a href="mailto:5fb7e08705082418335a20cdf8@DOMAIN.HIDDEN">5fb7e08705082418335a20cdf8@xxxxxxxxxxxxxx</a>&gt; (Alex Shinn's message	of &quot;Thu, 25 Aug 2005 10:33:37 +0900&quot;)</li>
<li><em>References</em>: &lt;<a href="mailto:5fb7e0870508221948311ded7f@DOMAIN.HIDDEN">5fb7e0870508221948311ded7f@xxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:y9loe7pnmiw.fsf@DOMAIN.HIDDEN">y9loe7pnmiw.fsf@xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:5fb7e0870508231948c0506fa@DOMAIN.HIDDEN">5fb7e0870508231948c0506fa@xxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:y9lbr3njkjf.fsf@DOMAIN.HIDDEN">y9lbr3njkjf.fsf@xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:5fb7e08705082418335a20cdf8@DOMAIN.HIDDEN">5fb7e08705082418335a20cdf8@xxxxxxxxxxxxxx</a>&gt;</li>
<li><em>User-agent</em>: Gnus/5.110003 (No Gnus v0.3) XEmacs/21.5-b21 (berkeley-unix)</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>
Alex Shinn &lt;alexshinn@xxxxxxxxx&gt; writes:

&gt; On 8/25/05, Michael Sperber &lt;sperber@xxxxxxxxxxxxxxxxxxxxxxxxxxx&gt; wrote:
&gt;&gt; 
&gt;&gt; I don't understand why it would be a lot of work---that's what the
&gt;&gt; reference implementation is for.  Just drop it in.  You mainly have to
&gt;&gt; adapt the primitive I/O layer, which is usually pretty simple.  (You
&gt;&gt; could even build it easily on a pre-existing ports layer.)
&gt;
&gt; You also have to rewrite your existing ports layer to distinguish
&gt; between the original native ports and the new stream-based ports.

That doesn't seem to be a lot of work.

&gt; There's also still a lot missing from SRFI-68 since it doesn't provide
&gt; more than some trivial transcoders, and in cases like C's wchar
&gt; implementation there is no direct way to transcode wstrings - you
&gt; have to use an external library like iconv.

Sure---but you were asking about the effort it takes to add SRFI 68 to
an existing ports system.  Presumably, you would already have the
transcoding machinery you need.  If more people would contribute
portable code for more transcoders, so much the better.

&gt;&gt; The bottom two layers are there because they're useful.  If all layers
&gt;&gt; are required, portable code could use whatever layer it wants to.  I
&gt;&gt; don't see why the lower layers (especially the primitive layer) would
&gt;&gt; necessarily be extremely slow---maybe you can elaborate why you think
&gt;&gt; this is the case?
&gt;
&gt; If you aren't using a systems-level language (or don't want to go through
&gt; the effort), then you have to base the lower-levels on an existing upper
&gt; level, which implies all text gets buffered twice.

Well, sure, if you don't want to go to the effort, almost anything can
be slow.  Sorry, but this kind of argument doesn't cut it with me.

Moreover, if you really want high performance, no ports layer of the
kind described in the SRFI will do the job at all---only the primitive
I/O can.

&gt; I also have concerns about the stream-layer in general.  I really like
&gt; the idea of being able to treat a port like a list (although given the
&gt; choice I'd rather work with car and cdr than car+cdr).  However, it
&gt; requires either large amounts of buffering 

That depends on what you mean by &quot;large amounts.&quot;  You do get lots of
transient allocation, which advanced GC's deal with very well.

&gt; If the record is the last element of a 10GB file we would need
&gt; 10GB of memory to do this.  A smart compiler and gc could
&gt; determine the older streams aren't re-used and reclaim them
&gt; in this case, but what if they were re-used?  Or what if they
&gt; aren't but the compiler can't prove it?

Then you're out of luck, as with any continual allocation.  Thank
goodness we have proper tail recursion.

&gt; Likewise we need SET-PORT-POSITION!.

That's true.  I never considered it because it isn't in the SML Basis.
I'll see what I can do for the next revision.

&gt; Another issue is that buffering doesn't account for mutations
&gt; performed between reads, so libraries like C provide explicit
&gt; buffering controls, including non-buffering.  

Can you show me how the C library does it?  I can't find it offhand.

-- 
Cheers =8-} Mike
Friede, V&#xF6;lkerverst&#xE4;ndigung und &#xFC;berhaupt blabla

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00095" href="msg00095.html">Re: Specification vs. Implementation</a></strong>
<ul><li><em>From:</em> Alex Shinn</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00063" href="msg00063.html">Specification vs. Implementation</a></strong>
<ul><li><em>From:</em> Alex Shinn</li></ul></li>
<li><strong><a name="00065" href="msg00065.html">Re: Specification vs. Implementation</a></strong>
<ul><li><em>From:</em> Michael Sperber</li></ul></li>
<li><strong><a name="00068" href="msg00068.html">Re: Specification vs. Implementation</a></strong>
<ul><li><em>From:</em> Alex Shinn</li></ul></li>
<li><strong><a name="00078" href="msg00078.html">Re: Specification vs. Implementation</a></strong>
<ul><li><em>From:</em> Michael Sperber</li></ul></li>
<li><strong><a name="00084" href="msg00084.html">Re: Specification vs. Implementation</a></strong>
<ul><li><em>From:</em> Alex Shinn</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00087.html">Re: Specification vs. Implementation</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00089.html">Re: finalize or withdraw?</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00084.html">Re: Specification vs. Implementation</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00095.html">Re: Specification vs. Implementation</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00088"><strong>Date</strong></a></li>
<li><a href="threads.html#00088"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
