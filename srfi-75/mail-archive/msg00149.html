<!-- MHonArc v2.6.15 -->
<!--X-Subject: Re: the discussion so far -->
<!--X-From-R13: orne <orneNfbavp.arg> -->
<!--X-Date: Wed, 20 Jul 2005 19:27:32 +0200 (DFT) -->
<!--X-Message-Id: Pine.LNX.4.58.0507200921480.3227@bolt.sonic.net -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20050717072906.GG6292@NYCMJCOWA2 -->
<!--X-Reference: 87ll459e1s.fsf@becket.becket.net -->
<!--X-Reference: 20050718023026.GE3176@NYCMJCOWA2 -->
<!--X-Reference: 87ackk90x5.fsf@becket.becket.net -->
<!--X-Reference: 20050718123725.GA5492@NYCMJCOWA2 -->
<!--X-Reference: 877jfnkfo3.fsf@becket.becket.net -->
<!--X-Reference: 20050719223233.GA4996@NYCMJCOWA2 -->
<!--X-Reference: 87d5pexvru.fsf@becket.becket.net -->
<!--X-Reference: 20050720050723.GJ4996@NYCMJCOWA2 -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: the discussion so far</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00148.html">Date Prev</a>][<a href="msg00150.html">Date Next</a>][<a href="msg00145.html">Thread Prev</a>][<a href="msg00154.html">Thread Next</a>][<a href="maillist.html#00149">Date Index</a>][<a href="threads.html#00149">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: the discussion so far</h1>
<p style="max-width: 30em;">This page is part of the web mail archives of <a href="http://srfi.schemers.org/srfi-75">SRFI 75</a> from before July 7th, 2015.  The new archives for SRFI 75 are <a href="http://srfi-email.schemers.org/srfi-75/">here</a>.  Eventually, the entire history will be moved there, including any new messages.</p>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: &quot;John.Cowan&quot; &lt;<a href="mailto:jcowan@DOMAIN.HIDDEN">jcowan@xxxxxxxxxxxxxxxxx</a>&gt;</li>
<li><em>Subject</em>: Re: the discussion so far</li>
<li><em>From</em>: bear &lt;<a href="mailto:bear@DOMAIN.HIDDEN">bear@xxxxxxxxx</a>&gt;</li>
<li><em>Date</em>: Wed, 20 Jul 2005 10:26:52 -0700 (PDT)</li>
<li><em>Cc</em>: Thomas Bushnell BSG &lt;<a href="mailto:tb@DOMAIN.HIDDEN">tb@xxxxxxxxxx</a>&gt;, <a href="mailto:srfi-75@DOMAIN.HIDDEN">srfi-75@xxxxxxxxxxxxxxxxx</a></li>
<li><em>Delivered-to</em>: <a href="mailto:srfi-75@DOMAIN.HIDDEN">srfi-75@xxxxxxxxxxxxxxxxx</a></li>
<li><em>In-reply-to</em>: &lt;<a href="mailto:20050720050723.GJ4996@DOMAIN.HIDDEN"><a href="msg00145.html">20050720050723.GJ4996@NYCMJCOWA2</a></a>&gt;</li>
<li><em>References</em>: &lt;<a href="mailto:20050717072906.GG6292@DOMAIN.HIDDEN"><a href="msg00097.html">20050717072906.GG6292@NYCMJCOWA2</a></a>&gt; &lt;<a href="mailto:87ll459e1s.fsf@DOMAIN.HIDDEN">87ll459e1s.fsf@xxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:20050718023026.GE3176@DOMAIN.HIDDEN"><a href="msg00103.html">20050718023026.GE3176@NYCMJCOWA2</a></a>&gt; &lt;<a href="mailto:87ackk90x5.fsf@DOMAIN.HIDDEN">87ackk90x5.fsf@xxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:20050718123725.GA5492@DOMAIN.HIDDEN"><a href="msg00106.html">20050718123725.GA5492@NYCMJCOWA2</a></a>&gt; &lt;<a href="mailto:877jfnkfo3.fsf@DOMAIN.HIDDEN">877jfnkfo3.fsf@xxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:20050719223233.GA4996@DOMAIN.HIDDEN"><a href="msg00121.html">20050719223233.GA4996@NYCMJCOWA2</a></a>&gt; &lt;<a href="mailto:87d5pexvru.fsf@DOMAIN.HIDDEN">87d5pexvru.fsf@xxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:20050720050723.GJ4996@DOMAIN.HIDDEN"><a href="msg00145.html">20050720050723.GJ4996@NYCMJCOWA2</a></a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>

On Wed, 20 Jul 2005, John.Cowan wrote:

&gt;Thomas Bushnell BSG scripsit:
&gt;
&gt;&gt; When you provide a function that does almost-the-right-thing, you are
&gt;&gt; encouraging programmers to use it.  The only case where you have
&gt;&gt; identified a value to this function (when implemented as a simple
&gt;&gt; radix comparator on codepoints) is when you have binary search trees
&gt;&gt; which you want to exchange between scheme systems.
&gt;
&gt;I picked that as a counterexample to the claim that there were no such
&gt;use cases.

&quot;There never has been, nor will there ever be, any
 programming language in which it is the least bit difficult
 to write bad code.&quot;
                     --Lawrence Flon

I think you really can't make doing the wrong thing hard.
The best you can do is to try to make the right thing as
easy as the wrong thing.

char-upcase and char-downcase can be used to do useful
things which are not wrong.  But char-upcase and
char-downcase are examples of functions that also make the
wrong thing easy to do.  I think they can be forgiven that,
if they are first well-documented with adequate and proper
warnings about their scope and usefulness, and if second
there are string-upcase and string-downcase functions that
are *NOT* defined to be simply the result of applying
char-*case to each codepoint.

The thing is that char-upcase and char-downcase, even
though restricted to one-to-one character case mappings
which do *not* express the full correct casing behavior
in Unicode, are still useful.

But lest someone just map these incomplete casing functions
over the codepoints in order to get (wrong) uppercase or
lowercase strings, (that is, the wrong thing they make easy)
we must provide string-casing functions that allow the right
thing to be just as easy.

I would suggest this language for char-upcase and
char-downcase;

&quot; These functions take a character argument and return a
character result.  If the argument is an uppercase or
titlecase letter, and there is a single letter which is its
lowercase form, char-downcase returns that letter.  If the
argument is a lowercase or titlecase letter, and there is a
single letter which is its uppercase form, char-upcase
returns that letter.  Otherwise, the character returned is
the same as the argument.  Note that this is an incomplete
approximation to case conversion; in general case mappings
require the context of a string, both in arguments and in
result.  See string-upcase and string-downcase for more
general case conversion functions.  &quot;

and this language for string-upcase and string-downcase:

&quot; These functions take a string argument argument and return
a string as their result.  String-upcase converts a string
to uppercase, and string-downcase converts a string to
lowercase.  If an implementation supports locales, the case
folding done by these functions will be according to the
value of (current-locale). &quot;

A similar problem arises with string&gt;? and friends.  As
defined in the current draft, these functions are *useful.*
They can be done quickly and efficiently and without
reference to tables and the ordering is consistent and
predictable.  Unfortunately, they also make the &quot;wrong
thing&quot; w/r/t sorting output for human readability easy.  The
solution, of course, is to take pains to make the &quot;right
thing&quot; also easy.

So keep string&gt;? etc, as radix sorts on codepoints, but
I recommend adding  the following functions as well, for
people who want to sort output for human readability:

string-UCA&gt;?
string-UCA&gt;=?
string-UCA=?
string-UCA&lt;=?
string-UCA&lt;?

With the more-or-less obvious semantics.  String-UCA=? in
particular, is valuable since it checks to see if the
normalized forms of the strings are equal, without mutating
either one and regardless of whether they are represented
using different codepoints.

Finally, I suggest two additional functions:

(set-current-locale! str)

Takes a string specifying a locale and attempts to set the
global locale accordingly.  If it succeeds (if the locale is
known to the system and can be used) it returns #t and
changes the locale.  If it fails (if the locale is unknown,
or the implementation does not support changing locales) it
returns #f and does not change the locale.  Implementations
are encouraged but not required to support changing locales.
Changing locales, if supported, may change the behavior of
string-upcase, string-downcase, string-UCA&lt;? and friends,
etc.

(current-locale)

A thunk which returns a string specifying the current
locale.

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00154" href="msg00154.html">Re: the discussion so far</a></strong>
<ul><li><em>From:</em> John.Cowan</li></ul></li>
<li><strong><a name="00155" href="msg00155.html">Re: the discussion so far</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00160" href="msg00160.html">Re: the discussion so far</a></strong>
<ul><li><em>From:</em> Alex Shinn</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00097" href="msg00097.html">Re: the discussion so far</a></strong>
<ul><li><em>From:</em> John.Cowan</li></ul></li>
<li><strong><a name="00101" href="msg00101.html">Re: the discussion so far</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00103" href="msg00103.html">Re: the discussion so far</a></strong>
<ul><li><em>From:</em> John.Cowan</li></ul></li>
<li><strong><a name="00104" href="msg00104.html">Re: the discussion so far</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00106" href="msg00106.html">Re: the discussion so far</a></strong>
<ul><li><em>From:</em> John.Cowan</li></ul></li>
<li><strong><a name="00111" href="msg00111.html">Re: the discussion so far</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00121" href="msg00121.html">Re: the discussion so far</a></strong>
<ul><li><em>From:</em> John.Cowan</li></ul></li>
<li><strong><a name="00122" href="msg00122.html">Re: the discussion so far</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00145" href="msg00145.html">Re: the discussion so far</a></strong>
<ul><li><em>From:</em> John.Cowan</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00148.html">Re: A different approach</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00150.html">Question marks on comparisons</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00145.html">Re: the discussion so far</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00154.html">Re: the discussion so far</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00149"><strong>Date</strong></a></li>
<li><a href="threads.html#00149"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
