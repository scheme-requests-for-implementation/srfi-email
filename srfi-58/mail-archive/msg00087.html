<!-- MHonArc v2.6.15 -->
<!--X-Subject: Floating&#45;point formats and standards -->
<!--X-From-R13: "Penqq I. Embalr" <oenqq+fesvNfmbalr.pbz> -->
<!--X-Date: Wed,  5 Jan 2005 12:48:16 +0100 (NFT) -->
<!--X-Message-Id: 20050105114809.GB9007@ogre.szonye.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: Pine.LNX.4.44.0412262207080.10074&#45;100000@autodrip.bloodandcoffee.net -->
<!--X-Reference: 20041230222337.3D7BD1B7711@voluntocracy.org -->
<!--X-Reference: Pine.LNX.4.58.0412301550550.3862@bolt.sonic.net -->
<!--X-Reference: 20050105012438.GD6573@ogre.szonye.com -->
<!--X-Reference: 20050105055413.5FA901B7717@voluntocracy.org -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Floating-point formats and standards</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00086.html">Date Prev</a>][<a href="msg00088.html">Date Next</a>][<a href="msg00084.html">Thread Prev</a>][<a href="msg00088.html">Thread Next</a>][<a href="maillist.html#00087">Date Index</a>][<a href="threads.html#00087">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Floating-point formats and standards</h1>
<p style="max-width: 30em;">This page is part of the web mail archives of <a href="http://srfi.schemers.org/srfi-58">SRFI 58</a> from before July 7th, 2015.  The <a href="http://srfi-email.schemers.org/srfi-58">new archives</a> for SRFI 58 contain all messages, not just those from before July 7th, 2015.</p>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: <a href="mailto:srfi-58@DOMAIN.HIDDEN">srfi-58@xxxxxxxxxxxxxxxxx</a></li>
<li><em>Subject</em>: Floating-point formats and standards</li>
<li><em>From</em>: &quot;Bradd W. Szonye&quot; &lt;<a href="mailto:bradd%2Bsrfi@DOMAIN.HIDDEN">bradd+srfi@xxxxxxxxxx</a>&gt;</li>
<li><em>Date</em>: Wed, 5 Jan 2005 03:48:09 -0800</li>
<li><em>Delivered-to</em>: <a href="mailto:srfi-58@DOMAIN.HIDDEN">srfi-58@xxxxxxxxxxxxxxxxx</a></li>
<li><em>In-reply-to</em>: &lt;<a href="mailto:20050105055413.5FA901B7717@DOMAIN.HIDDEN">20050105055413.5FA901B7717@xxxxxxxxxxxxxxxx</a>&gt;</li>
<li><em>Mail-followup-to</em>: <a href="mailto:srfi-58@DOMAIN.HIDDEN">srfi-58@xxxxxxxxxxxxxxxxx</a></li>
<li><em>References</em>: &lt;<a href="mailto:Pine.LNX.4.44.0412262207080.10074-100000@DOMAIN.HIDDEN">Pine.LNX.4.44.0412262207080.10074-100000@xxxxxxxxxxxxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:20041230222337.3D7BD1B7711@DOMAIN.HIDDEN">20041230222337.3D7BD1B7711@xxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:Pine.LNX.4.58.0412301550550.3862@DOMAIN.HIDDEN">Pine.LNX.4.58.0412301550550.3862@xxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:20050105012438.GD6573@DOMAIN.HIDDEN">20050105012438.GD6573@xxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:20050105055413.5FA901B7717@DOMAIN.HIDDEN">20050105055413.5FA901B7717@xxxxxxxxxxxxxxxx</a>&gt;</li>
<li><em>User-agent</em>: Mutt/1.4.1i</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Bradd wrote:
&gt;&gt; The current names for flonum arrays are &quot;real-64&quot; and &quot;real-32,&quot;
&gt;&gt; corresponding to &quot;IEEE 64.bit floating point real&quot; and &quot;IEEE 32.bit
&gt;&gt; floating point real.&quot; There are a few problems with this.

Aubrey Jaffer wrote:
&gt; Those widths were quoted directly from R5RS 6.2.3 Implementation
&gt; restrictions:
&gt; 
&gt;   This report recommends, but does not require, that the IEEE 32-bit
&gt;   and 64-bit floating point standards be followed by implementations
&gt;   that use flonum representations, and that implementations using
&gt;   other representations should match or exceed the precision
&gt;   achievable using these floating point standards [IEEE].
&gt; 
&gt; Since R5RS used widths rather than IEEE terms here, at least we are
&gt; clear about the size of these floats.

Note that [IEEE] is &quot;IEEE Standard 754-1985. IEEE Standard for Binary
Floating-Point Arithmetic. IEEE, New York, 1985.&quot; At the very least, the
SRFI should reference the same document in its bibliography to avoid any
confusion. Please note that the IEEE 754R working group is considering
revisions to the standard; see &lt;<a  rel="nofollow" href="http://754r.ucbtest.org/">http://754r.ucbtest.org/</a>&gt;. You also can
find &quot;the technical content of ANSI/IEEE Std 754-1985&quot; at the front page
of that site, which may help you with technical decisions.

&gt;&gt; Second, the format names are properly &quot;single&quot; and &quot;double,&quot; not
&gt;&gt; &quot;32.bit&quot; and &quot;64.bit.&quot;

&gt; The phrases &quot;single precision&quot; and &quot;double precision&quot; do not appear in
&gt; R5RS.  The only appearance of &quot;SHORT, SINGLE, DOUBLE, and LONG&quot;
&gt; referring to numbers is in 6.2.4 Syntax of numerical constants.

IEEE 754 calls them &quot;single format&quot; and &quot;double format.&quot; IEEE 854 calls
them &quot;single precision&quot; and &quot;double precision.&quot; In the only place it
describes flonum formats, R5RS calls them &quot;single&quot; and &quot;double.&quot; All
three use the same basic name. I'm not sure what your objection is here;
all three standards agree on the names.

However, that may change. I don't know how close the 754R working group
is to publishing a new standard, but they've changed the names of all
the formats, and it looks like they may drop all of the extended formats
except Intel's 80-bit double extended format. More on this below.

&gt;&gt; Third, both IEEE 754 and R5RS Scheme specify four floating-point
&gt;&gt; formats, but SRFI 58 currently supports only two. It should probably
&gt;&gt; support the other two types.

&gt; Difficult at the moment, since I don't know what their sizes are, or
&gt; their ordering.

See the website above for details; here's an overview.

IEEE 754 defines two &quot;basic&quot; formats (single and double), with precise
layout and precision requirements for binary compatibility between
implementations. While it only requires support for the single format,
all major workstation- and server-class FPUs support both of them
(mostly) in hardware.

The current standard also recommends support for one implementation-
defined &quot;extended&quot; format for temporary results (to minimize rounding
errors in intermediate calculations). As far as I know, only x86-type
FPUs have ever actually done this. All of the x86 FPU registers are 80
bits wide; it only rounds to single or double precision when you store
results to memory in one of the basic formats.

Everyone except Intel (and x86-cloners) has taken a different approach.
They all offer a 128-bit flonum, but they don't use it for intermediate
results as IEEE 754 recommends, possibly because many language standards
(inexplicably) discourage it by overspecifying the results of
calculations. There are two major 128-bit representations: the &quot;quad&quot;
and the &quot;double-double.&quot; The quad format works just like the IEEE basic
formats, only bigger, and almost always implemented in software. Many
vendors implement double-double instead, using special FPU ops to
improve speed at the cost of precision. (Double-doubles are only a
little more precise than doubles, despite all the extra bits.)

The 754R folks have recognized this /de facto/ standard, and it looks
like they'll adopt these formats for the revised /de jure/ standard,
with one exception: They want vendors to drop the fast-but-weak double-
double in favor of the quad format. Meanwhile, they're adding four new
formats and changing all the names. It looks like the full list will be:

    New name    Sig   Exp   Old name   Currently implemented by

    binary16     11     5
    binary32     23     8   single     all systems (hardware)
    binary64     52    11   double     all systems (hardware)
    binary80     64    15   extended   all x86-based systems (hardware)
    binary128   112    15   quad       most RISC systems (software)

    decimal32     7    7&#xBD;
    decimal64    16    9&#xBD;
    decimal128   34   13&#xBD;

    Key:
    Sig = width of significand in bits (binary) or digits (decimal)
    Exp = width of exponent in bits (both bases)
    New = name proposed by 754R working group
    Old = name used in most FPU manuals

If you want names that most programmers are already familiar with, use
the &quot;old&quot; names from the table. If you want bit widths, use the &quot;new&quot;
names. Providing both as synonyms might be a good idea. Here are my
recommendations for &quot;Schemey&quot; versions of all the names:

    binary16    flonum-b16
    binary32    flonum-b32  and single-flonum
    binary64    flonum-b64  and double-flonum
    binary80    flonum-b80  and extended-flonum (or long-flonum)
    binary128   flonum-b128 and quad-flonum

    decimal32   flonum-d32
    decimal64   flonum-d32
    decimal128  flonum-d128

I'd only make support mandatory for b32 and b64. It looks like 754R is
encouraging vendors to migrate from extended and double-double to b128
(quad), but they expect some holdouts.

&gt;&gt; Fourth, if the SRFI requires IEEE 754 representations, it should
&gt;&gt; also mandate a particular correspondence between IEEE 754 formats
&gt;&gt; and Scheme precisions (e.g., f=single, s=single extended, etc).
&gt;&gt; Otherwise, users won't be able to match literal reals to array
&gt;&gt; types reliably.

&gt; Okay, what's the correspondence?

F/single is the single (binary32) format.
D/double is the double (binary64) format.

L/long is the system's &quot;long double&quot; type, one of:
    extended (binary80)
    quad (binary128)
    double-double (implementation defined)

S/short is currently useless, and best used as an alias for &quot;single.&quot; In
the future, it might be useful if your system implements binary16.

I hope this helps. I certainly learned a lot about floating-point
formats as I was researching details for this comment.

&gt;&gt; Finally, the array element prefix should match IEEE 754 (single,
&gt;&gt; double), Scheme (f/single, d/double), or SRFI 47 (ar32, ar64). The
&gt;&gt; current &quot;real-32&quot; and &quot;real-64&quot; prefixes don't quite match any of
&gt;&gt; those.

&gt; (define A:real-64    ar64)
&gt; (define A:real-32    ar32)
&gt; 
&gt; SRFI-47 should be modified (if that is possible) or replaced after we
&gt; are finished with SRFI-58.

Yeah, I missed that earlier; sorry about that.
-- 
Bradd W. Szonye
<a  rel="nofollow" href="http://www.szonye.com/bradd">http://www.szonye.com/bradd</a>

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00088" href="msg00088.html">Re: Floating-point formats and standards</a></strong>
<ul><li><em>From:</em> Bradd W. Szonye</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00002" href="msg00002.html">Re: #\a octothorpe syntax vs SRFI 10</a></strong>
<ul><li><em>From:</em> campbell</li></ul></li>
<li><strong><a name="00006" href="msg00006.html">Re: #\a octothorpe syntax vs SRFI 10</a></strong>
<ul><li><em>From:</em> Aubrey Jaffer</li></ul></li>
<li><strong><a name="00007" href="msg00007.html">Re: #\a octothorpe syntax vs SRFI 10</a></strong>
<ul><li><em>From:</em> bear</li></ul></li>
<li><strong><a name="00068" href="msg00068.html">Re: #\a octothorpe syntax vs SRFI 10</a></strong>
<ul><li><em>From:</em> Bradd W. Szonye</li></ul></li>
<li><strong><a name="00084" href="msg00084.html">Re: #\a octothorpe syntax vs SRFI 10</a></strong>
<ul><li><em>From:</em> Aubrey Jaffer</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00086.html">Re: SRFI-10 syntax vs. #nA syntax</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00088.html">Re: Floating-point formats and standards</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00084.html">Re: #\a octothorpe syntax vs SRFI 10</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00088.html">Re: Floating-point formats and standards</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00087"><strong>Date</strong></a></li>
<li><a href="threads.html#00087"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
