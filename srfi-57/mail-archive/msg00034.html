<!-- MHonArc v2.6.15 -->
<!--X-Subject: Re: propositions, oppositions, and some minor details -->
<!--X-From-R13: Oaqer ina Fbaqre <naqerNabj.urg.oebja.rqh> -->
<!--X-Date: Wed, 22 Sep 2004 18:36:03 +0200 (DFT) -->
<!--X-Message-Id: Pine.GSO.4.60.0409221159580.16207@now.het.brown.edu -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: Pine.LNX.4.44.0409121531380.25352&#45;100000@autodrip.bloodandcoffee.net -->
<!--X-Reference: Pine.GSO.4.60.0409131326560.13880@now.het.brown.edu -->
<!--X-Reference: Pine.GSO.4.60.0409141937140.18897@now.het.brown.edu -->
<!--X-Reference: 86d60os43v.wl@lain.inunome.com -->
<!--X-Reference: Pine.GSO.4.60.0409150844240.20905@now.het.brown.edu -->
<!--X-Reference: 866567xdpv.wl@lain.inunome.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: propositions, oppositions, and some minor details</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00033.html">Date Prev</a>][<a href="msg00035.html">Date Next</a>][<a href="msg00033.html">Thread Prev</a>][<a href="msg00035.html">Thread Next</a>][<a href="maillist.html#00034">Date Index</a>][<a href="threads.html#00034">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: propositions, oppositions, and some minor details</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: Alex Shinn &lt;<a href="mailto:foof@DOMAIN.HIDDEN">foof@xxxxxxxxxxxxx</a>&gt;</li>
<li><em>Subject</em>: Re: propositions, oppositions, and some minor details</li>
<li><em>From</em>: Andre van Tonder &lt;<a href="mailto:andre@DOMAIN.HIDDEN">andre@xxxxxxxxxxxxxxxxx</a>&gt;</li>
<li><em>Date</em>: Wed, 22 Sep 2004 12:35:52 -0400 (EDT)</li>
<li><em>Cc</em>: <a href="mailto:srfi-57@DOMAIN.HIDDEN">srfi-57@xxxxxxxxxxxxxxxxx</a></li>
<li><em>Delivered-to</em>: <a href="mailto:srfi-57@DOMAIN.HIDDEN">srfi-57@xxxxxxxxxxxxxxxxx</a></li>
<li><em>In-reply-to</em>: &lt;<a href="mailto:866567xdpv.wl@DOMAIN.HIDDEN">866567xdpv.wl@xxxxxxxxxxxxxxxx</a>&gt;</li>
<li><em>References</em>: &lt;<a href="mailto:Pine.LNX.4.44.0409121531380.25352-100000@DOMAIN.HIDDEN">Pine.LNX.4.44.0409121531380.25352-100000@xxxxxxxxxxxxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:Pine.GSO.4.60.0409131326560.13880@DOMAIN.HIDDEN">Pine.GSO.4.60.0409131326560.13880@xxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:Pine.GSO.4.60.0409141937140.18897@DOMAIN.HIDDEN">Pine.GSO.4.60.0409141937140.18897@xxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:86d60os43v.wl@DOMAIN.HIDDEN">86d60os43v.wl@xxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:Pine.GSO.4.60.0409150844240.20905@DOMAIN.HIDDEN">Pine.GSO.4.60.0409150844240.20905@xxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:866567xdpv.wl@DOMAIN.HIDDEN">866567xdpv.wl@xxxxxxxxxxxxxxxx</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">
Alex,

Thank you for your comments:

On Tue, 21 Sep 2004, Alex Shinn wrote:

</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
However, even with update! I'm not sure we want to include the concept
of immutable fields.  Part of this is subjective - I don't like
restricting the programmer, especially at the expense of added
complexity; I think you should layer such restrictions on top of
simpler interfaces, leaving a choice in what the restrictions are and
how they work.  This viewpoint would suggest leaving immutability to a
separate SRFI, so that you could have alternatives such as the more
general idea of a &quot;validated&quot; field with type and range limits, etc.
</pre></blockquote><pre style="margin: 0em;">

</pre><tt>I hear you, but if one wanted to make trouble, one could also argue the 
</tt><tt>opposite - that mutability does not even really belong in a records 
</tt><tt>specification.  Mutability is arguably an orthogonal concept from 
</tt><tt>records.  Indeed, one could have made all fields immutable, simplifying 
</tt><tt>the interface considerably, without losing any expressive power, since 
</tt><tt>mutable fields could then be simulated a la ML by simply storing boxed 
</tt><tt>data (e.g. a pair) in a field, as the reference implementation implicitly 
</tt><tt>does.
</tt><pre style="margin: 0em;">

</pre><tt>Of course, tradition and backwards compatibility forces us to include the 
</tt><tt>concept of updatable fields.  But I might point out that SRFI-9 
</tt><tt>does implicitly have immutable fields, even though it is not stated in so 
</tt><tt>many words.
</tt><pre style="margin: 0em;">

</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
More objectively I think immutability is too dependant on the
reference dispatch mechanism.  It is easy and fast with dispatch
closures, but most implementations are likely to want to define
SRFI-57 records in terms of their native objects, and others will
implement it using a vector-based approach.  With such an approach
checking for immutability adds a lot more complexity and is likely a
noticable performance hit.  For records efficient slot access is
crucial.
</pre></blockquote><pre style="margin: 0em;">

</pre><tt>There does not need to be any performance hit, since checking for 
</tt><tt>immutability can and should be done, as it is in the reference 
</tt><tt>implementation, at compile time.  Indeed, update! will give a compile-time 
</tt><tt>error if a field does not support the update!.
</tt><pre style="margin: 0em;">

</pre><tt>In a closure-based implementation such as the reference implementation, it 
</tt><tt>turns out to be mutable fields that are slower, since they have to be 
</tt><tt>unboxed at each access.  In an unoptimized vector-based approach, there 
</tt><tt>should be no performance difference between mutable and immutable fields.
</tt><tt>When compiler optimizations are taken into account, immutable fields may 
</tt><tt>be faster.
</tt><pre style="margin: 0em;">

</pre><tt>There are of course further advantages to being able to specify 
</tt><tt>immutability, related to compiler optimizations, type inference, enforcing 
</tt><tt>of abstractions, and so on.
</tt><pre style="margin: 0em;">

</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
Further, immutability or any flag or meta-data associated with a field
brings up the issue of class precedence list.  If the same name field
is inherited from two different classes, one of which is mutable and
one of which is immutable, which does the child class inherit?
</pre></blockquote><pre style="margin: 0em;">

</pre><tt>I will amplify the section in the specification that states that this is 
</tt><tt>an error.
</tt><pre style="margin: 0em;">

Regards
Andre

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00035" href="msg00035.html">Re: propositions, oppositions, and some minor details</a></strong>
<ul><li><em>From:</em> Andre van Tonder</li></ul></li>
<li><strong><a name="00038" href="msg00038.html">Re: propositions, oppositions, and some minor details</a></strong>
<ul><li><em>From:</em> Alex Shinn</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00008" href="msg00008.html">propositions, oppositions, and some minor details</a></strong>
<ul><li><em>From:</em> campbell</li></ul></li>
<li><strong><a name="00013" href="msg00013.html">Re: propositions, oppositions, and some minor details</a></strong>
<ul><li><em>From:</em> Andre van Tonder</li></ul></li>
<li><strong><a name="00025" href="msg00025.html">Re: propositions, oppositions, and some minor details</a></strong>
<ul><li><em>From:</em> Andre van Tonder</li></ul></li>
<li><strong><a name="00027" href="msg00027.html">Re: propositions, oppositions, and some minor details</a></strong>
<ul><li><em>From:</em> Alex Shinn</li></ul></li>
<li><strong><a name="00029" href="msg00029.html">Re: propositions, oppositions, and some minor details</a></strong>
<ul><li><em>From:</em> Andre van Tonder</li></ul></li>
<li><strong><a name="00033" href="msg00033.html">Re: propositions, oppositions, and some minor details</a></strong>
<ul><li><em>From:</em> Alex Shinn</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00033.html">Re: propositions, oppositions, and some minor details</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00035.html">Re: propositions, oppositions, and some minor details</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00033.html">Re: propositions, oppositions, and some minor details</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00035.html">Re: propositions, oppositions, and some minor details</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00034"><strong>Date</strong></a></li>
<li><a href="threads.html#00034"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
