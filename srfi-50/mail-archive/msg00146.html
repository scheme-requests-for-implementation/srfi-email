<!-- MHonArc v2.6.15 -->
<!--X-Subject: Re: Couple things... -->
<!--X-From-R13: Fbz Zbeq <ybeqNrzs.arg> -->
<!--X-Date: Sun,  4 Jan 2004 23:13:41 +0100 (NFT) -->
<!--X-Message-Id: 200401042239.OAA20876@morrowfield.regexps.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: opr0lf0hi7w2xcd0@mx.freenet.de -->
<!--X-Reference: y9lvfo7lwhn.fsf@informatik.uni&#45;tuebingen.de -->
<!--X-Reference: opr0oqxxx7w2xcd0@mx.freenet.de -->
<!--X-Reference: y9lsmj7boet.fsf@informatik.uni&#45;tuebingen.de -->
<!--X-Reference: opr0uv14oqw2xcd0@mx.freenet.de -->
<!--X-Reference: y9lsmj5jnud.fsf@informatik.uni&#45;tuebingen.de -->
<!--X-Reference: opr00jz3dhw2xcd0@mx.freenet.de -->
<!--X-Reference: y9lwu89ui2y.fsf@informatik.uni&#45;tuebingen.de -->
<!--X-Reference: Pine.LNX.4.58.0401031126470.14953@bolt.sonic.net -->
<!--X-Reference: y9lfzewrenw.fsf@informatik.uni&#45;tuebingen.de -->
<!--X-Reference: opr09lf9p5w2xcd0@mx.freenet.de -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Couple things...</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00145.html">Date Prev</a>][<a href="msg00147.html">Date Next</a>][<a href="msg00141.html">Thread Prev</a>][<a href="msg00167.html">Thread Next</a>][<a href="maillist.html#00146">Date Index</a>][<a href="threads.html#00146">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: Couple things...</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: <a href="mailto:felix@DOMAIN.HIDDEN">felix@xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</a></li>
<li><em>Subject</em>: Re: Couple things...</li>
<li><em>From</em>: Tom Lord &lt;<a href="mailto:lord@DOMAIN.HIDDEN">lord@xxxxxxx</a>&gt;</li>
<li><em>Date</em>: Sun, 4 Jan 2004 14:39:35 -0800 (PST)</li>
<li><em>Cc</em>: <a href="mailto:sperber@DOMAIN.HIDDEN">sperber@xxxxxxxxxxxxxxxxxxxxxxxxxxx</a>, <a href="mailto:bear@DOMAIN.HIDDEN">bear@xxxxxxxxx</a>,	<a href="mailto:srfi-50@DOMAIN.HIDDEN">srfi-50@xxxxxxxxxxxxxxxxx</a></li>
<li><em>Delivered-to</em>: <a href="mailto:srfi-50@DOMAIN.HIDDEN">srfi-50@xxxxxxxxxxxxxxxxx</a></li>
<li><em>In-reply-to</em>: &lt;<a href="mailto:opr09lf9p5w2xcd0@DOMAIN.HIDDEN">opr09lf9p5w2xcd0@xxxxxxxxxxxxx</a>&gt; (message from felix on Sun, 04        Jan 2004 19:53:59 +0100)</li>
<li><em>References</em>: &lt;<a href="mailto:opr0lf0hi7w2xcd0@DOMAIN.HIDDEN">opr0lf0hi7w2xcd0@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:y9lvfo7lwhn.fsf@DOMAIN.HIDDEN">y9lvfo7lwhn.fsf@xxxxxxxxxxxxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:opr0oqxxx7w2xcd0@DOMAIN.HIDDEN">opr0oqxxx7w2xcd0@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:y9lsmj7boet.fsf@DOMAIN.HIDDEN">y9lsmj7boet.fsf@xxxxxxxxxxxxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:opr0uv14oqw2xcd0@DOMAIN.HIDDEN">opr0uv14oqw2xcd0@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:y9lsmj5jnud.fsf@DOMAIN.HIDDEN">y9lsmj5jnud.fsf@xxxxxxxxxxxxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:opr00jz3dhw2xcd0@DOMAIN.HIDDEN">opr00jz3dhw2xcd0@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:y9lwu89ui2y.fsf@DOMAIN.HIDDEN">y9lwu89ui2y.fsf@xxxxxxxxxxxxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:Pine.LNX.4.58.0401031126470.14953@DOMAIN.HIDDEN">Pine.LNX.4.58.0401031126470.14953@xxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:y9lfzewrenw.fsf@DOMAIN.HIDDEN">y9lfzewrenw.fsf@xxxxxxxxxxxxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:opr09lf9p5w2xcd0@DOMAIN.HIDDEN">opr09lf9p5w2xcd0@xxxxxxxxxxxxx</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>


    &gt; From: felix &lt;felix@xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&gt;

I'm a little lost in the layers of quotes here but:

    &gt; Note that the Chicken FFI (for example) does not allow GC during the 
    &gt; invocation of foreign code, unless callbacks are explicitly used,
    &gt; and that all arguments are normally passed as valid C data (i.e.
    &gt; C code is provided a &quot;view&quot; of the data that it can understand,
    &gt; similar to what I proposed). It has been useful enough to write
    &gt; wrappers for OpenGL, GLUT, BLAS, SQLite, the Irrlicht 3D engine,
    &gt; Sockets, most of POSIX, JAPI, MD5 stuff, Tiny CC, PCRE, SDL, GMP,
    &gt; SCOP, Spread and many other things, which should be enough for
    &gt; the start...


Do I understand correctly if I restate things this way?:

There's a bunch of useful C libraries to expose to Scheme.

Generally speaking, those libraries have implicit &quot;semantic models&quot;
that are explainable as a narrow, tastefully selected construct built
out of C semantics.  For example, their parameters come from a fairly
simple domain of types, their flow of control is simple, and so forth.

A common use of an FFI for some high-level language is to expose such
C libraries in the high-level language.

One approach to this, that taken by the draft, is to make an FFI that
models a substantial part of the semantics of the high-level language
-- then let the FFI-using programmer fill in the gap between that and
our target libraries.

Another approach, that proposed by Felix (if I'm reading right), is to
make an FFI that captures the semantics of the libraries in a
first-class way -- then let the FFI-_implementing_ programmer fill in
the gap between that and his high-level language implementation.

As an illustration of the difference:  I _vaguely_ recall that some GL
calls take as input a sequence of vertexes.   

In the draft-FFI approach, we would say &quot;Well, scheme will hand you a
list or vector of triples or quads of Scheme numbers.  From there, you
can construct a sequence that fits the calling conventions of GL.&quot;

In the alternative approach, we would say &quot;Here's an FFI that let's
you describe the kinds of sequence that GL calls expect (perhaps it's
an arbitrary-sized array of 3-element arrays of `float' values).   And
to you Scheme implementors:  you need to provide functions to convert
between lists or vectors and those C types.&quot;

I think it's true that the alternative can be a very effective
approach.   What I'd like to see is the model of C interfaces that
we'd like to be able to model.   The model has to include how it maps
into Scheme, too:


    &lt;library to bind (e.g. GL)&gt;

            ^
            |
            v
   (ffi description of GL interface)            [a]
            ^
            |
            v
   (ffi implementation for particular
     scheme implementation)
            ^
            |
            v
    &lt;some scheme implementation&gt;
            ^
            |
            v
    &lt;portable use of the binding&gt;               [b]



An alternative ffi spec would have to say how to write [a] and [b].


-t


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00167" href="msg00167.html">Re: Couple things...</a></strong>
<ul><li><em>From:</em> Michael Sperber</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00004" href="msg00004.html">Couple things...</a></strong>
<ul><li><em>From:</em> felix</li></ul></li>
<li><strong><a name="00025" href="msg00025.html">Re: Couple things...</a></strong>
<ul><li><em>From:</em> Michael Sperber</li></ul></li>
<li><strong><a name="00053" href="msg00053.html">Re: Couple things...</a></strong>
<ul><li><em>From:</em> felix</li></ul></li>
<li><strong><a name="00070" href="msg00070.html">Re: Couple things...</a></strong>
<ul><li><em>From:</em> Michael Sperber</li></ul></li>
<li><strong><a name="00102" href="msg00102.html">Re: Couple things...</a></strong>
<ul><li><em>From:</em> felix</li></ul></li>
<li><strong><a name="00108" href="msg00108.html">Re: Couple things...</a></strong>
<ul><li><em>From:</em> Michael Sperber</li></ul></li>
<li><strong><a name="00115" href="msg00115.html">Re: Couple things...</a></strong>
<ul><li><em>From:</em> felix</li></ul></li>
<li><strong><a name="00133" href="msg00133.html">Re: Couple things...</a></strong>
<ul><li><em>From:</em> Michael Sperber</li></ul></li>
<li><strong><a name="00135" href="msg00135.html">Re: Couple things...</a></strong>
<ul><li><em>From:</em> bear</li></ul></li>
<li><strong><a name="00136" href="msg00136.html">Re: Couple things...</a></strong>
<ul><li><em>From:</em> Michael Sperber</li></ul></li>
<li><strong><a name="00141" href="msg00141.html">Re: Couple things...</a></strong>
<ul><li><em>From:</em> felix</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00145.html">Re: no constants please</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00147.html">Re: no constants please</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00141.html">Re: Couple things...</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00167.html">Re: Couple things...</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00146"><strong>Date</strong></a></li>
<li><a href="threads.html#00146"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
