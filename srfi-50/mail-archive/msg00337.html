<!-- MHonArc v2.6.15 -->
<!--X-Subject: Re: Couple things... -->
<!--X-From-R13: Fbz Zbeq <ybeqNrzs.arg> -->
<!--X-Date: Sun, 18 Jan 2004 17:09:15 +0100 (MET) -->
<!--X-Message-Id: 200401181621.IAA00813@morrowfield.regexps.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: opr0lf0hi7w2xcd0@mx.freenet.de -->
<!--X-Reference: y9lvfo7lwhn.fsf@informatik.uni&#45;tuebingen.de -->
<!--X-Reference: opr0oqxxx7w2xcd0@mx.freenet.de -->
<!--X-Reference: y9lsmj7boet.fsf@informatik.uni&#45;tuebingen.de -->
<!--X-Reference: opr0uv14oqw2xcd0@mx.freenet.de -->
<!--X-Reference: y9lsmj5jnud.fsf@informatik.uni&#45;tuebingen.de -->
<!--X-Reference: opr00jz3dhw2xcd0@mx.freenet.de -->
<!--X-Reference: y9lwu89ui2y.fsf@informatik.uni&#45;tuebingen.de -->
<!--X-Reference: Pine.LNX.4.58.0401031126470.14953@bolt.sonic.net -->
<!--X-Reference: vt2zncyhmog.fsf@zenia.home -->
<!--X-Reference: Pine.LNX.4.58.0401080750010.2668@bolt.sonic.net -->
<!--X-Reference: y9lk73q36tj.fsf@informatik.uni&#45;tuebingen.de -->
<!--X-Reference: Pine.LNX.4.58.0401172152370.12895@bolt.sonic.net -->
<!--X-Reference: y9lr7xxzhjr.fsf@informatik.uni&#45;tuebingen.de -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Couple things...</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00336.html">Date Prev</a>][<a href="msg00338.html">Date Next</a>][<a href="msg00336.html">Thread Prev</a>][<a href="msg00338.html">Thread Next</a>][<a href="maillist.html#00337">Date Index</a>][<a href="threads.html#00337">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: Couple things...</h1>
<p style="max-width: 30em;">This page is part of the web mail archives of <a href="http://srfi.schemers.org/srfi-50">SRFI 50</a> from before July 7th, 2015.  The <a href="http://srfi-email.schemers.org/srfi-50">new archives</a> for SRFI 50 contain all messages, not just those from before July 7th, 2015.</p>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: <a href="mailto:sperber@DOMAIN.HIDDEN">sperber@xxxxxxxxxxxxxxxxxxxxxxxxxxx</a></li>
<li><em>Subject</em>: Re: Couple things...</li>
<li><em>From</em>: Tom Lord &lt;<a href="mailto:lord@DOMAIN.HIDDEN">lord@xxxxxxx</a>&gt;</li>
<li><em>Date</em>: Sun, 18 Jan 2004 08:21:36 -0800 (PST)</li>
<li><em>Cc</em>: <a href="mailto:bear@DOMAIN.HIDDEN">bear@xxxxxxxxx</a>, <a href="mailto:srfi-50@DOMAIN.HIDDEN">srfi-50@xxxxxxxxxxxxxxxxx</a></li>
<li><em>Delivered-to</em>: <a href="mailto:srfi-50@DOMAIN.HIDDEN">srfi-50@xxxxxxxxxxxxxxxxx</a></li>
<li><em>In-reply-to</em>: &lt;<a href="mailto:y9lr7xxzhjr.fsf@DOMAIN.HIDDEN">y9lr7xxzhjr.fsf@xxxxxxxxxxxxxxxxxxxxxxxxxxx</a>&gt; (message from	Michael Sperber on Sun, 18 Jan 2004 11:18:16 +0100)</li>
<li><em>References</em>: &lt;<a href="mailto:opr0lf0hi7w2xcd0@DOMAIN.HIDDEN">opr0lf0hi7w2xcd0@xxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:y9lvfo7lwhn.fsf@DOMAIN.HIDDEN">y9lvfo7lwhn.fsf@xxxxxxxxxxxxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:opr0oqxxx7w2xcd0@DOMAIN.HIDDEN">opr0oqxxx7w2xcd0@xxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:y9lsmj7boet.fsf@DOMAIN.HIDDEN">y9lsmj7boet.fsf@xxxxxxxxxxxxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:opr0uv14oqw2xcd0@DOMAIN.HIDDEN">opr0uv14oqw2xcd0@xxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:y9lsmj5jnud.fsf@DOMAIN.HIDDEN">y9lsmj5jnud.fsf@xxxxxxxxxxxxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:opr00jz3dhw2xcd0@DOMAIN.HIDDEN">opr00jz3dhw2xcd0@xxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:y9lwu89ui2y.fsf@DOMAIN.HIDDEN">y9lwu89ui2y.fsf@xxxxxxxxxxxxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:Pine.LNX.4.58.0401031126470.14953@DOMAIN.HIDDEN">Pine.LNX.4.58.0401031126470.14953@xxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:vt2zncyhmog.fsf@DOMAIN.HIDDEN">vt2zncyhmog.fsf@xxxxxxxxxx</a>&gt;	&lt;<a href="mailto:Pine.LNX.4.58.0401080750010.2668@DOMAIN.HIDDEN">Pine.LNX.4.58.0401080750010.2668@xxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:y9lk73q36tj.fsf@DOMAIN.HIDDEN">y9lk73q36tj.fsf@xxxxxxxxxxxxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:Pine.LNX.4.58.0401172152370.12895@DOMAIN.HIDDEN">Pine.LNX.4.58.0401172152370.12895@xxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:y9lr7xxzhjr.fsf@DOMAIN.HIDDEN">y9lr7xxzhjr.fsf@xxxxxxxxxxxxxxxxxxxxxxxxxxx</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>

    &gt; From: Michael Sperber &lt;sperber@xxxxxxxxxxxxxxxxxxxxxxxxxxx&gt;

    &gt; Ray&gt; It's not immediately obvious to me how to implement some of the
    &gt; Ray&gt; functionality that's not allowed to GC without allocating call
    &gt; Ray&gt; frames - particularly since strings are represented internally
    &gt; Ray&gt; as a tree structure.  I'll look more closely at it tomorrow and
    &gt; Ray&gt; cite specific cases.

    &gt; As to the strings &amp; characters issue---we all agree that it
    &gt; needs to be addressed.  But apart from that?

I think &quot;may GC&quot; applies to all entry points.

Even something banal like &quot;extract_double&quot; may wind up having to
reduce a number by running Scheme code (as in a bignum rational with
bignums implemented in Scheme (or just on the Scheme heap) or a
continued fraction numeric extension written in Scheme).

Other examples of the problem are process migration and persistent
stores which are, I think, something that people are likely to take a
stab at more often these days.  If anything, very simple
implementations are one of the more likely places for those kinds of
feature to show up.

(Why the &quot;constants&quot; should be an exception to &quot;may GC&quot; is something I
can't imagine.)

I think we've cooked down the implications of some FFI design space
parameters to this:


   Parameter			Restricting		Resulting
				Choice			Restriction
   ----------------------------------------------------------------

   A. GC only at certain	Yes		Aynchronous threads may
      C sequence points?			not cause GC;  signal
                                        	handlers may not cause
                                                GC

   B. Scheme values		Yes		Requires A
      repesented as 
      C rvalues?

   C. Barrierless reads		Yes		Certain incremental GC
      and writes to Scheme			techniques prohibited;
      locations?				Requires A and B


Note that (not A) implies (not (or B C)).   Coherent choices here are:

	1. no to all three
        2. A (and B?)		(A+B has no disadvantage compared to A?)
        3. A, B, and C

each progressively more restrictive than the last.

(The chart doesn't talk about &quot;human factors&quot; restrictions like
tempting users to mistakenly write `cons (a, cons (b, nil))'.)

Supposing that your choice is (A+B) or (A+B+C), then there's a new
parameter which is what you're asking Ray about:


   D. Some FFI functions may	Yes		Scheme types not extensible
      not cause GC                              in Scheme;
                                                Some scheme types or procedures
                                                not implementable in terms
                                                of others;
                                                (Implies A, of course)

which strikes me as eerily Java-esque.  Incrementally better in that
there is still a _little_ room to &quot;subclass&quot; (for example) the number
type or cons-pair type -- but only by a tiny increment since there
would still be a huge restriction on representations of (for example)
small, exact, integers or pairs.  (So much for that big Oaklisp
revival?)

In all cases, the &quot;resulting restriction&quot; becomes implicit in
FFI-using code.  An implementation that promises users support for an
A+B+C+D FFI in one release can not also promise to add asynchronous
execution in an upward compatible way, can not plan to use certain
incremental GC techniques while remaining upward compatible with code
that uses the FFI, and can not promise to compatibly add extensibility 
of the basic Scheme types.

Does it make sense to request implementation of those restriction
in other people's implementations?

-t

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00338" href="msg00338.html">Re: Couple things...</a></strong>
<ul><li><em>From:</em> bear</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00004" href="msg00004.html">Couple things...</a></strong>
<ul><li><em>From:</em> felix</li></ul></li>
<li><strong><a name="00025" href="msg00025.html">Re: Couple things...</a></strong>
<ul><li><em>From:</em> Michael Sperber</li></ul></li>
<li><strong><a name="00053" href="msg00053.html">Re: Couple things...</a></strong>
<ul><li><em>From:</em> felix</li></ul></li>
<li><strong><a name="00070" href="msg00070.html">Re: Couple things...</a></strong>
<ul><li><em>From:</em> Michael Sperber</li></ul></li>
<li><strong><a name="00102" href="msg00102.html">Re: Couple things...</a></strong>
<ul><li><em>From:</em> felix</li></ul></li>
<li><strong><a name="00108" href="msg00108.html">Re: Couple things...</a></strong>
<ul><li><em>From:</em> Michael Sperber</li></ul></li>
<li><strong><a name="00115" href="msg00115.html">Re: Couple things...</a></strong>
<ul><li><em>From:</em> felix</li></ul></li>
<li><strong><a name="00133" href="msg00133.html">Re: Couple things...</a></strong>
<ul><li><em>From:</em> Michael Sperber</li></ul></li>
<li><strong><a name="00135" href="msg00135.html">Re: Couple things...</a></strong>
<ul><li><em>From:</em> bear</li></ul></li>
<li><strong><a name="00226" href="msg00226.html">Re: Couple things...</a></strong>
<ul><li><em>From:</em> Jim Blandy</li></ul></li>
<li><strong><a name="00230" href="msg00230.html">Re: Couple things...</a></strong>
<ul><li><em>From:</em> bear</li></ul></li>
<li><strong><a name="00334" href="msg00334.html">Re: Couple things...</a></strong>
<ul><li><em>From:</em> Michael Sperber</li></ul></li>
<li><strong><a name="00335" href="msg00335.html">Re: Couple things...</a></strong>
<ul><li><em>From:</em> bear</li></ul></li>
<li><strong><a name="00336" href="msg00336.html">Re: Couple things...</a></strong>
<ul><li><em>From:</em> Michael Sperber</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00336.html">Re: Couple things...</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00338.html">Re: Couple things...</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00336.html">Re: Couple things...</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00338.html">Re: Couple things...</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00337"><strong>Date</strong></a></li>
<li><a href="threads.html#00337"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
