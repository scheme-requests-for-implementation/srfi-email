<!-- MHonArc v2.6.15 -->
<!--X-Subject: Re: strings draft -->
<!--X-From-R13: [nggurj Rrzcfxl <wvirenNsynzr.bet> -->
<!--X-Date: Sun, 25 Jan 2004 07:59:50 +0100 (MET) -->
<!--X-Message-Id: 87oessew2s.fsf@flame.org -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 200401220511.VAA18432@morrowfield.regexps.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: strings draft</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00404.html">Date Prev</a>][<a href="msg00406.html">Date Next</a>][<a href="msg00399.html">Thread Prev</a>][<a href="msg00406.html">Thread Next</a>][<a href="maillist.html#00405">Date Index</a>][<a href="threads.html#00405">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: strings draft</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: Tom Lord &lt;<a href="mailto:lord@DOMAIN.HIDDEN">lord@xxxxxxx</a>&gt;</li>
<li><em>Subject</em>: Re: strings draft</li>
<li><em>From</em>: Matthew Dempsky &lt;<a href="mailto:jivera@DOMAIN.HIDDEN">jivera@xxxxxxxxx</a>&gt;</li>
<li><em>Date</em>: Sun, 25 Jan 2004 01:00:27 +0100</li>
<li><em>Cc</em>: <a href="mailto:srfi-50@DOMAIN.HIDDEN">srfi-50@xxxxxxxxxxxxxxxxx</a></li>
<li><em>Delivered-to</em>: <a href="mailto:srfi-50@DOMAIN.HIDDEN">srfi-50@xxxxxxxxxxxxxxxxx</a></li>
<li><em>In-reply-to</em>: &lt;<a href="mailto:200401220511.VAA18432@DOMAIN.HIDDEN">200401220511.VAA18432@xxxxxxxxxxxxxxxxxxxxxxx</a>&gt; (Tom Lord's message of &quot;Wed, 21 Jan 2004 21:11:31 -0800 (PST)&quot;)</li>
<li><em>References</em>: &lt;<a href="mailto:200401220511.VAA18432@DOMAIN.HIDDEN">200401220511.VAA18432@xxxxxxxxxxxxxxxxxxxxxxx</a>&gt;</li>
<li><em>Sender</em>: Matthew Dempsky &lt;<a href="mailto:jivera@DOMAIN.HIDDEN">jivera@xxxxxxxxxxxx</a>&gt;</li>
<li><em>User-agent</em>: Gnus/5.1006 (Gnus v5.10.6) Emacs/21.3 (gnu/linux)</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Tom Lord &lt;lord@xxxxxxx&gt; writes:

&gt; ** String Conversions
&gt;
&gt;   ~ t_scm_error scm_extract_string8 (t_uchar * answer,
&gt;                                      size_t * answer_len,
&gt;                                      enum uni_encoding_scheme enc,
&gt;                                      t_scm_arena instance,
&gt;                                      t_scm_word * str)
&gt;
&gt;     Normally, convert `str' to the indicated encoding (which must be
&gt;     one of `uni_utf8', `uni_iso8859_*', or `uni_ascii') storing the
&gt;     result in the memory addressed by `answer' and the number of 
&gt;     bytes stored in `*answer_len'.  Return 0.
&gt;
&gt;     On input, `*answer_len' should indicate the amount of storage 
&gt;     available at the address `answer'.  If there is insuffiencient 
&gt;     memory available, `*answer_len' will be set to the number of bytes
&gt;     needed and the value `scm_err_too_short' returned.

In the case that answer doesn't have enough memory allocated to it to
store the string, what happens to its contents?  I would propose that
the memory contents be undefined to allow implementations that don't
store strings in a simple vector to be able to write over the memory
as it goes and later realize it lacks the storage rather than
requiring an initial pass over the contents.

I think there should also be an error raised when the string can't be
expressed in the requested encoding (I'll leave it up to someone else
to name this error) and again answer's memory should be undefined.

(These recommendations apply to all three scm_extract_string*
functions.)

Somewhat less of an issue (and more current-Pika-implementation
specific), but why name the t_scm_arena value to instance?  A few
macros (SCM_PROTECT_FRAME and theoretically SCM_LSET) assume the
arena's name to be arena.

-jivera

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00406" href="msg00406.html">Re: strings draft</a></strong>
<ul><li><em>From:</em> Tom Lord</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00342" href="msg00342.html">strings draft</a></strong>
<ul><li><em>From:</em> Tom Lord</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00404.html">Re: Parsing Scheme [was Re: strings draft]</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00406.html">Re: strings draft</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00399.html">Re: Parsing Scheme [was Re: strings draft]</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00406.html">Re: strings draft</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00405"><strong>Date</strong></a></li>
<li><a href="threads.html#00405"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
