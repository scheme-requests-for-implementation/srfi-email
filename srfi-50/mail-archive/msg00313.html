<!-- MHonArc v2.6.15 -->
<!--X-Subject: Re: when GC is permitted -->
<!--X-From-R13: Fbz Zbeq <ybeqNrzs.arg> -->
<!--X-Date: Wed, 14 Jan 2004 23:49:16 +0100 (NFT) -->
<!--X-Message-Id: 200401142316.PAA08412@morrowfield.regexps.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: E1AfQRd&#45;0000Qa&#45;00@mail.mumble.net -->
<!--X-Reference: y9leku6yfgm.fsf@informatik.uni&#45;tuebingen.de -->
<!--X-Reference: 87eku7jg5e.fsf@flame.org -->
<!--X-Reference: y9lptdqu1fv.fsf@informatik.uni&#45;tuebingen.de -->
<!--X-Reference: 200401111705.JAA22444@morrowfield.regexps.com -->
<!--X-Reference: y9lbrp6gr2d.fsf@informatik.uni&#45;tuebingen.de -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: when GC is permitted</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00312.html">Date Prev</a>][<a href="msg00314.html">Date Next</a>][<a href="msg00309.html">Thread Prev</a>][<a href="msg00331.html">Thread Next</a>][<a href="maillist.html#00313">Date Index</a>][<a href="threads.html#00313">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: when GC is permitted</h1>
<p style="max-width: 30em;">This page is part of the web mail archives of <a href="http://srfi.schemers.org/srfi-50">SRFI 50</a> from before July 7th, 2015.  The new archives for SRFI 50 are <a href="http://srfi-email.schemers.org/srfi-50/">here</a>.  Eventually, the entire history will be moved there, including any new messages.</p>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: <a href="mailto:sperber@DOMAIN.HIDDEN">sperber@xxxxxxxxxxxxxxxxxxxxxxxxxxx</a></li>
<li><em>Subject</em>: Re: when GC is permitted</li>
<li><em>From</em>: Tom Lord &lt;<a href="mailto:lord@DOMAIN.HIDDEN">lord@xxxxxxx</a>&gt;</li>
<li><em>Date</em>: Wed, 14 Jan 2004 15:16:25 -0800 (PST)</li>
<li><em>Cc</em>: <a href="mailto:jivera@DOMAIN.HIDDEN">jivera@xxxxxxxxx</a>, <a href="mailto:kelsey@DOMAIN.HIDDEN">kelsey@xxxxxxx</a>, <a href="mailto:felix@DOMAIN.HIDDEN">felix@xxxxxxxxxxxxx</a>,	<a href="mailto:jimb@DOMAIN.HIDDEN">jimb@xxxxxxxxxx</a>, <a href="mailto:srfi-50@DOMAIN.HIDDEN">srfi-50@xxxxxxxxxxxxxxxxx</a></li>
<li><em>Delivered-to</em>: <a href="mailto:srfi-50@DOMAIN.HIDDEN">srfi-50@xxxxxxxxxxxxxxxxx</a></li>
<li><em>In-reply-to</em>: &lt;<a href="mailto:y9lbrp6gr2d.fsf@DOMAIN.HIDDEN">y9lbrp6gr2d.fsf@xxxxxxxxxxxxxxxxxxxxxxxxxxx</a>&gt; (message from	Michael Sperber on Wed, 14 Jan 2004 22:26:18 +0100)</li>
<li><em>References</em>: &lt;<a href="mailto:E1AfQRd-0000Qa-00@DOMAIN.HIDDEN">E1AfQRd-0000Qa-00@xxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:y9leku6yfgm.fsf@DOMAIN.HIDDEN">y9leku6yfgm.fsf@xxxxxxxxxxxxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:87eku7jg5e.fsf@DOMAIN.HIDDEN">87eku7jg5e.fsf@xxxxxxxxx</a>&gt;	&lt;<a href="mailto:y9lptdqu1fv.fsf@DOMAIN.HIDDEN">y9lptdqu1fv.fsf@xxxxxxxxxxxxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:200401111705.JAA22444@DOMAIN.HIDDEN">200401111705.JAA22444@xxxxxxxxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:y9lbrp6gr2d.fsf@DOMAIN.HIDDEN">y9lbrp6gr2d.fsf@xxxxxxxxxxxxxxxxxxxxxxxxxxx</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>

    &gt; From: Michael Sperber &lt;sperber@xxxxxxxxxxxxxxxxxxxxxxxxxxx&gt;

    &gt; Tom&gt; What is this &quot;lots of code&quot;?   Can we identify and quantify it?

    &gt; Off the top of my head, from my most immediate environment:

My impression has changed now: formerly I would have said that
Pika-style has the disadvantage that no existing Scheme system uses
it.  (That's rapidly changing, btw.)  Now I would say we are on a
level playing field in that regard.


    &gt; - most of scsh
    &gt; - bindings for ODBC (also for scsh)
    &gt; - bindings for NIS and LDAP (also for scsh)

I'd appreciate it if you could say more about this: quantities of
code, filenames and distributions containing them, and what you think
the effort of migration from native-scsh to draft-ffi would involve.

I sampled some of the C code in a version of SCSH that I have on hand
(0.5.2 -- sorry, a download for a more recent version was taking _way_
too long so I'll risk being embarassed that everything has changed
since then).  

I found a fair amount of C that appears to be automatically generated
-- am I right to presume that porting autogenerated code to _any_ FFI
should not be that hard?

I looked at re1.c (the function `re_search') and found a function
that, modulo alpha-renaming some entry points, looks like it would
compile under some implementations of the draft FFI -- but also looks
to me like it would be _incorrect_ under the draft FFI.  It fails to
protect arguments, treats STRING_REF() as an lvalue, assumes that
VECTOR_LENGTH returns an int, fails if an rm_so or rm_eo field does
not fit in a fixnum, treats VECTOR_REF() as an lvalue, compares a
value to #f using C's != operator, and leaks the `regmatch_t *' memory
allocated for `pm' upon error (such as an incorrectly sized start_vec
argument) --- basically, it would need to be completely rewritten.  Is
it all like that?

Then I looked at syscalls1.c and saw the same sorts of problems.  It
would again need little less than a complete rewrite.

(Incidentally, the draft's *_LENGTH routines would probably be
improved by returning size_t or ssize_t rather than long.)


    &gt; - the bindings which come with Elk (I believe that includes Xlib, Xt,
    &gt;   and Motif, among other assorted stuff)

I haven't examined that but having looked at some SCSH code I'm really
skeptical that this stuff will port easilly to the draft FFI just
because you think the interfaces are similar.


    &gt; I don't know how close the stuff written for PLT 3m is, and how much
    &gt; there is of it.

I don't think that that stuff counts -- is the PLT documentation out
of date or does that code rely on conservative GC.


    &gt; I also suspect that some stuff written for O'Caml (which also has a
    &gt; SRFI-50-style FFI) could be adapted pretty easily.  I don't have a
    &gt; list handy, but there's quite a lot of stuff there.

I'm most skeptical about that.  You're talking about comparing the
cost of converting that code from &quot;O'Caml FFI and O'Caml types&quot; to
Pika-style or draft-50-style Scheme FFI.  Where the two FFI styles
differ it is mostly over matters where the types between the two
languages also differ.  I'd expect the type issues to dominate the
costs.  (This is not to even get into the question of whether the FFI
has enough primitives to port any of that code.)


-t

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00331" href="msg00331.html">Re: when GC is permitted</a></strong>
<ul><li><em>From:</em> Eric Knauel</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00262" href="msg00262.html">Re: when GC is permitted</a></strong>
<ul><li><em>From:</em> Richard Kelsey</li></ul></li>
<li><strong><a name="00267" href="msg00267.html">Re: when GC is permitted</a></strong>
<ul><li><em>From:</em> Michael Sperber</li></ul></li>
<li><strong><a name="00269" href="msg00269.html">Re: when GC is permitted</a></strong>
<ul><li><em>From:</em> Matthew Dempsky</li></ul></li>
<li><strong><a name="00270" href="msg00270.html">Re: when GC is permitted</a></strong>
<ul><li><em>From:</em> Michael Sperber</li></ul></li>
<li><strong><a name="00271" href="msg00271.html">Re: when GC is permitted</a></strong>
<ul><li><em>From:</em> Tom Lord</li></ul></li>
<li><strong><a name="00309" href="msg00309.html">Re: when GC is permitted</a></strong>
<ul><li><em>From:</em> Michael Sperber</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00312.html">Re: Comparing Pika-syle and JNI-style</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00314.html">Re: Comparing Pika-syle and JNI-style</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00309.html">Re: when GC is permitted</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00331.html">Re: when GC is permitted</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00313"><strong>Date</strong></a></li>
<li><a href="threads.html#00313"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
