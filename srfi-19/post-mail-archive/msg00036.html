<!-- MHonArc v2.6.15 -->
<!--X-Subject: Re: New year wildcard for string&#45;>date -->
<!--X-From-R13: [nepb [nttv <zep.zttNtznvy.pbz> -->
<!--X-Date: Wed, 10 Feb 2010 12:48:55 +0000 (UTC) -->
<!--X-Message-Id: 873a19gssf.fsf@rapitore.luna -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: y9lpr4ejwbe.fsf@deinprogramm.de -->
<!--X-Reference: 87iqa6w4xm.fsf@rapitore.luna -->
<!--X-Reference: 5FFF0B14&#45;DC13&#45;40A3&#45;96A3&#45;0D941E67B3F5@gmail.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: New year wildcard for string-&gt;date</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00035.html">Date Prev</a>][<a href="msg00037.html">Date Next</a>][<a href="msg00035.html">Thread Prev</a>][<a href="msg00037.html">Thread Next</a>][<a href="maillist.html#00036">Date Index</a>][<a href="threads.html#00036">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: New year wildcard for string-&gt;date</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: Dave Gurnell &lt;<a href="mailto:d.j.gurnell@DOMAIN.HIDDEN">d.j.gurnell@xxxxxxxxx</a>&gt;</li>
<li><em>Subject</em>: Re: New year wildcard for string-&gt;date</li>
<li><em>From</em>: Marco Maggi &lt;<a href="mailto:mrc.mgg@DOMAIN.HIDDEN">mrc.mgg@xxxxxxxxx</a>&gt;</li>
<li><em>Date</em>: Wed, 10 Feb 2010 13:49:04 +0100</li>
<li><em>Cc</em>: Marco Maggi &lt;<a href="mailto:mrc.mgg@DOMAIN.HIDDEN">mrc.mgg@xxxxxxxxx</a>&gt;,  <a href="mailto:srfi-19@DOMAIN.HIDDEN">srfi-19@xxxxxxxxxxxxxxxxx</a></li>
<li><em>Delivered-to</em>: <a href="mailto:srfi-19@DOMAIN.HIDDEN">srfi-19@xxxxxxxxxxxxxxxxx</a></li>
<li><em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=gmail.com; s=gamma;        h=domainkey-signature:received:received:original-sender:x-loop         :x-mailer:in-reply-to:references:to:cc:subject:from:date:message-id         :lines:mime-version:content-type;        bh=gF4JAv5eM1PcyInpbvvh9lqmlwn6LTooB+A8KZgM6l8=;        b=rQar7JEQy5ob72uxHd920EvsvpU4UDz5ZawzyhsRfOGj0FBbmaHBQa+mcugNtLSUYB         FvX05GPfFq7CZC23vjCpbr4Ly3RIA1GRL30L2gRa+UBaFcLBCPLxeWarpxFls4DQ7f47         4Q7Ylx1bQ983AsLz83Ee1+uZsvCRxH4bbCk6M=</li>
<li><em>Domainkey-signature</em>: a=rsa-sha1; c=nofws;        d=gmail.com; s=gamma;        h=original-sender:x-loop:x-mailer:in-reply-to:references:to:cc         :subject:from:date:message-id:lines:mime-version:content-type;        b=uZkhqep9bjbkAkhlKSBM9LIZLFlWMeNdQP7aVaadtjS73MEw5L0X4l5PtBL6C3/3i5         DBfh2Mhj+Gny6EXWmrxIzLlodWEnoUGbxLkFS36xyDOGZ7OIq8YOQyxR6RKwk3J7/6nW         3AaH/K7NRy0hHC1wUrbzl8ivVV23S4f0oqWiM=</li>
<li><em>In-reply-to</em>: <a href="mailto:marco@DOMAIN.HIDDEN">marco@localhost</a>	message of &quot;Wed\, 10 Feb 2010 10\:43\:17 +0000&quot;)</li>
<li><em>Original-sender</em>: <a href="mailto:marco@DOMAIN.HIDDEN">marco@localhost</a></li>
<li><em>References</em>: &lt;<a href="mailto:y9lpr4ejwbe.fsf@DOMAIN.HIDDEN">y9lpr4ejwbe.fsf@xxxxxxxxxxxxxxx</a>&gt;  &lt;<a href="mailto:87iqa6w4xm.fsf@DOMAIN.HIDDEN">87iqa6w4xm.fsf@xxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:5FFF0B14-DC13-40A3-96A3-0D941E67B3F5@DOMAIN.HIDDEN">5FFF0B14-DC13-40A3-96A3-0D941E67B3F5@xxxxxxxxx</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>&quot;Dave Gurnell&quot; wrote:
&gt;&gt; (string-&gt;date &quot;13/01/2010 &quot; &quot;~d/~m/~y &quot;)
&gt;&gt; (string-&gt;date &quot;13/01/10 &quot; &quot;~d/~m/~Y &quot;)
&gt;
&gt; In the latest  PLT, the first of these  gives an error and
&gt; the second gives  the year 0010. I guess  this means we're
&gt; missing a patch from the reference implementation?

Or it is me using a modified version [1].

[1] &lt;<a  rel="nofollow" href="http://github.com/marcomaggi/nausicaa/blob/master/scheme/src/libraries/times-and-dates.sls">http://github.com/marcomaggi/nausicaa/blob/master/scheme/src/libraries/times-and-dates.sls</a>&gt;

&gt; In summary, my problem is that the parsing of ~y and ~Y is
&gt; inconsistent: ~y raises an error on 1 digit, and expands 2
&gt; digits  to  4  using  tm:natural-year (which  guesses  the
&gt; century based  on the current  year); ~Y pads to  4 digits
&gt; using zeroes (not tm:natural-year).

But  this  is  correct,  IMHO.   The purpose  of  ~Y,  as  I
understand it,  is exactly to get all  the informations from
the  string; while  ~y allows  us to  get  informations from
other context data.

&gt; My view is that the expansion  of a &lt;4 digit year using ~Y
&gt; should  either raise  an error  or use  tm:natural-year to
&gt; infer the century.

Having ~Y accept less than  4 digits is more general; it was
probably considered  a feature by the  original author.  The
documentation I have for ~Y is  just that it is a &quot;year&quot;, it
does not specify that it  must read exactly 4 digits.  Maybe
it should,  or maybe it  should accept any number  of digits
(it  is my understanding  that year  12345 is  impossible to
read).

To have:

(date-&gt;string (string-&gt;date &quot;01-01-01&quot; &quot;~Y-~m-~d&quot;) &quot;~Y&quot;)
=&gt; &quot;1&quot;

(date-&gt;string (string-&gt;date &quot;01-01-01&quot; &quot;~y-~m-~d&quot;) &quot;~Y&quot;)
=&gt; &quot;2001&quot;

is correct IMHO, with the current implementation.

  In my reply I have written:

(string-&gt;date &quot;13/01/2010 &quot; &quot;~d/~m/~y &quot;)

which  allows us  to detect  when more  than 2  digits where
given as a match for  ~y; with an end-of-string escape ~$ it
would have been:

(string-&gt;date &quot;13/01/2010&quot; &quot;~d/~m/~y~$&quot;)

saving us the append operation on the input string.

  In my reply I have written also:

(string-&gt;date &quot;13/01/10 &quot; &quot;~d/~m/~Y &quot;)

and it is wrong, this is useless.

  In any  case any addition to  the SRFI should  spawn a new
SRFI;  but   the  document  states  that  it   is  fine  for
implementations to add new escape sequences, so you can just
go on adding whatever you need.

  This  SRFI  has  always  given  me the  feeling  of  being
somewhat unfinished;  maybe people should  have not ratified
it as it is... but let's not get into that. ;-)
-- 
Marco Maggi

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00034" href="msg00034.html">New year wildcard for string-&gt;date</a></strong>
<ul><li><em>From:</em> Dave Gurnell</li></ul></li>
<li><strong><a name="00035" href="msg00035.html">Re: New year wildcard for string-&gt;date</a></strong>
<ul><li><em>From:</em> Marco Maggi</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00035.html">Re: New year wildcard for string-&gt;date</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00037.html">Re: New year wildcard for string-&gt;date</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00035.html">Re: New year wildcard for string-&gt;date</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00037.html">Re: New year wildcard for string-&gt;date</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00036"><strong>Date</strong></a></li>
<li><a href="threads.html#00036"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
