<!-- MHonArc v2.6.15 -->
<!--X-Subject: Re: Exactness -->
<!--X-From-R13: [nepva 'Cepmnx' Ybjnypmlx <depmnxNxaz.bet.cy> -->
<!--X-Date: Sat, 22 Oct 2005 14:48:23 +0200 (MST) -->
<!--X-Message-Id: 871x2dwweb.fsf@qrnik.zagroda -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 87wtk9qro1.fsf@qrnik.zagroda -->
<!--X-Reference: 20051019191720.GA24703@mimir.szonye.com -->
<!--X-Reference: 87fyqxb6i6.fsf@qrnik.zagroda -->
<!--X-Reference: 20051019220800.GF24703@mimir.szonye.com -->
<!--X-Reference: Pine.LNX.4.58.0510191726410.13819@bolt.sonic.net -->
<!--X-Reference: 87ach45z5v.fsf@qrnik.zagroda -->
<!--X-Reference: Pine.LNX.4.58.0510201408480.6745@bolt.sonic.net -->
<!--X-Reference: 87hdbbfwps.fsf@qrnik.zagroda -->
<!--X-Reference: 87oe5j1sef.fsf@becket.becket.net -->
<!--X-Reference: 87wtk7qoau.fsf@qrnik.zagroda -->
<!--X-Reference: 87zmp2ra04.fsf@becket.becket.net -->
<!--X-Reference: 87k6g64ojy.fsf@qrnik.zagroda -->
<!--X-Reference: 874q7ar4vf.fsf@becket.becket.net -->
<!--X-Reference: 878xwm4ncq.fsf@qrnik.zagroda -->
<!--X-Reference: 87vezqpplg.fsf@becket.becket.net -->
<!--X-Reference: 874q7alg8r.fsf@qrnik.zagroda -->
<!--X-Reference: 87fyqupmsr.fsf@becket.becket.net -->
<!--X-Reference: 87zmp2jyyp.fsf@qrnik.zagroda -->
<!--X-Reference: 87zmp2o5az.fsf@becket.becket.net -->
<!--X-Reference: 87u0faqti6.fsf@qrnik.zagroda -->
<!--X-Reference: 8764rqnz3m.fsf@becket.becket.net -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Exactness</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00103.html">Date Prev</a>][<a href="msg00105.html">Date Next</a>][<a href="msg00095.html">Thread Prev</a>][<a href="msg00109.html">Thread Next</a>][<a href="maillist.html#00104">Date Index</a>][<a href="threads.html#00104">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: Exactness</h1>
<p style="max-width: 30em;">This page is part of the web mail archives of <a href="http://srfi.schemers.org/srfi-77">SRFI 77</a> from before July 7th, 2015.  The <a href="http://srfi-email.schemers.org/srfi-77">new archives</a> for SRFI 77 contain all messages, not just those from before July 7th, 2015.</p>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: <a href="mailto:srfi-77@DOMAIN.HIDDEN">srfi-77@xxxxxxxxxxxxxxxxx</a></li>
<li><em>Subject</em>: Re: Exactness</li>
<li><em>From</em>: Marcin 'Qrczak' Kowalczyk &lt;<a href="mailto:qrczak@DOMAIN.HIDDEN">qrczak@xxxxxxxxxx</a>&gt;</li>
<li><em>Date</em>: Sat, 22 Oct 2005 14:47:56 +0200</li>
<li><em>Delivered-to</em>: <a href="mailto:srfi-77@DOMAIN.HIDDEN">srfi-77@xxxxxxxxxxxxxxxxx</a></li>
<li><em>In-reply-to</em>: &lt;<a href="mailto:8764rqnz3m.fsf@DOMAIN.HIDDEN">8764rqnz3m.fsf@xxxxxxxxxxxxxxxxx</a>&gt; (Thomas Bushnell's message of &quot;Fri, 21 Oct 2005 18:02:05 -0700&quot;)</li>
<li><em>Mail-followup-to</em>: <a href="mailto:srfi-77@DOMAIN.HIDDEN">srfi-77@xxxxxxxxxxxxxxxxx</a></li>
<li><em>References</em>: &lt;<a href="mailto:87wtk9qro1.fsf@DOMAIN.HIDDEN">87wtk9qro1.fsf@xxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:20051019191720.GA24703@DOMAIN.HIDDEN">20051019191720.GA24703@xxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:87fyqxb6i6.fsf@DOMAIN.HIDDEN">87fyqxb6i6.fsf@xxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:20051019220800.GF24703@DOMAIN.HIDDEN">20051019220800.GF24703@xxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:Pine.LNX.4.58.0510191726410.13819@DOMAIN.HIDDEN">Pine.LNX.4.58.0510191726410.13819@xxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:87ach45z5v.fsf@DOMAIN.HIDDEN">87ach45z5v.fsf@xxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:Pine.LNX.4.58.0510201408480.6745@DOMAIN.HIDDEN">Pine.LNX.4.58.0510201408480.6745@xxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:87hdbbfwps.fsf@DOMAIN.HIDDEN">87hdbbfwps.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87oe5j1sef.fsf@DOMAIN.HIDDEN">87oe5j1sef.fsf@xxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:87wtk7qoau.fsf@DOMAIN.HIDDEN">87wtk7qoau.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87zmp2ra04.fsf@DOMAIN.HIDDEN">87zmp2ra04.fsf@xxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:87k6g64ojy.fsf@DOMAIN.HIDDEN">87k6g64ojy.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:874q7ar4vf.fsf@DOMAIN.HIDDEN">874q7ar4vf.fsf@xxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:878xwm4ncq.fsf@DOMAIN.HIDDEN">878xwm4ncq.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87vezqpplg.fsf@DOMAIN.HIDDEN">87vezqpplg.fsf@xxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:874q7alg8r.fsf@DOMAIN.HIDDEN">874q7alg8r.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87fyqupmsr.fsf@DOMAIN.HIDDEN">87fyqupmsr.fsf@xxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:87zmp2jyyp.fsf@DOMAIN.HIDDEN">87zmp2jyyp.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87zmp2o5az.fsf@DOMAIN.HIDDEN">87zmp2o5az.fsf@xxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:87u0faqti6.fsf@DOMAIN.HIDDEN">87u0faqti6.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:8764rqnz3m.fsf@DOMAIN.HIDDEN">8764rqnz3m.fsf@xxxxxxxxxxxxxxxxx</a>&gt;</li>
<li><em>Sender</em>: Marcin 'Qrczak' Kowalczyk &lt;<a href="mailto:qrczak@DOMAIN.HIDDEN">qrczak@xxxxxxxxxx</a>&gt;</li>
<li><em>User-agent</em>: Gnus/5.1006 (Gnus v5.10.6) Emacs/21.3 (gnu/linux)</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Thomas Bushnell BSG &lt;tb@xxxxxxxxxx&gt; writes:

&gt; (with-ieee-floating-point ...) can just be syntactic sugar for a
&gt; specification of whatever options is the right set.

Let's make this the default, so users know what to expect,
and introduce options for hypothetical other interpretations.

&gt; Oh, I think it's already agreed that Scheme should not be mandated
&gt; to support floating point arithmetic.

I can agree with this only in the sense that Scheme implementations
may implement a subset of the numeric tower. I don't see the point
in allowing other interpretations of the default inexact syntax.
Less common formats should be chosen explicitly.

&gt; At least, I can see no advantage to such a mandate.

It standarizes the status quo, so programs which rely on inexact
numbers being floats are not only working in practice but also
formally portable.

&gt; Do you think that mandating it will somehow change anyone's behavior
&gt; materially?

No, because people already rely on it. The very example program in
R5RS would make little sense if .01 meant &quot;1/100 with the inexact
bit set&quot; and the computation was performed on vulgar fractions.

&gt; You must stop thinking of &quot;inexact&quot; as a synonym for &quot;floating
&gt; point&quot;.  Please.

Why? Isn't it true in practice? Which implementations make some other
format the default for inexact numbers?

Other languages see no problem with that. Common Lisp, Haskell, the C
family, Python, and probably many others not only do this in practice
but have this specified in the language definition.

The concept of floating point was designed a long time ago. It's not
some fancy new idea which might become fashionable for a while and
then go away. Hardware is converging to it, not diverging.

I'm open to libraries which provide other kinds of inexact numbers.
Just not make them the default, because program relying on them would
be much less portable than programs relying on flonums.

&gt; I do not think that any particular combination should be mandated,
&gt; much less mandating all possible combinations. Those which do not
&gt; support them (or some combination of them) should be required to
&gt; document their behavior and behave sensibly when the cannot
&gt; implement something.

So programs can only give hints, they can't rely on availability of
any particular properties? Well, in this area I prefer programming
based on confidence than hope.

While I dislike lots of things about Java, one thing was successful:
lots of core operations have well-defined meaning and work the same
way everywhere.

It's bad to standarize on something which is a temporary limitation of
current computers and is likely to change in future. Floating point
doesn't look like this.

&gt; Trig functions most certainly can be computed exactly if you have a
&gt; clever enough implementation.  You aren't thinking correctly here,
&gt; because you are wedded to implementation issues.  It is perfectly
&gt; possible to implement exacts reals, and make the trig functions
&gt; compute exact answers.  (Have you ever played with maxima?)

Scheme is not a CAS. Fancy representations are OK as long as they are
not the default. Programming should be predictable. Is there any
existing Scheme implementation with exact irrational numbers?

Anyway, you can ignore the &quot;(e.g. trigonometric)&quot; part of my question.
The rest of the question stands.

&gt; Perhaps we could insist on neither, and give programmers the option of
&gt; specifying the precision, and then implementations which can comply
&gt; will do so, and the others will either signal an error or (at user
&gt; preference) do the best they can.

Again programming based on hope...

&gt; How to print a number is an entirely separate question from its
&gt; representation.

Agreed.

&gt; For example, on a system with exact reals, the system might know
&gt; that the value of some computation is 2&#x3C0;; what should happen when
&gt; it's printed?

Well, if it printed this as the result of (* 8 (atan 1)), then any
other program reading its data would be surprised. I would prefer that
a given Scheme implementation doesn't use non-standard output notation
by default.

&gt;&gt; 4. What should happen when the number being computed is getting too
&gt;&gt;    large to be conveniently represented? Return &quot;infinity&quot;? Signal an
&gt;&gt;    error? How an infinity is formatted into text?
&gt;
&gt; As Alan Watson pointed out, this is simply a normal case of memory
&gt; exhaustion and does not need to be discussed separately.

It's a case of memory exhaustion only in the context of exact numbers.

For inexact numbers you might argue that such interpretation is right
too, but users will say that that it's broken and switch to others.

&gt;&gt; 9. Should the implementation try to track inexactness of real and
&gt;&gt;    imaginary part separately, or we don't care? If the imaginary part
&gt;&gt;    comes very close to 0, should the result be indistinguishable from
&gt;&gt;    a real number, or we care about being sure whether it's real or not?
&gt;
&gt; This is an ongoing difficulty for some people.  The answer is
&gt; certainly &quot;no&quot;, it should not be tracked differently, but that's
&gt; because I think of complex numbers as numbers, not as pairs of
&gt; numbers.

This philosophical standpoint doesn't explain the practical issue.
It's a false dichotomy: I treat complex numbers as numbers which are
isomorphic to pairs of real numbers. Both interpretations are true at
the same time.

Consider these numbers:
   -5.0
   -5.0+0i
   -5.0-0i
   -5.0+0.0i
   -5.0-0.0i
Which of them should be indistinguishable (eqv?)?

FP experts would be upset if the last two were the same.
(angle -5.0+0.0i) is pi, (angle -5.0-0.0i) is -pi.

In my interpretation the first three are the same, other two are
different from the first three and from each other.

In the strict reading of R5RS all are eqv?, even though some of them
can be distinguishable by arithmetic operations. This is bad, eqv?
should not unify distinguishable values (this doesn't apply to
distinguishing with eq?); the error is in the definition of eqv? in
terms of = and exactness. It breaks also for 0.0 vs. -0.0 and
3s0 vs. 3L0.

&gt;&gt; 10. When we ask whether the number is even, and it happens to be
&gt;&gt;    inexact, should the implementation try to answer hoping that
&gt;&gt;    inexactness did not change the value, or we prefer an error to be
&gt;&gt;    signalled?
&gt;
&gt; Perhaps we need two functions!

I would be happy in making this an error. Currently it's required to
answer if it looks like integer (inexactly). Even though whether
it looks like integer depends on the inaccuracy introduced during
computation.

It's bad when the validity of a procedure call depends on floating
point accuracy. That's why IEEE fp produces infinities and NaNs by
default; they don't always result from arguments truly outside the
domain, but from arguments which have slipped outside after rounding
to fp precision.


Aubrey Jaffer &lt;agj@xxxxxxxxxxxx&gt; writes:

&gt; Were the finiteness predicates left out of srfi-77 accidentally?

I don't know. It's clear however that the semantics of R5RS predicates
is unclear in the presence of special fp numbers. Are +inf.0 and
+nan.0 real? Are they allowed as real and imaginary parts of complex
numbers? Since the latter should be true (operations on complex number
can easily produce them), I think the former should be true as well.
They should not be rational? though.

The questions about domains are intrinsically poorly defined for
inexact numbers. That's why thinking in terms of representations
is often more practical.

&gt; But mixed exactness spawns many senseless combinations. What does
&gt; 1.23+5i represent?

What is senseless about it? It's a number whose real part is not known
exactly (the computation has determined that it's about 1.23) but its
imaginary part is 5 for sure.

-- 
   __(&quot;&lt;         Marcin Kowalczyk
   \__/       qrczak@xxxxxxxxxx
    ^^     <a  rel="nofollow" href="http://qrnik.knm.org.pl/~qrczak/">http://qrnik.knm.org.pl/~qrczak/</a>

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00109" href="msg00109.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> bear</li></ul></li>
<li><strong><a name="00110" href="msg00110.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00118" href="msg00118.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Bradd W. Szonye</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00055" href="msg00055.html">My comments</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00056" href="msg00056.html">Re: My comments</a></strong>
<ul><li><em>From:</em> Bradd W. Szonye</li></ul></li>
<li><strong><a name="00062" href="msg00062.html">Re: My comments</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00067" href="msg00067.html">Re: My comments</a></strong>
<ul><li><em>From:</em> Bradd W. Szonye</li></ul></li>
<li><strong><a name="00068" href="msg00068.html">Exactness (was Re: My comments)</a></strong>
<ul><li><em>From:</em> bear</li></ul></li>
<li><strong><a name="00070" href="msg00070.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00072" href="msg00072.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> bear</li></ul></li>
<li><strong><a name="00073" href="msg00073.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00074" href="msg00074.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00075" href="msg00075.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00080" href="msg00080.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00081" href="msg00081.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00083" href="msg00083.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00085" href="msg00085.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00086" href="msg00086.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00087" href="msg00087.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00088" href="msg00088.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00089" href="msg00089.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00090" href="msg00090.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00092" href="msg00092.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00095" href="msg00095.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00103.html">Re: arithmetic issues</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00105.html">+nan.0 problems</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00095.html">Re: Exactness</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00109.html">Re: Exactness</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00104"><strong>Date</strong></a></li>
<li><a href="threads.html#00104"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
