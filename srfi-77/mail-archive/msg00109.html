<!-- MHonArc v2.6.15 -->
<!--X-Subject: Re: Exactness -->
<!--X-From-R13: orne <orneNfbavp.arg> -->
<!--X-Date: Sat, 22 Oct 2005 19:17:52 +0200 (MST) -->
<!--X-Message-Id: Pine.LNX.4.58.0510220901430.31790@bolt.sonic.net -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 87wtk9qro1.fsf@qrnik.zagroda -->
<!--X-Reference: 20051019191720.GA24703@mimir.szonye.com -->
<!--X-Reference: 87fyqxb6i6.fsf@qrnik.zagroda -->
<!--X-Reference: 20051019220800.GF24703@mimir.szonye.com -->
<!--X-Reference: Pine.LNX.4.58.0510191726410.13819@bolt.sonic.net -->
<!--X-Reference: 87ach45z5v.fsf@qrnik.zagroda -->
<!--X-Reference: Pine.LNX.4.58.0510201408480.6745@bolt.sonic.net -->
<!--X-Reference: 87hdbbfwps.fsf@qrnik.zagroda -->
<!--X-Reference: 87oe5j1sef.fsf@becket.becket.net -->
<!--X-Reference: 87wtk7qoau.fsf@qrnik.zagroda -->
<!--X-Reference: 87zmp2ra04.fsf@becket.becket.net -->
<!--X-Reference: 87k6g64ojy.fsf@qrnik.zagroda -->
<!--X-Reference: 874q7ar4vf.fsf@becket.becket.net -->
<!--X-Reference: 878xwm4ncq.fsf@qrnik.zagroda -->
<!--X-Reference: 87vezqpplg.fsf@becket.becket.net -->
<!--X-Reference: 874q7alg8r.fsf@qrnik.zagroda -->
<!--X-Reference: 87fyqupmsr.fsf@becket.becket.net -->
<!--X-Reference: 87zmp2jyyp.fsf@qrnik.zagroda -->
<!--X-Reference: 87zmp2o5az.fsf@becket.becket.net -->
<!--X-Reference: 87u0faqti6.fsf@qrnik.zagroda -->
<!--X-Reference: 8764rqnz3m.fsf@becket.becket.net -->
<!--X-Reference: 871x2dwweb.fsf@qrnik.zagroda -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Exactness</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00108.html">Date Prev</a>][<a href="msg00110.html">Date Next</a>][<a href="msg00104.html">Thread Prev</a>][<a href="msg00112.html">Thread Next</a>][<a href="maillist.html#00109">Date Index</a>][<a href="threads.html#00109">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: Exactness</h1>
<p style="max-width: 30em;">This page is part of the web mail archives of <a href="http://srfi.schemers.org/srfi-77">SRFI 77</a> from before July 7th, 2015.  The new archives for SRFI 77 are <a href="http://srfi-email.schemers.org/srfi-77/">here</a>.  The new archives contain all messages, not just those from before July 7th, 2015.</p>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: &quot;Marcin 'Qrczak' Kowalczyk&quot; &lt;<a href="mailto:qrczak@DOMAIN.HIDDEN">qrczak@xxxxxxxxxx</a>&gt;</li>
<li><em>Subject</em>: Re: Exactness</li>
<li><em>From</em>: bear &lt;<a href="mailto:bear@DOMAIN.HIDDEN">bear@xxxxxxxxx</a>&gt;</li>
<li><em>Date</em>: Sat, 22 Oct 2005 10:17:26 -0700 (PDT)</li>
<li><em>Cc</em>: <a href="mailto:srfi-77@DOMAIN.HIDDEN">srfi-77@xxxxxxxxxxxxxxxxx</a></li>
<li><em>Delivered-to</em>: <a href="mailto:srfi-77@DOMAIN.HIDDEN">srfi-77@xxxxxxxxxxxxxxxxx</a></li>
<li><em>In-reply-to</em>: &lt;<a href="mailto:871x2dwweb.fsf@DOMAIN.HIDDEN">871x2dwweb.fsf@xxxxxxxxxxxxx</a>&gt;</li>
<li><em>References</em>: &lt;<a href="mailto:87wtk9qro1.fsf@DOMAIN.HIDDEN">87wtk9qro1.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:20051019191720.GA24703@DOMAIN.HIDDEN">20051019191720.GA24703@xxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87fyqxb6i6.fsf@DOMAIN.HIDDEN">87fyqxb6i6.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:20051019220800.GF24703@DOMAIN.HIDDEN">20051019220800.GF24703@xxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:Pine.LNX.4.58.0510191726410.13819@DOMAIN.HIDDEN">Pine.LNX.4.58.0510191726410.13819@xxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87ach45z5v.fsf@DOMAIN.HIDDEN">87ach45z5v.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:Pine.LNX.4.58.0510201408480.6745@DOMAIN.HIDDEN">Pine.LNX.4.58.0510201408480.6745@xxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87hdbbfwps.fsf@DOMAIN.HIDDEN">87hdbbfwps.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87oe5j1sef.fsf@DOMAIN.HIDDEN">87oe5j1sef.fsf@xxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87wtk7qoau.fsf@DOMAIN.HIDDEN">87wtk7qoau.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87zmp2ra04.fsf@DOMAIN.HIDDEN">87zmp2ra04.fsf@xxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87k6g64ojy.fsf@DOMAIN.HIDDEN">87k6g64ojy.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:874q7ar4vf.fsf@DOMAIN.HIDDEN">874q7ar4vf.fsf@xxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:878xwm4ncq.fsf@DOMAIN.HIDDEN">878xwm4ncq.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87vezqpplg.fsf@DOMAIN.HIDDEN">87vezqpplg.fsf@xxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:874q7alg8r.fsf@DOMAIN.HIDDEN">874q7alg8r.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87fyqupmsr.fsf@DOMAIN.HIDDEN">87fyqupmsr.fsf@xxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87zmp2jyyp.fsf@DOMAIN.HIDDEN">87zmp2jyyp.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87zmp2o5az.fsf@DOMAIN.HIDDEN">87zmp2o5az.fsf@xxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87u0faqti6.fsf@DOMAIN.HIDDEN">87u0faqti6.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:8764rqnz3m.fsf@DOMAIN.HIDDEN">8764rqnz3m.fsf@xxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:871x2dwweb.fsf@DOMAIN.HIDDEN">871x2dwweb.fsf@xxxxxxxxxxxxx</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>

On Sat, 22 Oct 2005, Marcin 'Qrczak' Kowalczyk wrote:

&gt;&gt; At least, I can see no advantage to such a mandate.

&gt; It standarizes the status quo, so programs which rely on inexact
&gt; numbers being floats are not only working in practice but also
&gt; formally portable.

Instead of saying &quot;rely on inexact numbers being floats&quot;, can
you enumerate the qualities of floats that you find important?
Because I think the right thing is to discuss (and possibly
standardize on) the qualities, rather than a particular method
of achieving them. IEEE floats are just one way of achieving
those goals.

I can think of a number of different systems of implementing
numbers with several of the &quot;important&quot; qualities of floats,
including finite computing time and known-size representation,
that are likely to be better matches for some jobs than floats
are, in terms of ability to return correct (exact) results more
often and represent more of the most common computable numbers.

As a general principle, I think it's a bad idea for a program to
*rely* on the result of any operation on exact numbers (except for
exact-&gt;inexact) being inexact.  That includes trig, hyperbolic
functions, roots, etc.  Such programs are inherently, and quite
properly, nonportable, and it isn't the standard's fault, because
what they're doing in making that assumption is an error.

&gt; The concept of floating point was designed a long time ago. It's not
&gt; some fancy new idea which might become fashionable for a while and
&gt; then go away. Hardware is converging to it, not diverging.

I think that the problem here is that a lot of people (myself
included) do *NOT* wish to discourage implementors from doing
better (producing exact results more often) than the floating-
point format would allow.

I think that having more exactly representable numbers is good,
so I might make a numeric format where each word gave a digit,
base 2677114440 (the most maximally-divisible composite under
2^32 of the first 9 primes).  Then all rational numbers whose
denominators were composites or products of the first 9 primes
(including all decimal fractions, since their denominators are
products of 2 and 5) would be directly representable in a few
words, without approximation.  The standard allows that.  I
think that's good.

If profiling showed that the vast majority of time spent on
calculation was going into float multiplication and division, and I
wanted more speed, I might implement a simple logarithmic numeric
type, so that all multiplication and division could be coded directly
as addition and subtraction (and exponentiation as multiplication,
etc), and have the system autoconvert numbers in loops where the
profiler and program code analysis said it would help a lot and the
conversion didn't violate the program's desired precision.  The
standard allows that too, and that is also good (although it's kind of
short on ways for the program to document its precision requirements).

				Bear






&gt;I'm open to libraries which provide other kinds of inexact numbers.
&gt;Just not make them the default, because program relying on them would
&gt;be much less portable than programs relying on flonums.
&gt;
&gt;&gt; I do not think that any particular combination should be mandated,
&gt;&gt; much less mandating all possible combinations. Those which do not
&gt;&gt; support them (or some combination of them) should be required to
&gt;&gt; document their behavior and behave sensibly when the cannot
&gt;&gt; implement something.
&gt;
&gt;So programs can only give hints, they can't rely on availability of
&gt;any particular properties? Well, in this area I prefer programming
&gt;based on confidence than hope.
&gt;
&gt;While I dislike lots of things about Java, one thing was successful:
&gt;lots of core operations have well-defined meaning and work the same
&gt;way everywhere.
&gt;
&gt;It's bad to standarize on something which is a temporary limitation of
&gt;current computers and is likely to change in future. Floating point
&gt;doesn't look like this.
&gt;
&gt;&gt; Trig functions most certainly can be computed exactly if you have a
&gt;&gt; clever enough implementation.  You aren't thinking correctly here,
&gt;&gt; because you are wedded to implementation issues.  It is perfectly
&gt;&gt; possible to implement exacts reals, and make the trig functions
&gt;&gt; compute exact answers.  (Have you ever played with maxima?)
&gt;
&gt;Scheme is not a CAS. Fancy representations are OK as long as they are
&gt;not the default. Programming should be predictable. Is there any
&gt;existing Scheme implementation with exact irrational numbers?
&gt;
&gt;Anyway, you can ignore the &quot;(e.g. trigonometric)&quot; part of my question.
&gt;The rest of the question stands.
&gt;
&gt;&gt; Perhaps we could insist on neither, and give programmers the option of
&gt;&gt; specifying the precision, and then implementations which can comply
&gt;&gt; will do so, and the others will either signal an error or (at user
&gt;&gt; preference) do the best they can.
&gt;
&gt;Again programming based on hope...
&gt;
&gt;&gt; How to print a number is an entirely separate question from its
&gt;&gt; representation.
&gt;
&gt;Agreed.
&gt;
&gt;&gt; For example, on a system with exact reals, the system might know
&gt;&gt; that the value of some computation is 2ð; what should happen when
&gt;&gt; it's printed?
&gt;
&gt;Well, if it printed this as the result of (* 8 (atan 1)), then any
&gt;other program reading its data would be surprised. I would prefer that
&gt;a given Scheme implementation doesn't use non-standard output notation
&gt;by default.
&gt;
&gt;&gt;&gt; 4. What should happen when the number being computed is getting too
&gt;&gt;&gt;    large to be conveniently represented? Return &quot;infinity&quot;? Signal an
&gt;&gt;&gt;    error? How an infinity is formatted into text?
&gt;&gt;
&gt;&gt; As Alan Watson pointed out, this is simply a normal case of memory
&gt;&gt; exhaustion and does not need to be discussed separately.
&gt;
&gt;It's a case of memory exhaustion only in the context of exact numbers.
&gt;
&gt;For inexact numbers you might argue that such interpretation is right
&gt;too, but users will say that that it's broken and switch to others.
&gt;
&gt;&gt;&gt; 9. Should the implementation try to track inexactness of real and
&gt;&gt;&gt;    imaginary part separately, or we don't care? If the imaginary part
&gt;&gt;&gt;    comes very close to 0, should the result be indistinguishable from
&gt;&gt;&gt;    a real number, or we care about being sure whether it's real or not?
&gt;&gt;
&gt;&gt; This is an ongoing difficulty for some people.  The answer is
&gt;&gt; certainly &quot;no&quot;, it should not be tracked differently, but that's
&gt;&gt; because I think of complex numbers as numbers, not as pairs of
&gt;&gt; numbers.
&gt;
&gt;This philosophical standpoint doesn't explain the practical issue.
&gt;It's a false dichotomy: I treat complex numbers as numbers which are
&gt;isomorphic to pairs of real numbers. Both interpretations are true at
&gt;the same time.
&gt;
&gt;Consider these numbers:
&gt;   -5.0
&gt;   -5.0+0i
&gt;   -5.0-0i
&gt;   -5.0+0.0i
&gt;   -5.0-0.0i
&gt;Which of them should be indistinguishable (eqv?)?
&gt;
&gt;FP experts would be upset if the last two were the same.
&gt;(angle -5.0+0.0i) is pi, (angle -5.0-0.0i) is -pi.
&gt;
&gt;In my interpretation the first three are the same, other two are
&gt;different from the first three and from each other.
&gt;
&gt;In the strict reading of R5RS all are eqv?, even though some of them
&gt;can be distinguishable by arithmetic operations. This is bad, eqv?
&gt;should not unify distinguishable values (this doesn't apply to
&gt;distinguishing with eq?); the error is in the definition of eqv? in
&gt;terms of = and exactness. It breaks also for 0.0 vs. -0.0 and
&gt;3s0 vs. 3L0.
&gt;
&gt;&gt;&gt; 10. When we ask whether the number is even, and it happens to be
&gt;&gt;&gt;    inexact, should the implementation try to answer hoping that
&gt;&gt;&gt;    inexactness did not change the value, or we prefer an error to be
&gt;&gt;&gt;    signalled?
&gt;&gt;
&gt;&gt; Perhaps we need two functions!
&gt;
&gt;I would be happy in making this an error. Currently it's required to
&gt;answer if it looks like integer (inexactly). Even though whether
&gt;it looks like integer depends on the inaccuracy introduced during
&gt;computation.
&gt;
&gt;It's bad when the validity of a procedure call depends on floating
&gt;point accuracy. That's why IEEE fp produces infinities and NaNs by
&gt;default; they don't always result from arguments truly outside the
&gt;domain, but from arguments which have slipped outside after rounding
&gt;to fp precision.
&gt;
&gt;
&gt;Aubrey Jaffer &lt;agj@xxxxxxxxxxxx&gt; writes:
&gt;
&gt;&gt; Were the finiteness predicates left out of srfi-77 accidentally?
&gt;
&gt;I don't know. It's clear however that the semantics of R5RS predicates
&gt;is unclear in the presence of special fp numbers. Are +inf.0 and
&gt;+nan.0 real? Are they allowed as real and imaginary parts of complex
&gt;numbers? Since the latter should be true (operations on complex number
&gt;can easily produce them), I think the former should be true as well.
&gt;They should not be rational? though.
&gt;
&gt;The questions about domains are intrinsically poorly defined for
&gt;inexact numbers. That's why thinking in terms of representations
&gt;is often more practical.
&gt;
&gt;&gt; But mixed exactness spawns many senseless combinations. What does
&gt;&gt; 1.23+5i represent?
&gt;
&gt;What is senseless about it? It's a number whose real part is not known
&gt;exactly (the computation has determined that it's about 1.23) but its
&gt;imaginary part is 5 for sure.
&gt;
&gt;--
&gt;   __(&quot;&lt;         Marcin Kowalczyk
&gt;   \__/       qrczak@xxxxxxxxxx
&gt;    ^^     <a  rel="nofollow" href="http://qrnik.knm.org.pl/~qrczak/">http://qrnik.knm.org.pl/~qrczak/</a>
&gt;
&gt;

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00112" href="msg00112.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00131" href="msg00131.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> John.Cowan</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00055" href="msg00055.html">My comments</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00056" href="msg00056.html">Re: My comments</a></strong>
<ul><li><em>From:</em> Bradd W. Szonye</li></ul></li>
<li><strong><a name="00062" href="msg00062.html">Re: My comments</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00067" href="msg00067.html">Re: My comments</a></strong>
<ul><li><em>From:</em> Bradd W. Szonye</li></ul></li>
<li><strong><a name="00068" href="msg00068.html">Exactness (was Re: My comments)</a></strong>
<ul><li><em>From:</em> bear</li></ul></li>
<li><strong><a name="00070" href="msg00070.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00072" href="msg00072.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> bear</li></ul></li>
<li><strong><a name="00073" href="msg00073.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00074" href="msg00074.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00075" href="msg00075.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00080" href="msg00080.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00081" href="msg00081.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00083" href="msg00083.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00085" href="msg00085.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00086" href="msg00086.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00087" href="msg00087.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00088" href="msg00088.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00089" href="msg00089.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00090" href="msg00090.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00092" href="msg00092.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00095" href="msg00095.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00104" href="msg00104.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00108.html">Re: arithmetic issues</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00110.html">Re: Exactness</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00104.html">Re: Exactness</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00112.html">Re: Exactness</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00109"><strong>Date</strong></a></li>
<li><a href="threads.html#00109"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
