<!-- MHonArc v2.6.15 -->
<!--X-Subject: Re: reading NaNs -->
<!--X-From-R13: Ohoerl Xnssre <ntwNnyhz.zvg.rqh> -->
<!--X-Date: Sun, 30 Oct 2005 02:31:05 +0100 (MET) -->
<!--X-Message-Id: 20051030013055.70E7D1B77BD@home.voluntocracy.org -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20051021145326.816C11B77BB@home.voluntocracy.org -->
<!--X-Reference: 20051023181854.4E7DD1B77BB@home.voluntocracy.org -->
<!--X-Reference: 871x2cowe8.fsf@becket.becket.net -->
<!--X-Reference: 20051023195403.A50AF1B77BB@home.voluntocracy.org -->
<!--X-Reference: 435BEC21.60509@soegaard.net -->
<!--X-Reference: 20051023205012.BFD241B77BB@home.voluntocracy.org -->
<!--X-Reference: 87zmoz27dg.fsf@qrnik.zagroda -->
<!--X-Reference: 87hdb7kgmk.fsf@becket.becket.net -->
<!--X-Reference: 87k6g3zw34.fsf@qrnik.zagroda -->
<!--X-Reference: 871x2bkfj7.fsf@becket.becket.net -->
<!--X-Reference: 8764rnu45b.fsf@qrnik.zagroda -->
<!--X-Reference: 87br1fiv26.fsf@becket.becket.net -->
<!--X-Reference: 87ll0jpu0q.fsf@qrnik.zagroda -->
<!--X-Reference: 20051024022744.6CA581B77BB@home.voluntocracy.org -->
<!--X-Reference: 87veznbb37.fsf@qrnik.zagroda -->
<!--X-Reference: 8764rnbaqr.fsf@becket.becket.net -->
<!--X-Reference: 435C9A65.7060106@astrosmo.unam.mx -->
<!--X-Reference: 20051024153539.D98031B77BB@home.voluntocracy.org -->
<!--X-Reference: 435D49E3.2010001 @astrosmo.unam.mx -->
<!--X-Reference: 20051025224529.2760C1B77BB@home.voluntocracy.org -->
<!--X-Reference: 435EBC32.801020 3@astrosmo.unam.mx -->
<!--X-Reference: 20051027164540.2B79C1B77BB@home.voluntocracy.org -->
<!--X-Reference: 436131C2.8070 003@astrosmo.unam.mx -->
<!--X-Reference: 20051029191005.043221B77BD@home.voluntocracy.org -->
<!--X-Reference: 4363E7E2.10 605@astrosmo.unam.mx -->
<!--X-Reference: 4363E7E2.10605@astrosmo.unam.mx -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: reading NaNs</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00297.html">Date Prev</a>][<a href="msg00299.html">Date Next</a>][<a href="msg00294.html">Thread Prev</a>][<a href="msg00299.html">Thread Next</a>][<a href="maillist.html#00298">Date Index</a>][<a href="threads.html#00298">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: reading NaNs</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: <a href="mailto:a.watson@DOMAIN.HIDDEN">a.watson@xxxxxxxxxxxxxxxx</a></li>
<li><em>Subject</em>: Re: reading NaNs</li>
<li><em>From</em>: Aubrey Jaffer &lt;<a href="mailto:agj@DOMAIN.HIDDEN">agj@xxxxxxxxxxxx</a>&gt;</li>
<li><em>Date</em>: Sat, 29 Oct 2005 21:30:55 -0400 (EDT)</li>
<li><em>Cc</em>: <a href="mailto:tb@DOMAIN.HIDDEN">tb@xxxxxxxxxx</a>, <a href="mailto:srfi-77@DOMAIN.HIDDEN">srfi-77@xxxxxxxxxxxxxxxxx</a></li>
<li><em>Delivered-to</em>: <a href="mailto:srfi-77@DOMAIN.HIDDEN">srfi-77@xxxxxxxxxxxxxxxxx</a></li>
<li><em>In-reply-to</em>: &lt;<a href="mailto:4363E7E2.10605@DOMAIN.HIDDEN">4363E7E2.10605@xxxxxxxxxxxxxxxx</a>&gt; (message from Alan Watson on	Sat, 29 Oct 2005 14:21:38 -0700)</li>
<li><em>References</em>: &lt;<a href="mailto:20051021145326.816C11B77BB@DOMAIN.HIDDEN">20051021145326.816C11B77BB@xxxxxxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:20051023181854.4E7DD1B77BB@DOMAIN.HIDDEN">20051023181854.4E7DD1B77BB@xxxxxxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:871x2cowe8.fsf@DOMAIN.HIDDEN">871x2cowe8.fsf@xxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:20051023195403.A50AF1B77BB@DOMAIN.HIDDEN">20051023195403.A50AF1B77BB@xxxxxxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:435BEC21.60509@DOMAIN.HIDDEN">435BEC21.60509@xxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:20051023205012.BFD241B77BB@DOMAIN.HIDDEN">20051023205012.BFD241B77BB@xxxxxxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:87zmoz27dg.fsf@DOMAIN.HIDDEN">87zmoz27dg.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87hdb7kgmk.fsf@DOMAIN.HIDDEN">87hdb7kgmk.fsf@xxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:87k6g3zw34.fsf@DOMAIN.HIDDEN">87k6g3zw34.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:871x2bkfj7.fsf@DOMAIN.HIDDEN">871x2bkfj7.fsf@xxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:8764rnu45b.fsf@DOMAIN.HIDDEN">8764rnu45b.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87br1fiv26.fsf@DOMAIN.HIDDEN">87br1fiv26.fsf@xxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:87ll0jpu0q.fsf@DOMAIN.HIDDEN">87ll0jpu0q.fsf@xxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:20051024022744.6CA581B77BB@DOMAIN.HIDDEN">20051024022744.6CA581B77BB@xxxxxxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:87veznbb37.fsf@DOMAIN.HIDDEN">87veznbb37.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:8764rnbaqr.fsf@DOMAIN.HIDDEN">8764rnbaqr.fsf@xxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:435C9A65.7060106@DOMAIN.HIDDEN">435C9A65.7060106@xxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:20051024153539.D98031B77BB@DOMAIN.HIDDEN">20051024153539.D98031B77BB@xxxxxxxxxxxxxxxxxxxxx</a>&gt; &lt;435D49E3.2010001 @astrosmo.unam.mx&gt; &lt;<a href="mailto:20051025224529.2760C1B77BB@DOMAIN.HIDDEN">20051025224529.2760C1B77BB@xxxxxxxxxxxxxxxxxxxxx</a>&gt; &lt;435EBC32.801020 <a href="mailto:3@DOMAIN.HIDDEN">3@xxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:20051027164540.2B79C1B77BB@DOMAIN.HIDDEN">20051027164540.2B79C1B77BB@xxxxxxxxxxxxxxxxxxxxx</a>&gt; &lt;436131C2.8070 <a href="mailto:003@DOMAIN.HIDDEN">003@xxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:20051029191005.043221B77BD@DOMAIN.HIDDEN">20051029191005.043221B77BD@xxxxxxxxxxxxxxxxxxxxx</a>&gt; &lt;4363E7E2.10 <a href="mailto:605@DOMAIN.HIDDEN">605@xxxxxxxxxxxxxxxx</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre> | Date: Sat, 29 Oct 2005 14:21:38 -0700
 | From: Alan Watson &lt;a.watson@xxxxxxxxxxxxxxxx&gt;
 | 
 | Aubrey Jaffer wrote:
 | &gt; I think there is a practical problem with &quot;designer-NaNs&quot; in that,
 | &gt; unlike all other IEEE-754 number objects, they cannot be constructed
 | &gt; by IEEE-754 floating-point operations alone.
 | 
 | Yes, you have to twiddle bits, but that isn't difficult.

Which bits do you twiddle so you don't spoof the hardware generated
NaNs?

This is platform dependent, even among IEEE-754 platforms.  As far as
I can tell, IEEE-754 implementations can vary widely in the number of
NaNs which are signaling versus silent.  How many silent NaNs you can
guarantee us for all flonum platforms?

 | &gt; IEEE-754:1985 section 6.2:
 | &gt;  ...
 | &gt;  Quiet NaNs should, by means left to the implementor's discretion,
 | &gt;  afford retrospective diagnostic information inherited from invalid or
 | &gt;  unavailable data and results.
 | 
 | Notice that using NaNs for unavailable data is explicitly mentioned.
 | 
 | &gt;  | That's a valid opinion, but I do not share it.  I use them quite
 | &gt;  | usefully to flag possible and planned-for events for which there is
 | &gt;  | no other good answer.
 | &gt; 
 | &gt; Such reasonable disagreement is why R6RS should *not* specify a read
 | &gt; or write syntax for NaNs.  Implementations should be free to have
 | &gt; read/write syntax for NaNs or not.
 | 
 | I very much disagree with your logic.  I agree that &quot;NaNs appearing
 | in input always signal an error&quot; is a valid point of view in that
 | it has an internal consistency and is not pointless.  However, it
 | flies against the spirit of the standard, as I see it, and against
 | practice in other languages, and eliminates other uses of NaNs.  I
 | think it is quite reasonable that R6RS should decide that your
 | opinion is valid but not the one it wishes to support.

Leaving NaN syntax unspecified does not prevent implementations from
putting NaNs to any use.

Many behaviors are left unspecified by R5RS, such as when operations
on exacts would produce results not representable as exacts; and
division by zero; and multiplication by exact zero; and syntax for
EOF.

 | You talked about a program writing a data base and then re-reading
 | it.  You said you wanted it to throw an error if it read a NaN.  If
 | you want to keep NaNs out of your data base, then surely a NaN that
 | is in the data base before writing is as dangerous as a NaN in the
 | data base after reading.  In that case, you have to arrange to keep
 | NaNs from ever entering the data base, so NaNs should never be
 | written, so NaNs should never appear be read.  So I would suggest
 | that your example is invalid.
 | 
 | Basically, signalling an error on reading a NaN might significantly
 | help when:
 | 
 | (a) Reading data written by another program.  Data written by a
 | human will have to be validated anyway.
 | 
 | (b) NaNs were valid or not dangerous in the writing program but
 | invalid or dangerous in the reading program.
 | 
 | Can you give me a real example that satisfies these constraints?

Suppose we read data from a spectrometer, then compute the average of
each pair of adjacent values and write it out.  None of the values
should be infinite.  But if somehow a positive infinity and a negative
infinity were adjacent, the average would be a NaN, which would be
written out.

The probability of this happening is so remote that writing checks for
it borders on lunacy.  But stuff does happen -- I would like my
implementation to choke when reading those NaNs.

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00299" href="msg00299.html">Re: reading NaNs</a></strong>
<ul><li><em>From:</em> Alan Watson</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00076" href="msg00076.html">arithmetic issues</a></strong>
<ul><li><em>From:</em> Aubrey Jaffer</li></ul></li>
<li><strong><a name="00137" href="msg00137.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Aubrey Jaffer</li></ul></li>
<li><strong><a name="00139" href="msg00139.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00143" href="msg00143.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Aubrey Jaffer</li></ul></li>
<li><strong><a name="00144" href="msg00144.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Jens Axel S&#xF8;gaard</li></ul></li>
<li><strong><a name="00148" href="msg00148.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Aubrey Jaffer</li></ul></li>
<li><strong><a name="00152" href="msg00152.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00153" href="msg00153.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00154" href="msg00154.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00155" href="msg00155.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00156" href="msg00156.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00157" href="msg00157.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00158" href="msg00158.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00167" href="msg00167.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Aubrey Jaffer</li></ul></li>
<li><strong><a name="00178" href="msg00178.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00179" href="msg00179.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00180" href="msg00180.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Alan Watson</li></ul></li>
<li><strong><a name="00182" href="msg00182.html">reading NaNs</a></strong>
<ul><li><em>From:</em> Aubrey Jaffer</li></ul></li>
<li><strong><a name="00216" href="msg00216.html">Re: reading NaNs</a></strong>
<ul><li><em>From:</em> Aubrey Jaffer</li></ul></li>
<li><strong><a name="00269" href="msg00269.html">Re: reading NaNs</a></strong>
<ul><li><em>From:</em> Aubrey Jaffer</li></ul></li>
<li><strong><a name="00290" href="msg00290.html">Re: reading NaNs</a></strong>
<ul><li><em>From:</em> Aubrey Jaffer</li></ul></li>
<li><strong><a name="00294" href="msg00294.html">Re: reading NaNs</a></strong>
<ul><li><em>From:</em> Alan Watson</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00297.html">Re: NaN's</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00299.html">Re: reading NaNs</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00294.html">Re: reading NaNs</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00299.html">Re: reading NaNs</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00298"><strong>Date</strong></a></li>
<li><a href="threads.html#00298"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
