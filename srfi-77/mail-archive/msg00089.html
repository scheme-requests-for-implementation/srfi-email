<!-- MHonArc v2.6.15 -->
<!--X-Subject: Re: Exactness -->
<!--X-From-R13: [nepva 'Cepmnx' Ybjnypmlx <depmnxNxaz.bet.cy> -->
<!--X-Date: Sat, 22 Oct 2005 00:18:41 +0200 (MST) -->
<!--X-Message-Id: 87zmp2jyyp.fsf@qrnik.zagroda -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 87wtk9qro1.fsf@qrnik.zagroda -->
<!--X-Reference: 20051019191720.GA24703@mimir.szonye.com -->
<!--X-Reference: 87fyqxb6i6.fsf@qrnik.zagroda -->
<!--X-Reference: 20051019220800.GF24703@mimir.szonye.com -->
<!--X-Reference: Pine.LNX.4.58.0510191726410.13819@bolt.sonic.net -->
<!--X-Reference: 87ach45z5v.fsf@qrnik.zagroda -->
<!--X-Reference: Pine.LNX.4.58.0510201408480.6745@bolt.sonic.net -->
<!--X-Reference: 87hdbbfwps.fsf@qrnik.zagroda -->
<!--X-Reference: 87oe5j1sef.fsf@becket.becket.net -->
<!--X-Reference: 87wtk7qoau.fsf@qrnik.zagroda -->
<!--X-Reference: 87zmp2ra04.fsf@becket.becket.net -->
<!--X-Reference: 87k6g64ojy.fsf@qrnik.zagroda -->
<!--X-Reference: 874q7ar4vf.fsf@becket.becket.net -->
<!--X-Reference: 878xwm4ncq.fsf@qrnik.zagroda -->
<!--X-Reference: 87vezqpplg.fsf@becket.becket.net -->
<!--X-Reference: 874q7alg8r.fsf@qrnik.zagroda -->
<!--X-Reference: 87fyqupmsr.fsf@becket.becket.net -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Exactness</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00088.html">Date Prev</a>][<a href="msg00090.html">Date Next</a>][<a href="msg00088.html">Thread Prev</a>][<a href="msg00090.html">Thread Next</a>][<a href="maillist.html#00089">Date Index</a>][<a href="threads.html#00089">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: Exactness</h1>
<p style="max-width: 30em;">This page is part of the web mail archives of <a href="http://srfi.schemers.org/srfi-77">SRFI 77</a> from before July 7th, 2015.  The new archives for SRFI 77 are <a href="http://srfi-email.schemers.org/srfi-77/">here</a>.  Eventually, the entire history will be moved there, including any new messages.</p>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: <a href="mailto:srfi-77@DOMAIN.HIDDEN">srfi-77@xxxxxxxxxxxxxxxxx</a></li>
<li><em>Subject</em>: Re: Exactness</li>
<li><em>From</em>: Marcin 'Qrczak' Kowalczyk &lt;<a href="mailto:qrczak@DOMAIN.HIDDEN">qrczak@xxxxxxxxxx</a>&gt;</li>
<li><em>Date</em>: Sat, 22 Oct 2005 00:18:38 +0200</li>
<li><em>Delivered-to</em>: <a href="mailto:srfi-77@DOMAIN.HIDDEN">srfi-77@xxxxxxxxxxxxxxxxx</a></li>
<li><em>In-reply-to</em>: &lt;<a href="mailto:87fyqupmsr.fsf@DOMAIN.HIDDEN">87fyqupmsr.fsf@xxxxxxxxxxxxxxxxx</a>&gt; (Thomas Bushnell's message of &quot;Fri, 21 Oct 2005 14:44:52 -0700&quot;)</li>
<li><em>Mail-followup-to</em>: <a href="mailto:srfi-77@DOMAIN.HIDDEN">srfi-77@xxxxxxxxxxxxxxxxx</a></li>
<li><em>References</em>: &lt;<a href="mailto:87wtk9qro1.fsf@DOMAIN.HIDDEN">87wtk9qro1.fsf@xxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:20051019191720.GA24703@DOMAIN.HIDDEN">20051019191720.GA24703@xxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:87fyqxb6i6.fsf@DOMAIN.HIDDEN">87fyqxb6i6.fsf@xxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:20051019220800.GF24703@DOMAIN.HIDDEN">20051019220800.GF24703@xxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:Pine.LNX.4.58.0510191726410.13819@DOMAIN.HIDDEN">Pine.LNX.4.58.0510191726410.13819@xxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:87ach45z5v.fsf@DOMAIN.HIDDEN">87ach45z5v.fsf@xxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:Pine.LNX.4.58.0510201408480.6745@DOMAIN.HIDDEN">Pine.LNX.4.58.0510201408480.6745@xxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:87hdbbfwps.fsf@DOMAIN.HIDDEN">87hdbbfwps.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87oe5j1sef.fsf@DOMAIN.HIDDEN">87oe5j1sef.fsf@xxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:87wtk7qoau.fsf@DOMAIN.HIDDEN">87wtk7qoau.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87zmp2ra04.fsf@DOMAIN.HIDDEN">87zmp2ra04.fsf@xxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:87k6g64ojy.fsf@DOMAIN.HIDDEN">87k6g64ojy.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:874q7ar4vf.fsf@DOMAIN.HIDDEN">874q7ar4vf.fsf@xxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:878xwm4ncq.fsf@DOMAIN.HIDDEN">878xwm4ncq.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87vezqpplg.fsf@DOMAIN.HIDDEN">87vezqpplg.fsf@xxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:874q7alg8r.fsf@DOMAIN.HIDDEN">874q7alg8r.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87fyqupmsr.fsf@DOMAIN.HIDDEN">87fyqupmsr.fsf@xxxxxxxxxxxxxxxxx</a>&gt;</li>
<li><em>Sender</em>: Marcin 'Qrczak' Kowalczyk &lt;<a href="mailto:qrczak@DOMAIN.HIDDEN">qrczak@xxxxxxxxxx</a>&gt;</li>
<li><em>User-agent</em>: Gnus/5.1006 (Gnus v5.10.6) Emacs/21.3 (gnu/linux)</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Thomas Bushnell BSG &lt;tb@xxxxxxxxxx&gt; writes:

&gt; It's not.  There may actually be programs out there that depend on
&gt; exact division doing the mathematically right thing.  You want to
&gt; break them all?

There must have been some misunderstanding. I don't want to change /
from performing exact division if given exact arguments (rational
or complex-rational).

I want to make more predictable when the programmer will obtain a
ratnum and when a flonum. And I want him to be sure that he will not
obtain some weird representation like &quot;a ratnum with inexactness bit&quot;
or &quot;fixed-size decimal fraction&quot; without explicitly asking for it.

&gt;&gt; (The difference between fixnums and bignums should not be exposed
&gt;&gt; except perhaps by some weird functions used as an efficiency hack.
&gt;&gt; Other representations are important though.)
&gt;
&gt; See, this is where you're wrong.  Constant-width addition is valuable
&gt; for integers too, not just floats.  But when people doing integer
&gt; arithmetic want that, it's an &quot;efficiency hack&quot;, and when you want it
&gt; for floating point, it's Absolutely Essential.

What do you mean by constant-width addition?

a) Addition modulo 2^N, where N is a well-defined number like 32.

b) Addition of integers which the given implementation can represent
   more efficiently than others, where the programmer hopes that the
   range will be sufficient for his needs (e.g. they are indices into
   a vector), and he values efficiency very much.

My answers:

a) is a legitimate need which should be fulfilled by other operations
than the standard + (because + is already agreed on to do a different
thing for integers), or at most by other type than standard integers.
I'm not convinced that Scheme should provide this in the standard
though, because the need is quite rare, and Scheme aims to be
minimalistic. There are other unstandarized features which are much
more important, like read-line and hash tables.

b) is an efficiency hack, because the wanted behavior is a subset of
the standard + and because it's unsafe (i.e. has either undefined
behavior or a clearly wrong outcome when misused). It makes sense only
when it's unsafe; checking types and checking for overflow is about as
costly as switching to bignums when needed.

Fixed-size floating point arithmetic differs in that it's safe, that
people expect it to be slightly inexact (or should be taught to expect
this), and that often the performance difference between fixed size
floating point and exact ratios is huge, while the difference in the
answer is small.

Of course the programmer can use exact ratios instead if he chooses.
It should be his choice, not the Scheme implementor's choice.

&gt; I think the best way to provide it is by functions that cleary specify
&gt; which behavior they get, preserving backward compatibility with the
&gt; existing standard.

Letting (+ 1.2 3.4) perform fixed-size binary floating point arithmetic
is compatible with both the existing standard and common practice.

-- 
   __(&quot;&lt;         Marcin Kowalczyk
   \__/       qrczak@xxxxxxxxxx
    ^^     <a  rel="nofollow" href="http://qrnik.knm.org.pl/~qrczak/">http://qrnik.knm.org.pl/~qrczak/</a>

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00090" href="msg00090.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00055" href="msg00055.html">My comments</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00056" href="msg00056.html">Re: My comments</a></strong>
<ul><li><em>From:</em> Bradd W. Szonye</li></ul></li>
<li><strong><a name="00062" href="msg00062.html">Re: My comments</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00067" href="msg00067.html">Re: My comments</a></strong>
<ul><li><em>From:</em> Bradd W. Szonye</li></ul></li>
<li><strong><a name="00068" href="msg00068.html">Exactness (was Re: My comments)</a></strong>
<ul><li><em>From:</em> bear</li></ul></li>
<li><strong><a name="00070" href="msg00070.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00072" href="msg00072.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> bear</li></ul></li>
<li><strong><a name="00073" href="msg00073.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00074" href="msg00074.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00075" href="msg00075.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00080" href="msg00080.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00081" href="msg00081.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00083" href="msg00083.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00085" href="msg00085.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00086" href="msg00086.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00087" href="msg00087.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00088" href="msg00088.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00088.html">Re: Exactness</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00090.html">Re: Exactness</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00088.html">Re: Exactness</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00090.html">Re: Exactness</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00089"><strong>Date</strong></a></li>
<li><a href="threads.html#00089"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
