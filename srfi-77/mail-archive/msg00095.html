<!-- MHonArc v2.6.15 -->
<!--X-Subject: Re: Exactness -->
<!--X-From-R13: Fubznf Phfuaryy PEU <goNorpxrg.arg> -->
<!--X-Date: Sat, 22 Oct 2005 03:02:28 +0200 (MST) -->
<!--X-Message-Id: 8764rqnz3m.fsf@becket.becket.net -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 87wtk9qro1.fsf@qrnik.zagroda -->
<!--X-Reference: 20051019191720.GA24703@mimir.szonye.com -->
<!--X-Reference: 87fyqxb6i6.fsf@qrnik.zagroda -->
<!--X-Reference: 20051019220800.GF24703@mimir.szonye.com -->
<!--X-Reference: Pine.LNX.4.58.0510191726410.13819@bolt.sonic.net -->
<!--X-Reference: 87ach45z5v.fsf@qrnik.zagroda -->
<!--X-Reference: Pine.LNX.4.58.0510201408480.6745@bolt.sonic.net -->
<!--X-Reference: 87hdbbfwps.fsf@qrnik.zagroda -->
<!--X-Reference: 87oe5j1sef.fsf@becket.becket.net -->
<!--X-Reference: 87wtk7qoau.fsf@qrnik.zagroda -->
<!--X-Reference: 87zmp2ra04.fsf@becket.becket.net -->
<!--X-Reference: 87k6g64ojy.fsf@qrnik.zagroda -->
<!--X-Reference: 874q7ar4vf.fsf@becket.becket.net -->
<!--X-Reference: 878xwm4ncq.fsf@qrnik.zagroda -->
<!--X-Reference: 87vezqpplg.fsf@becket.becket.net -->
<!--X-Reference: 874q7alg8r.fsf@qrnik.zagroda -->
<!--X-Reference: 87fyqupmsr.fsf@becket.becket.net -->
<!--X-Reference: 87zmp2jyyp.fsf@qrnik.zagroda -->
<!--X-Reference: 87zmp2o5az.fsf@becket.becket.net -->
<!--X-Reference: 87u0faqti6.fsf@qrnik.zagroda -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Exactness</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00094.html">Date Prev</a>][<a href="msg00096.html">Date Next</a>][<a href="msg00092.html">Thread Prev</a>][<a href="msg00104.html">Thread Next</a>][<a href="maillist.html#00095">Date Index</a>][<a href="threads.html#00095">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: Exactness</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: <a href="mailto:srfi-77@DOMAIN.HIDDEN">srfi-77@xxxxxxxxxxxxxxxxx</a></li>
<li><em>Subject</em>: Re: Exactness</li>
<li><em>From</em>: Thomas Bushnell BSG &lt;<a href="mailto:tb@DOMAIN.HIDDEN">tb@xxxxxxxxxx</a>&gt;</li>
<li><em>Date</em>: Fri, 21 Oct 2005 18:02:05 -0700</li>
<li><em>Delivered-to</em>: <a href="mailto:srfi-77@DOMAIN.HIDDEN">srfi-77@xxxxxxxxxxxxxxxxx</a></li>
<li><em>In-reply-to</em>: &lt;<a href="mailto:87u0faqti6.fsf@DOMAIN.HIDDEN">87u0faqti6.fsf@xxxxxxxxxxxxx</a>&gt; (Marcin Kowalczyk's message of	&quot;Sat, 22 Oct 2005 02:34:41 +0200&quot;)</li>
<li><em>References</em>: &lt;<a href="mailto:87wtk9qro1.fsf@DOMAIN.HIDDEN">87wtk9qro1.fsf@xxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:20051019191720.GA24703@DOMAIN.HIDDEN">20051019191720.GA24703@xxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:87fyqxb6i6.fsf@DOMAIN.HIDDEN">87fyqxb6i6.fsf@xxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:20051019220800.GF24703@DOMAIN.HIDDEN">20051019220800.GF24703@xxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:Pine.LNX.4.58.0510191726410.13819@DOMAIN.HIDDEN">Pine.LNX.4.58.0510191726410.13819@xxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:87ach45z5v.fsf@DOMAIN.HIDDEN">87ach45z5v.fsf@xxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:Pine.LNX.4.58.0510201408480.6745@DOMAIN.HIDDEN">Pine.LNX.4.58.0510201408480.6745@xxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:87hdbbfwps.fsf@DOMAIN.HIDDEN">87hdbbfwps.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87oe5j1sef.fsf@DOMAIN.HIDDEN">87oe5j1sef.fsf@xxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:87wtk7qoau.fsf@DOMAIN.HIDDEN">87wtk7qoau.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87zmp2ra04.fsf@DOMAIN.HIDDEN">87zmp2ra04.fsf@xxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:87k6g64ojy.fsf@DOMAIN.HIDDEN">87k6g64ojy.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:874q7ar4vf.fsf@DOMAIN.HIDDEN">874q7ar4vf.fsf@xxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:878xwm4ncq.fsf@DOMAIN.HIDDEN">878xwm4ncq.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87vezqpplg.fsf@DOMAIN.HIDDEN">87vezqpplg.fsf@xxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:874q7alg8r.fsf@DOMAIN.HIDDEN">874q7alg8r.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87fyqupmsr.fsf@DOMAIN.HIDDEN">87fyqupmsr.fsf@xxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:87zmp2jyyp.fsf@DOMAIN.HIDDEN">87zmp2jyyp.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87zmp2o5az.fsf@DOMAIN.HIDDEN">87zmp2o5az.fsf@xxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:87u0faqti6.fsf@DOMAIN.HIDDEN">87u0faqti6.fsf@xxxxxxxxxxxxx</a>&gt;</li>
<li><em>User-agent</em>: Gnus/5.110004 (No Gnus v0.4) Emacs/21.4 (gnu/linux)</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Marcin 'Qrczak' Kowalczyk &lt;qrczak@xxxxxxxxxx&gt; writes:

&gt; It would lead to a way too complex interface. There are too many
&gt; interacting features to specify.

Good grief, you seem to be approaching this as if we didn't have
computers handy to help out.

(with-ieee-floating-point ...) can just be syntactic sugar for a
specification of whatever options is the right set.

&gt; But how can we agree on the way of specifying these details if we
&gt; can't agree whether Scheme should be mandated to support any kind
&gt; of floating point at all?

Oh, I think it's already agreed that Scheme should not be mandated to
support floating point arithmetic.  At least, I can see no advantage
to such a mandate.  Do you think that mandating it will somehow change
anyone's behavior materially?  Standards are not sticks with which to
beat implementors into doing what you want.

&gt; The R5RS knobs are very limited. It's basically one button for all
&gt; numbers: exact/inexact. Everything else is supposed to be automatic.

No, rather everything else is not standardized.

&gt; The user must even be prepared that the implementation itself will
&gt; sometimes switch the button to &quot;inexact&quot;. This is too inflexible.
&gt; How do you propose to specify more?

You must stop thinking of &quot;inexact&quot; as a synonym for &quot;floating
point&quot;.  Please.

&gt; Below are some other features which matter.
&gt; a) Do you think they should be independently settable, and the
&gt;    implementation would be required to produce a numeric format
&gt;    which fulfills any self-consistent combination of them?

I think that they (or something like these) should all be understood
by all Scheme systems.  I do not object to that.  I do not think that
any particular combination should be mandated, much less mandating all
possible combinations.  Those which do not support them (or some
combination of them) should be required to document their behavior and
behave sensibly when the cannot implement something.

&gt; b) Or the programmer should have no portable way to control them,
&gt;    as everything (besides the exactness bit) should depend on the
&gt;    implementation?

The programmer should be able to specify clearly what he wants (where
*implementation* is not &quot;what he wants&quot;, but only *sets of features*).

&gt; c) Or a few prepackaged sets of choices should be provided (ratnums,
&gt;    flonums etc., less standard representations used explicitly -
&gt;    not taking over the default reader formats)?

Certainly not.

The &quot;features&quot; you list aren't really features, they are questions.  

&gt; 1. In case of functions which in general can't be computed exactly
&gt;    (e.g. trigonometric), do we want an assurance about the interval
&gt;    that the true result sits in (interval arithmetic), facing the
&gt;    possibility that &lt; can't be determined, or perhaps we will be happy
&gt;    with a single approximate result?

Trig functions most certainly can be computed exactly if you have a
clever enough implementation.  You aren't thinking correctly here,
because you are wedded to implementation issues.  It is perfectly
possible to implement exacts reals, and make the trig functions
compute exact answers.  (Have you ever played with maxima?)  

So the starting point of that question is ill-phrased.  I can think of
several different rephrasings for it, however, which have different
answers.  So I can't guess at which is the correct rephrased question
to answer.

&gt; 2. In case of functions like trigonometric, do we insist on specifying
&gt;    the precision - perhaps quite large - or any reasonable hardware
&gt;    default will do?

Perhaps we could insist on neither, and give programmers the option of
specifying the precision, and then implementations which can comply
will do so, and the others will either signal an error or (at user
preference) do the best they can.

&gt; 3. How to format a number into text? Use a decimal point or vulgar
&gt;    fraction? Do we want to get a decimal point in case of an inexact
&gt;    number which looks like it's an integer? How many digits after the
&gt;    point to display? Is the scientific (exponential) notation accepted?
&gt;    Pad with leading and trailing zeros to some widths? Use &quot;.&quot; or &quot;,&quot;?
&gt;    Do we accept &quot;#&quot; in place of trailing insignificant digits?

Once more, why do we need to answer such questions?  Just provide all
of those.  They all seem useful.

How to print a number is an entirely separate question from its
representation.  For example, on a system with exact reals, the system
might know that the value of some computation is 2&#x3C0;; what should
happen when it's printed?  Sometimes I might want to print 6.28,
sometimes 6.2831 (truncated), sometimes 6.2832 (rounded), sometimes
2&#x3C0;, and perhaps sometimes 6!

&gt; 4. What should happen when the number being computed is getting too
&gt;    large to be conveniently represented? Return &quot;infinity&quot;? Signal an
&gt;    error? How an infinity is formatted into text?

As Alan Watson pointed out, this is simply a normal case of memory
exhaustion and does not need to be discussed separately.

But I would not object to optional features which signal errors if an
exact number is too big, or if the storage size of a number grows
beyond some bound.  Those are the same sorts of features I might want
if a hash table or an array grows &quot;too big&quot;, and should be treated the
same way.

&gt; 5. What should happen when the inherent inaccuracy of the operation
&gt;    would make the implementation unable to sensibly compute the
&gt;    result, e.g. (sin (exp 1000))? Return special not-a-number marker?
&gt;    Signal an error?

If the user wants exact results, and the system is unable to compute
one, the result is normally said to be undefined.  I don't mind more
specific answers to those questions.  

If the user doesn't care about exactness, then I don't mind giving the
user options here.

&gt; 6. What should happen if not-a-number is compared by eqv? = &lt; &gt; &lt;= &gt;=
&gt;    with other numbers and itself? Return #t/#f? Signal an error?

Give the user options; in this case, by different functions or
optional arguments on the functions.

&gt; 7. Should there be a distinguished -0.0 which determines the side
&gt;    of a branch cut of a multivalued complex function?

Give the user options; in this case, by different functions or by
optional arguments.

&gt; 8. Do we need exact complex numbers?

Who is &quot;we&quot;?

&gt; 9. Should the implementation try to track inexactness of real and
&gt;    imaginary part separately, or we don't care? If the imaginary part
&gt;    comes very close to 0, should the result be indistinguishable from
&gt;    a real number, or we care about being sure whether it's real or not?

This is an ongoing difficulty for some people.  The answer is
certainly &quot;no&quot;, it should not be tracked differently, but that's
because I think of complex numbers as numbers, not as pairs of
numbers.  But I'm not inflexible on this point; I just don't see the
need to track it separately, and it seems to confuse the notion of
what &quot;exact&quot; means.

&gt; 10. When we ask whether the number is even, and it happens to be
&gt;    inexact, should the implementation try to answer hoping that
&gt;    inexactness did not change the value, or we prefer an error to be
&gt;    signalled?

Perhaps we need two functions!

&gt;&gt;&gt; What do you mean by constant-width addition?
&gt;&gt;
&gt;&gt; I mean &quot;addition in which the space use of the output is no larger
&gt;&gt; than the input&quot;.  This is a feature which you said was needed for
&gt;&gt; reals (I agree) and it's a feature that is useful for integers too.
&gt;
&gt; This description is meaningful for inexact numbers (cut less
&gt; significant digits which are over the limit, with proper rounding),
&gt; but meaningless for exact ones: there are no digits to cut if the
&gt; number should remain exact.

It's like you didn't read what I wrote.

As I said, if you do an operation which exceeds the limitation of such
a function using exact numbers, you need to be able to specify what
the resulting behavior is (for example, clamping, error, and modular
arithmetic are all sensible possibilities).

&gt;&gt; I don't know what you mean by &quot;safe&quot;;
&gt;
&gt; That they don't cause undefined behavior.

Sure, I'm all for that.  I think we should let the programmer define
the behavior he wants.

&gt; In general I'm asking to make the behavior of Scheme arithmetic
&gt; defined in more details, to give less choice for implementations and
&gt; more confidence for users about what to expect.

If you are right that all general-purpose implementations will want to
provide IEEE floating point arithmetic (and I certainly agree), then
what's wrong with the user saying (with ieee-floating-point-behavior
...) and having done with it?

Thomas

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00104" href="msg00104.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00055" href="msg00055.html">My comments</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00056" href="msg00056.html">Re: My comments</a></strong>
<ul><li><em>From:</em> Bradd W. Szonye</li></ul></li>
<li><strong><a name="00062" href="msg00062.html">Re: My comments</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00067" href="msg00067.html">Re: My comments</a></strong>
<ul><li><em>From:</em> Bradd W. Szonye</li></ul></li>
<li><strong><a name="00068" href="msg00068.html">Exactness (was Re: My comments)</a></strong>
<ul><li><em>From:</em> bear</li></ul></li>
<li><strong><a name="00070" href="msg00070.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00072" href="msg00072.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> bear</li></ul></li>
<li><strong><a name="00073" href="msg00073.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00074" href="msg00074.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00075" href="msg00075.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00080" href="msg00080.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00081" href="msg00081.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00083" href="msg00083.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00085" href="msg00085.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00086" href="msg00086.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00087" href="msg00087.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00088" href="msg00088.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00089" href="msg00089.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00090" href="msg00090.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00092" href="msg00092.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00094.html">Re: Exactness</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00096.html">Re: arithmetic issues</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00092.html">Re: Exactness</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00104.html">Re: Exactness</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00095"><strong>Date</strong></a></li>
<li><a href="threads.html#00095"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
