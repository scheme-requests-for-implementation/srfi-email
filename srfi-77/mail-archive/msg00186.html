<!-- MHonArc v2.6.15 -->
<!--X-Subject: Re: reading NaNs -->
<!--X-From-R13: orne <orneNfbavp.arg> -->
<!--X-Date: Mon, 24 Oct 2005 21:23:59 +0200 (MST) -->
<!--X-Message-Id: Pine.LNX.4.58.0510241046100.10420@bolt.sonic.net -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20051021145326.816C11B77BB@home.voluntocracy.org -->
<!--X-Reference: 20051022011713.1F22A1B77BB@home.voluntocracy.org -->
<!--X-Reference: 87vezqmjkq.fsf@becket.becket.net -->
<!--X-Reference: 20051022232548.5A2971B77BB@home.voluntocracy.org -->
<!--X-Reference: 873bmtxdnm.fsf@becket.becket.net -->
<!--X-Reference: 20051023181854.4E7DD1B77BB@home.voluntocracy.org -->
<!--X-Reference: 871x2cowe8.fsf@becket.becket.net -->
<!--X-Reference: 20051023195403.A50AF1B77BB@home.voluntocracy.org -->
<!--X-Reference: 435BEC21.60509@soegaard.net -->
<!--X-Reference: 20051023205012.BFD241B77BB@home.voluntocracy.org -->
<!--X-Reference: 87zmoz27dg.fsf@qrnik.zagroda -->
<!--X-Reference: 87hdb7kgmk.fsf@becket.becket.net -->
<!--X-Reference: 87k6g3zw34.fsf@qrnik.zagroda -->
<!--X-Reference: 871x2bkfj7.fsf@becket.becket.net -->
<!--X-Reference: 8764rnu45b.fsf@qrnik.zagroda -->
<!--X-Reference: 87br1fiv26.fsf@becket.becket.net -->
<!--X-Reference: 87ll0jpu0q.fsf@qrnik.zagroda -->
<!--X-Reference: 20051024022744.6CA581B77BB@home.voluntocracy.org -->
<!--X-Reference: 87veznbb37.fsf@qrnik.zagroda -->
<!--X-Reference: 8764rnbaqr.fsf@becket.becket.net -->
<!--X-Reference: 435C9A65.7060106@astrosmo.unam.mx -->
<!--X-Reference: 20051024153539.D98031B77BB@home.voluntocracy.org -->
<!--X-Reference: 435D1B3D.9080105@bothner.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: reading NaNs</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00185.html">Date Prev</a>][<a href="msg00187.html">Date Next</a>][<a href="msg00184.html">Thread Prev</a>][<a href="msg00189.html">Thread Next</a>][<a href="maillist.html#00186">Date Index</a>][<a href="threads.html#00186">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: reading NaNs</h1>
<p style="max-width: 30em;">This page is part of the web mail archives of <a href="http://srfi.schemers.org/srfi-77">SRFI 77</a> from before July 7th, 2015.  The new archives for SRFI 77 are <a href="http://srfi-email.schemers.org/srfi-77/">here</a>.  The new archives contain all messages, not just those from before July 7th, 2015.</p>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: Per Bothner &lt;<a href="mailto:per@DOMAIN.HIDDEN">per@xxxxxxxxxxx</a>&gt;</li>
<li><em>Subject</em>: Re: reading NaNs</li>
<li><em>From</em>: bear &lt;<a href="mailto:bear@DOMAIN.HIDDEN">bear@xxxxxxxxx</a>&gt;</li>
<li><em>Date</em>: Mon, 24 Oct 2005 12:23:42 -0700 (PDT)</li>
<li><em>Cc</em>: Aubrey Jaffer &lt;<a href="mailto:agj@DOMAIN.HIDDEN">agj@xxxxxxxxxxxx</a>&gt;, <a href="mailto:srfi-77@DOMAIN.HIDDEN">srfi-77@xxxxxxxxxxxxxxxxx</a></li>
<li><em>Delivered-to</em>: <a href="mailto:srfi-77@DOMAIN.HIDDEN">srfi-77@xxxxxxxxxxxxxxxxx</a></li>
<li><em>In-reply-to</em>: &lt;<a href="mailto:435D1B3D.9080105@DOMAIN.HIDDEN">435D1B3D.9080105@xxxxxxxxxxx</a>&gt;</li>
<li><em>References</em>: &lt;<a href="mailto:20051021145326.816C11B77BB@DOMAIN.HIDDEN">20051021145326.816C11B77BB@xxxxxxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:20051022011713.1F22A1B77BB@DOMAIN.HIDDEN">20051022011713.1F22A1B77BB@xxxxxxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87vezqmjkq.fsf@DOMAIN.HIDDEN">87vezqmjkq.fsf@xxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:20051022232548.5A2971B77BB@DOMAIN.HIDDEN">20051022232548.5A2971B77BB@xxxxxxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:873bmtxdnm.fsf@DOMAIN.HIDDEN">873bmtxdnm.fsf@xxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:20051023181854.4E7DD1B77BB@DOMAIN.HIDDEN">20051023181854.4E7DD1B77BB@xxxxxxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:871x2cowe8.fsf@DOMAIN.HIDDEN">871x2cowe8.fsf@xxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:20051023195403.A50AF1B77BB@DOMAIN.HIDDEN">20051023195403.A50AF1B77BB@xxxxxxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:435BEC21.60509@DOMAIN.HIDDEN">435BEC21.60509@xxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:20051023205012.BFD241B77BB@DOMAIN.HIDDEN">20051023205012.BFD241B77BB@xxxxxxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87zmoz27dg.fsf@DOMAIN.HIDDEN">87zmoz27dg.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87hdb7kgmk.fsf@DOMAIN.HIDDEN">87hdb7kgmk.fsf@xxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87k6g3zw34.fsf@DOMAIN.HIDDEN">87k6g3zw34.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:871x2bkfj7.fsf@DOMAIN.HIDDEN">871x2bkfj7.fsf@xxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:8764rnu45b.fsf@DOMAIN.HIDDEN">8764rnu45b.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87br1fiv26.fsf@DOMAIN.HIDDEN">87br1fiv26.fsf@xxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87ll0jpu0q.fsf@DOMAIN.HIDDEN">87ll0jpu0q.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:20051024022744.6CA581B77BB@DOMAIN.HIDDEN">20051024022744.6CA581B77BB@xxxxxxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:87veznbb37.fsf@DOMAIN.HIDDEN">87veznbb37.fsf@xxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:8764rnbaqr.fsf@DOMAIN.HIDDEN">8764rnbaqr.fsf@xxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:435C9A65.7060106@DOMAIN.HIDDEN">435C9A65.7060106@xxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:20051024153539.D98031B77BB@DOMAIN.HIDDEN">20051024153539.D98031B77BB@xxxxxxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:435D1B3D.9080105@DOMAIN.HIDDEN">435D1B3D.9080105@xxxxxxxxxxx</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>

Okay...

On a rereading of SRFI-77, I want to point out a couple things.

First, the new external representation where you have a suffixed
bar and decimal number indicating the bits of precision:  This is
a good and necessary extension to the information in inexact
constants, and I applaud it.

But we've got what is essentially one piece of information all over
the place now.  The inexact prefix, the exponent marker, and this new
suffix all signify inexactness and information about inexactness.
Since a lot of representations already support #&lt;decimal&gt;R prefixes
for radix, could we consider #&lt;decimal&gt;I prefixes for inexactness?

This would eliminate the need for the suffix entirely, and put the primary
inexactness information in one place.  The exponent markers are still
somewhat useful as ways to specify the use of indeterminate amounts of
precision that happen to be efficient on the current hardware.  So somebody
who needed only a little precision and wanted whatever the system found
&quot;easy&quot; or &quot;efficient&quot; could write 6.0F0, and somebody who knows that his
algorithm won't work if he has less than 16 bits of precision can write
#16i6.0.

I think you should specify that an implementation may use more bits of
precision than requested, and introduce some way to request that an
error be signalled if the implementation must use less.

Regarding &quot;safe&quot; and &quot;unsafe&quot; mode;  I think that &quot;unsafe&quot; mode should
_allow_ implementations to skip checks, not _require_ them to skip
checks.  Code that is incorrect in safe mode is still incorrect in unsafe
mode, and we should not provide a canonical way to run unsafe or incorrect
code.  Additionally, it is a lower initial bar for implementors; they can
get the system working correctly (in safe mode) and provide a trivial
unsafe mode (equal to their safe mode) to start with.  Finally, we can't
really tell in advance which checks can or ought to be done or skipped;
as compiler technology advances or as hardware advances some checks may
become &quot;free&quot; either at compile-time or in hardware at runtime.
Theoretically, some checks may even acquire negative cost if the hardware
uses them as &quot;cue&quot; indicators for heuristic branch predictions or prefetching.

Your redefinition of eqv? makes it the case that:

(eqv? #6.0L0 #6.0S0) =&gt; #t on implementations that use a single
floating-point representation size and #f on implementations that use
multiple floating-point representation sizes (because procedures like +
can produce results differing in precision depending on the precision
of its arguments).

So we have a situation where, first, the results of eqv? are specified
but implementation-dependent, and second, two numbers can be = without
being eqv?.  This is consistent with Lucier's proposal, which you
mention at the end of the SRFI, but you don't highlight the difference
anywhere.  I think I agree with your rationale and I think I agree
with the results and the respecification of eqv?; but the
ramifications on numerically equal numbers of different precisions is
not immediately obvious, so I wanted to point it out.

I strongly disagree with the idea of mixed exactness in the real and
imaginary parts of a complex number.  5.0+3i and 5+3.0i are the same
inexact number and should not be treated differently.

I would suggest requiring an error to be signalled if inexact-&gt;exact
gets an argument greater or less than any exact number representable
by the implementation.  Likewise if exact-&gt;inexact recieves an argument
outside the range representable as inexact numbers in the implementation.

Your formulation permits a fixnum range [0,1] and then states that
the modular mathematics primitives perform math modulo hi-lo+1.  I
first thought, somewhat obtusely, 'What does it mean to perform
mathematics modulo zero??' After a fractional second's thought, it
became clear that you meant (hi-lo)+1, not hi-(lo+1).  Consider using
fully parenthesized notation to avoid misinterpretation.  Remember
to also use it in your description of the functions that do modular
operations.

I still think that bitwise operations on numbers are incorrect.  Bitwise
operations should operate on bitvectors, not on numbers.  You are not
using them as numbers when you do bit operations on them, and their
identity as numbers does not give the length of the bitvector you're
using them for. This is faint and fuzzy thinking inherited from C and
confuses bit representation with semantics.

Absolute value is just a special case of complex magnitude, restricted
to the various ranges. In fact, (define abs magnitude) works just fine.
It didn't seem redundant in R5RS because complex numbers (and therefore
the magnitude accessor) weren't required in R5RS.  In a situation where
the whole tower is required, it seems redundant.

According to your definition of real? ...
 (real? z) &lt;==&gt; (let ((im (imag-part z))) (and (zero? im)(exact? im)))
but simultaneously,
(real? +nan.0) ==&gt; #t.
This implies that (imag-part +nan.0) is an exact zero, which seems wrong,
although consistent with your declaration of NaN as a real number of
indeterminate value.  Are complex operations constrained to return some
different kind of NaN, or do their results get coerced to the real line
in the event of an error?

				Bear






















</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00189" href="msg00189.html">Re: reading NaNs</a></strong>
<ul><li><em>From:</em> Aubrey Jaffer</li></ul></li>
<li><strong><a name="00196" href="msg00196.html">Re: reading NaNs</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00076" href="msg00076.html">arithmetic issues</a></strong>
<ul><li><em>From:</em> Aubrey Jaffer</li></ul></li>
<li><strong><a name="00096" href="msg00096.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Aubrey Jaffer</li></ul></li>
<li><strong><a name="00097" href="msg00097.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00122" href="msg00122.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Aubrey Jaffer</li></ul></li>
<li><strong><a name="00124" href="msg00124.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00137" href="msg00137.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Aubrey Jaffer</li></ul></li>
<li><strong><a name="00139" href="msg00139.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00143" href="msg00143.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Aubrey Jaffer</li></ul></li>
<li><strong><a name="00144" href="msg00144.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Jens Axel S&#xF8;gaard</li></ul></li>
<li><strong><a name="00148" href="msg00148.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Aubrey Jaffer</li></ul></li>
<li><strong><a name="00152" href="msg00152.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00153" href="msg00153.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00154" href="msg00154.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00155" href="msg00155.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00156" href="msg00156.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00157" href="msg00157.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00158" href="msg00158.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00167" href="msg00167.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Aubrey Jaffer</li></ul></li>
<li><strong><a name="00178" href="msg00178.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00179" href="msg00179.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
<li><strong><a name="00180" href="msg00180.html">Re: arithmetic issues</a></strong>
<ul><li><em>From:</em> Alan Watson</li></ul></li>
<li><strong><a name="00182" href="msg00182.html">reading NaNs</a></strong>
<ul><li><em>From:</em> Aubrey Jaffer</li></ul></li>
<li><strong><a name="00184" href="msg00184.html">Re: reading NaNs</a></strong>
<ul><li><em>From:</em> Per Bothner</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00185.html">Re: reading NaNs</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00187.html">Re: reading NaNs</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00184.html">Re: reading NaNs</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00189.html">Re: reading NaNs</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00186"><strong>Date</strong></a></li>
<li><a href="threads.html#00186"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
