<!-- MHonArc v2.6.15 -->
<!--X-Subject: Re: Exactness -->
<!--X-From-R13: [nepva 'Cepmnx' Ybjnypmlx <depmnxNxaz.bet.cy> -->
<!--X-Date: Fri, 21 Oct 2005 04:08:42 +0200 (MST) -->
<!--X-Message-Id: 87hdbbfwps.fsf@qrnik.zagroda -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 87wtk9qro1.fsf@qrnik.zagroda -->
<!--X-Reference: 20051019191720.GA24703@mimir.szonye.com -->
<!--X-Reference: 87fyqxb6i6.fsf@qrnik.zagroda -->
<!--X-Reference: 20051019220800.GF24703@mimir.szonye.com -->
<!--X-Reference: Pine.LNX.4.58.0510191726410.13819@bolt.sonic.net -->
<!--X-Reference: 87ach45z5v.fsf@qrnik.zagroda -->
<!--X-Reference: Pine.LNX.4.58.0510201408480.6745@bolt.sonic.net -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: Exactness</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00072.html">Date Prev</a>][<a href="msg00074.html">Date Next</a>][<a href="msg00072.html">Thread Prev</a>][<a href="msg00074.html">Thread Next</a>][<a href="maillist.html#00073">Date Index</a>][<a href="threads.html#00073">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: Exactness</h1>
<p style="max-width: 30em;">This page is part of the web mail archives of <a href="http://srfi.schemers.org/srfi-77">SRFI 77</a> from before July 7th, 2015.  The new archives for SRFI 77 are <a href="http://srfi-email.schemers.org/srfi-77/">here</a>.  The new archives contain all messages, not just those from before July 7th, 2015.</p>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: <a href="mailto:srfi-77@DOMAIN.HIDDEN">srfi-77@xxxxxxxxxxxxxxxxx</a></li>
<li><em>Subject</em>: Re: Exactness</li>
<li><em>From</em>: Marcin 'Qrczak' Kowalczyk &lt;<a href="mailto:qrczak@DOMAIN.HIDDEN">qrczak@xxxxxxxxxx</a>&gt;</li>
<li><em>Date</em>: Fri, 21 Oct 2005 04:08:31 +0200</li>
<li><em>Delivered-to</em>: <a href="mailto:srfi-77@DOMAIN.HIDDEN">srfi-77@xxxxxxxxxxxxxxxxx</a></li>
<li><em>In-reply-to</em>: &lt;<a href="mailto:Pine.LNX.4.58.0510201408480.6745@DOMAIN.HIDDEN">Pine.LNX.4.58.0510201408480.6745@xxxxxxxxxxxxxx</a>&gt; (<a href="mailto:bear@DOMAIN.HIDDEN">bear@xxxxxxxxx</a>'s message of &quot;Thu, 20 Oct 2005 15:08:57 -0700 (PDT)&quot;)</li>
<li><em>Mail-followup-to</em>: <a href="mailto:srfi-77@DOMAIN.HIDDEN">srfi-77@xxxxxxxxxxxxxxxxx</a></li>
<li><em>References</em>: &lt;<a href="mailto:87wtk9qro1.fsf@DOMAIN.HIDDEN">87wtk9qro1.fsf@xxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:20051019191720.GA24703@DOMAIN.HIDDEN">20051019191720.GA24703@xxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:87fyqxb6i6.fsf@DOMAIN.HIDDEN">87fyqxb6i6.fsf@xxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:20051019220800.GF24703@DOMAIN.HIDDEN">20051019220800.GF24703@xxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:Pine.LNX.4.58.0510191726410.13819@DOMAIN.HIDDEN">Pine.LNX.4.58.0510191726410.13819@xxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:87ach45z5v.fsf@DOMAIN.HIDDEN">87ach45z5v.fsf@xxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:Pine.LNX.4.58.0510201408480.6745@DOMAIN.HIDDEN">Pine.LNX.4.58.0510201408480.6745@xxxxxxxxxxxxxx</a>&gt;</li>
<li><em>Sender</em>: Marcin 'Qrczak' Kowalczyk &lt;<a href="mailto:qrczak@DOMAIN.HIDDEN">qrczak@xxxxxxxxxx</a>&gt;</li>
<li><em>User-agent</em>: Gnus/5.1006 (Gnus v5.10.6) Emacs/21.3 (gnu/linux)</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>bear &lt;bear@xxxxxxxxx&gt; writes:

&gt;&gt; Suppose we have two flonums tagged as exact. You divide them, and the
&gt;&gt; result is not a finite binary fraction, so the implementation can't
&gt;&gt; use the same representation for the result. What should it do?
&gt;&gt;
&gt;&gt; a) Represent it in a flonum tagged as inexact.
&gt;&gt; b) Represent it as an exact ratio of two integers.
&gt;
&gt; c) consult settings or dynamic variables to see what the program
&gt;    or user wants it to do.
&gt; d) give an exact result if the representation width needed for
&gt;    it is allowed, otherwise give an inexact result with the
&gt;    maximum representation width allowed by the current settings.
&gt; e) store a promise rather than an explicit numeric representation,
&gt;    allowing the user to decide later how much precision they want
&gt;    and propagating demands for precision into the branches of the
&gt;    promise as necessary.
&gt; f) ... something else you haven't thought of.
&gt; g) ... something else *I* haven't thought of.

In other words a portable program can't predict what will happen and
can't state its requirements. This is bad.

I know what to expect from IEEE floats. I know for example that
calculations in a certain range of integers are exact. Or that numbers
have the same relative precision but different absolute precision, for
a wide range of magnitudes. Or that certain primitive operations take
constant time, and a number uses a fixed amount of memory - it doesn't
keep growing precision. I should be able to know more in Scheme - for
example that by default a flonum overflow will not be fatal but will
yield +inf.0, which will compare as greater than any other number
except itself and +nan.0.

I know what to expect from ratios.

I don't know what to expect from inexact real numbers. Do they behave
like floats, or like ratios with inexactness bit? It does matter!

&gt;&gt; And that's good, it's not orthogonal. If it was, using different
&gt;&gt; representations for numbers of the same value and the same precision
&gt;&gt; would be redundant. R5RS even specifies that such numbers would be
&gt;&gt; indistinguishable (even more: the precision is not compared but the
&gt;&gt; exactness only, which is wrong if there are several possible amounts
&gt;&gt; of inexact precision, and SRFI-77 fixes that).
&gt;
&gt; Yes.  They *should* be indistinguishable.

What if they have different precisions? Imagine a Scheme
implementation with two flonum formats, where (= 3s0 3L0) is #t
but (= (/ 3s0) (/ 3L0)) is #f; this behavior should't be surprising.
What should be (eqv? 3s0 3L0)?

&gt;&gt; I presume then that since (factorial 100) preserves all 158 digits,
&gt;&gt; you want (factorial 100.0) to produce a result with 158 digits but
&gt;&gt; tagged as inexact, right?
&gt;
&gt; If there is a presumption in effect that inexact numbers in source
&gt; whose precision isn't given explicitly are known to 158 digits or more,
&gt; then yes, I'd want the result to 158 digits.  If the presumption is
&gt; that inexact numbers in source whose precision isn't given explicitly
&gt; are known to just 20 digits, then I'd want the first 20 digits and
&gt; the magnitude.

If the number was read as 100.0, how many digits are accurate? The
person who entered the data into a file didn't specify the precision;
usually you can't assume that only these 4 digits are accurate.

You propose that the programmer can't be sure what will happen.

if it was obtained by (exact-&gt;inexact 100), then all digits are
accurate. You propose that the programmer should not be able to apply
exact-&gt;inexact to inputs to ensure that the result will be obtained
numerically while keeping time and space of individual operations
constant.

&gt; Remember that R5RS' full numeric syntax, which virtually nobody takes
&gt; full advantage of, allows explicitly *telling* the system how much
&gt; precision a number has.

It's not enough. How many digits will #i1/3 store? You propose that
the programmer can't know whether there is a fixed number of digits
at all.

If somebody implements fancy numeric types with dynamically settable
precision or with lazily computed digits, I want to use them
explicitly - I don't want them to take over the syntax that virtually
all other languages use for IEEE floating point. I want the precision
and efficiency of computation to be predictable.

&gt;&gt; Are there any implementations where it is?
&gt;
&gt; MITScheme, for one.  There are probably a few others.

Huh? Judging from the sources it doesn't do anyhting like this. For
example exact-&gt;inexact converts everything to flonums or a complex
of flonums.

-- 
   __(&quot;&lt;         Marcin Kowalczyk
   \__/       qrczak@xxxxxxxxxx
    ^^     <a  rel="nofollow" href="http://qrnik.knm.org.pl/~qrczak/">http://qrnik.knm.org.pl/~qrczak/</a>

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00074" href="msg00074.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Thomas Bushnell BSG</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00055" href="msg00055.html">My comments</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00056" href="msg00056.html">Re: My comments</a></strong>
<ul><li><em>From:</em> Bradd W. Szonye</li></ul></li>
<li><strong><a name="00062" href="msg00062.html">Re: My comments</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00067" href="msg00067.html">Re: My comments</a></strong>
<ul><li><em>From:</em> Bradd W. Szonye</li></ul></li>
<li><strong><a name="00068" href="msg00068.html">Exactness (was Re: My comments)</a></strong>
<ul><li><em>From:</em> bear</li></ul></li>
<li><strong><a name="00070" href="msg00070.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> Marcin 'Qrczak' Kowalczyk</li></ul></li>
<li><strong><a name="00072" href="msg00072.html">Re: Exactness</a></strong>
<ul><li><em>From:</em> bear</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00072.html">Re: Exactness</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00074.html">Re: Exactness</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00072.html">Re: Exactness</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00074.html">Re: Exactness</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00073"><strong>Date</strong></a></li>
<li><a href="threads.html#00073"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
