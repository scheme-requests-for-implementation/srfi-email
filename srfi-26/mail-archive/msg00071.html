<!-- MHonArc v2.6.15 -->
<!--X-Subject: Re: New revision of SRFI 26 available -->
<!--X-From-R13: fronfgvna.rtareNcuvyvcf.pbz -->
<!--X-Date: Wed,  5 Jun 2002 13:13:08 +0200 (DFT) -->
<!--X-Message-Id: OF5E6A8088.93DD2725&#45;ONC1256BCF.002B8B0B@diamond.philips.com -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: New revision of SRFI 26 available</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00070.html">Date Prev</a>][<a href="msg00072.html">Date Next</a>][<a href="msg00070.html">Thread Prev</a>][<a href="msg00072.html">Thread Next</a>][<a href="maillist.html#00071">Date Index</a>][<a href="threads.html#00071">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: New revision of SRFI 26 available</h1>
<p style="max-width: 30em;">This page is part of the web mail archives of <a href="http://srfi.schemers.org/srfi-26">SRFI 26</a> from before July 7th, 2015.  The new archives for SRFI 26 are <a href="http://srfi-email.schemers.org/srfi-26/">here</a>.  The new archives contain all messages, not just those from before July 7th, 2015.</p>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: <a href="mailto:srfi-26@DOMAIN.HIDDEN">srfi-26@xxxxxxxxxxxxxxxxx</a></li>
<li><em>Subject</em>: Re: New revision of SRFI 26 available</li>
<li><em>From</em>: <a href="mailto:sebastian.egner@DOMAIN.HIDDEN">sebastian.egner@xxxxxxxxxxx</a></li>
<li><em>Date</em>: Wed, 5 Jun 2002 13:10:13 +0200</li>
<li><em>Delivered-to</em>: <a href="mailto:srfi-26@DOMAIN.HIDDEN">srfi-26@xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->

<br><font size=2 face="sans-serif">Al,</font>
<br>
<br><font size=2 face="sans-serif">1. The HTML typo:</font>
<br>
<br><font size=2 face="sans-serif">It will be corrected.<br>
</font>
<br><font size=2 face="sans-serif">2. Semantics for non-expressions in non-slot position:</font>
<br>
<br><font size=2 face="sans-serif">Ok. I have decided to follow your suggestion. The non-slot</font>
<br><font size=2 face="sans-serif">expressions have to be &lt;expressions&gt; in the sense of R5RS.</font>
<br>
<br><font size=2 face="sans-serif">After considering the pro's and con's of defining the mechanism one</font>
<br><font size=2 face="sans-serif">way or the other, I think the mechanism is not important enough to add</font>
<br><font size=2 face="sans-serif">another idiosyncrasy to Scheme. </font>
<br>
<br><font size=2 face="sans-serif">I will change the spec/impl.</font>
<br>
<br><font size=2 face="sans-serif">3. Explanation of non-slot expressions:</font>
<br>
<br><font size=2 face="Courier New">&gt; &nbsp; &lt;const-or-slot&gt; --&gt; &lt;&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; a &quot;slot&quot;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &lt;_expression_&gt; &nbsp;; a constant, not directly dependent<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; &nbsp;on the slots<br>
&gt;</font>
<br><font size=2 face="Courier New">&gt; The constants aren't indirectly dependent on the slots either.<br>
&gt; Perhaps &quot;a `constant', an _expression_ independent of the slot values&quot;<br>
&gt; would be clearer.</font>
<br>
<br><font size=2 face="sans-serif">Unfortunately, the problem persists in your formulation: In ((cut + a &lt;&gt;) a) the </font>
<br><font size=2 face="sans-serif">non-slot `a' of the cut is certainly dependent on the value of the slot (it's even </font>
<br><font size=2 face="sans-serif">identical). Even worse, it is not very clear what is meant by saying &quot;an _expression_</font>
<br><font size=2 face="sans-serif">depends on a value&quot; as the _expression_ is a syntactic object and the value is</font>
<br><font size=2 face="sans-serif">a constant in the semantic domain. Hence, we need to talk about the function</font>
<br><font size=2 face="sans-serif">being defined by the _expression_, the variables generated for the slots and</font>
<br><font size=2 face="sans-serif">need to unfold the entire semantics of Scheme. However, I doubt that this will</font>
<br><font size=2 face="sans-serif">clarify the mechanism a lot.</font>
<br>
<br><font size=2 face="sans-serif">Unless we really provide a semantics, there will always be some confusion.</font>
<br><font size=2 face="sans-serif">However, the name &quot;constant&quot; is not really important for understanding the</font>
<br><font size=2 face="sans-serif">mechanism. I will drop the &quot;constant&quot; business altogether and simply call it </font>
<br><font size=2 face="sans-serif">&quot;non-slot _expression_&quot; and replace &lt;const-or-slot&gt; by &lt;slot-or-expr&gt;.</font>
<br>
<br><font size=2 face="sans-serif">4. Definition of variable arity: </font>
<br>
<br><font size=2 face="sans-serif">Good observation. The specification will be changed.</font>
<br>
<br><font size=2 face="sans-serif">5. Evaluation order:</font>
<br>
<br><font size=2 face="sans-serif">Another good observation. Will be corrected.</font>
<br>
<br><font size=2 face="sans-serif">---</font>
<br>
<br><font size=2 face="sans-serif">Apparently, your code does exactly what the reference implementation</font>
<br><font size=2 face="sans-serif">is supposed to do and it is very clear.</font>
<br>
<br><font size=2 face="sans-serif">Any objections if I steal your code and put it forward as the </font>
<br><font size=2 face="sans-serif">reference implementation (with &lt;const-or-slot&gt; substituted by </font>
<br><font size=2 face="sans-serif">&lt;slot-or-expr&gt; etc. to match with the SRFI-document)? </font>
<br><font size=2 face="sans-serif">You will be mentioned as the author, of course.</font>
<br>
<br><font size=2 face="sans-serif">Sebastian.</font>
<br><font size=2 face="sans-serif"><br>
----<br>
Dr. Sebastian Egner<br>
Senior Scientist<br>
Philips Research Laboratories<br>
Prof. Holstlaan 4 (WY2)<br>
5656 AA Eindhoven<br>
The Netherlands<br>
tel: &nbsp; &nbsp; &nbsp; +31 40 27-43309<br>
fax: &nbsp; &nbsp; &nbsp;+31 40 27-44918<br>
email: sebastian.egner@xxxxxxxxxxx</font>
<br>
<br>
<br>
<table width=100%>
<tr valign=top>
<td>
<td><font size=1 face="sans-serif"><b>srfi-26-request@xxxxxxxxxxxxxxxxx</b></font>
<p><font size=1 face="sans-serif">06/04/02 20:58</font>
<br>
<td><font size=1 face="Arial">&nbsp; &nbsp; &nbsp; &nbsp; </font>
<br><font size=1 face="sans-serif">&nbsp; &nbsp; &nbsp; &nbsp; To: &nbsp; &nbsp; &nbsp; &nbsp;srfi-26@xxxxxxxxxxxxxxxxx</font>
<br><font size=1 face="sans-serif">&nbsp; &nbsp; &nbsp; &nbsp; cc: &nbsp; &nbsp; &nbsp; &nbsp;(bcc: Sebastian Egner/EHV/RESEARCH/PHILIPS)</font>
<br><font size=1 face="sans-serif">&nbsp; &nbsp; &nbsp; &nbsp; Subject: &nbsp; &nbsp; &nbsp; &nbsp;Re: New revision of SRFI 26 available</font>
<p><font size=1 face="sans-serif">&nbsp; &nbsp; &nbsp; &nbsp; Classification: &nbsp; &nbsp; &nbsp; &nbsp;</font>
<br></table>
<br>
<br>
<br><font size=2 face="Courier New">Some issues with the latest draft:<br>
<br>
In the code samples within the html, like this:<br>
<br>
 &nbsp;&lt;code&gt;(cut cons (+ a 1) &lt;&gt;)&lt;/code&gt;<br>
 <br>
My browser is displaying this as (cut cons (+ a 1) ). &nbsp;The angle<br>
brackets need to be escaped.<br>
<br>
 &nbsp;(apply + (map (cut if &lt;&gt; 0 1) '(#f #t #t #f)))<br>
<br>
This is an error according to the specification that &quot;const&quot;s must be<br>
expressions. &nbsp;I suggest you keep that requirement and drop support for<br>
this usage unless you can come up with a reasonable semantics for (cut<br>
quasiquote &lt;&gt;), or some way to specify which non-expressions are and<br>
are not allowed as &quot;const&quot;s.<br>
<br>
<br>
 &nbsp; &lt;const-or-slot&gt; --&gt; &lt;&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; a &quot;slot&quot;<br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &lt;_expression_&gt; &nbsp;; a constant, not directly dependent<br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; &nbsp;on the slots<br>
<br>
The constants aren't indirectly dependent on the slots either.<br>
Perhaps &quot;a `constant', an _expression_ independent of the slot values&quot;<br>
would be clearer.<br>
<br>
 &nbsp;In case there is a rest-slot symbol for the residual arguments of a<br>
 &nbsp;variable arity procedure, the resulting procedure is also of<br>
 &nbsp;variable arity<br>
<br>
If a system provides a variable-arity? procedure, I would expect it to<br>
interact with cut like this:<br>
<br>
 &nbsp;(variable-arity? list) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; =&gt; #t<br>
 &nbsp;(variable-arity? (cut list &lt;&gt;)) &nbsp; &nbsp;=&gt; #f<br>
 &nbsp;(variable-arity? cons) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; =&gt; #f<br>
 &nbsp;(variable-arity? (cut cons &lt;...&gt;)) =&gt; #t<br>
<br>
Hence, I think it would be simpler and more accurate to say:<br>
<br>
 &nbsp;If there is a rest-slot symbol for residual arguments, the resulting<br>
 &nbsp;procedure is of variable arity<br>
<br>
The implementation gets the second of these tests wrong:<br>
<br>
 &nbsp;(let* ((x 'cute) (y (cut &nbsp;list x))) (set! x 'cut) (y)) &nbsp;=&gt; cut<br>
 &nbsp;(let* ((x 'cute) (y (cute list x))) (set! x 'cut) (y)) &nbsp;=&gt; cute<br>
<br>
Two non-bug drawbacks to the implementation are that it doesn't catch<br>
errors like (cut if &lt;&gt; 0 1) and it forces an evaluation order for the<br>
&quot;const&quot;s in a cute _expression_. &nbsp;Here's one way to address all three<br>
issues:<br>
<br>
; (srfi-26-internal-cut slot-names combination . cs)<br>
; &nbsp; transformer used internally<br>
; &nbsp; &nbsp; slot-names &nbsp;: the internal names of the slots<br>
; &nbsp; &nbsp; combination : procedure being specialized, followed by its arguments<br>
; &nbsp; &nbsp; cs &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: consts-or-slots, the qualifiers of the macro<br>
<br>
(define-syntax srfi-26-internal-cut<br>
 &nbsp;(syntax-rules (&lt;&gt; &lt;...&gt;)<br>
<br>
 &nbsp; &nbsp;;; construct fixed- or variable-arity procedure<br>
 &nbsp; &nbsp;((srfi-26-internal-cut (slot-name ...) (proc arg ...))<br>
 &nbsp; &nbsp; (lambda (slot-name ...) ((begin proc) arg ...)))<br>
 &nbsp; &nbsp;((srfi-26-internal-cut (slot-name ...) (proc arg ...) &lt;...&gt;)<br>
 &nbsp; &nbsp; (lambda (slot-name ... . rest-slot) (apply proc arg ... rest-slot)))<br>
<br>
 &nbsp; &nbsp;;; process one const-or-slot<br>
 &nbsp; &nbsp;((srfi-26-internal-cut (slot-name ...) &nbsp; (position ...) &nbsp; &nbsp; &nbsp;&lt;&gt; &nbsp; &nbsp;. cs)<br>
 &nbsp; &nbsp; (srfi-26-internal-cut (slot-name ... x) (position ... x) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;. cs))<br>
 &nbsp; &nbsp;((srfi-26-internal-cut (slot-name ...) &nbsp; (position ...) &nbsp; &nbsp; &nbsp;const . cs)<br>
 &nbsp; &nbsp; (srfi-26-internal-cut (slot-name ...) &nbsp; (position ... const) &nbsp; &nbsp; &nbsp;. cs))))<br>
<br>
; (srfi-26-internal-cute slot-names const-bindings combination . cs)<br>
; &nbsp; transformer used internally<br>
; &nbsp; &nbsp; slot-names &nbsp; &nbsp; : the internal names of the slots<br>
; &nbsp; &nbsp; const-bindings : let-style bindings for the constants.<br>
; &nbsp; &nbsp; combination &nbsp; &nbsp;: procedure being specialized, followed by its arguments<br>
; &nbsp; &nbsp; cs &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : consts-or-slots, the qualifiers of the macro<br>
<br>
(define-syntax srfi-26-internal-cute<br>
 &nbsp;(syntax-rules (&lt;&gt; &lt;...&gt;)<br>
 &nbsp; &nbsp;;; If there are no const-or-slots to process, then:<br>
 &nbsp; &nbsp;;; construct a fixed-arity procedure,<br>
 &nbsp; &nbsp;((srfi-26-internal-cute<br>
 &nbsp; &nbsp; &nbsp;(slot-name ...) const-bindings (proc arg ...))<br>
 &nbsp; &nbsp; (let const-bindings (lambda (slot-name ...) (proc arg ...))))<br>
 &nbsp; &nbsp;;; or a variable-arity procedure<br>
 &nbsp; &nbsp;((srfi-26-internal-cute<br>
 &nbsp; &nbsp; &nbsp;(slot-name ...) const-bindings (proc arg ...) &lt;...&gt;)<br>
 &nbsp; &nbsp; (let const-bindings (lambda (slot-name ... . x) (apply proc arg ... x))))<br>
<br>
 &nbsp; &nbsp;;; otherwise, process one slot:<br>
 &nbsp; &nbsp;((srfi-26-internal-cute<br>
 &nbsp; &nbsp; &nbsp;(slot-name ...) &nbsp; &nbsp; &nbsp; &nbsp; const-bindings &nbsp;(position ...) &nbsp; &lt;&gt; &nbsp; &nbsp;. cs)<br>
 &nbsp; &nbsp; (srfi-26-internal-cute<br>
 &nbsp; &nbsp; &nbsp;(slot-name ... x) &nbsp; &nbsp; &nbsp; const-bindings &nbsp;(position ... x) &nbsp; &nbsp; &nbsp; . cs))<br>
 &nbsp; &nbsp;;; or one const<br>
 &nbsp; &nbsp;((srfi-26-internal-cute<br>
 &nbsp; &nbsp; &nbsp;slot-names &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const-bindings &nbsp;(position ...) &nbsp; const . cs)<br>
 &nbsp; &nbsp; (srfi-26-internal-cute<br>
 &nbsp; &nbsp; &nbsp;slot-names ((x const) . const-bindings) (position ... x) &nbsp; &nbsp; &nbsp; . cs))))<br>
<br>
; exported syntax<br>
<br>
(define-syntax cut<br>
 &nbsp;(syntax-rules (&lt;&gt; &lt;...&gt;)<br>
 &nbsp; &nbsp;((cut . consts-or-slots)<br>
 &nbsp; &nbsp; (srfi-26-internal-cut () () . consts-or-slots))))<br>
<br>
(define-syntax cute<br>
 &nbsp;(syntax-rules (&lt;&gt; &lt;...&gt;)<br>
 &nbsp; &nbsp;((cute . consts-or-slots)</font>
<br><font size=2 face="Courier New">&nbsp; &nbsp; &nbsp;(srfi-26-internal-cute () () () . consts-or-slots))))<br>
<br>
</font>
<br>
<br>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00072" href="msg00072.html">Re: New revision of SRFI 26 available</a></strong>
<ul><li><em>From:</em> Al Petrofsky</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00070.html">Re: New revision of SRFI 26 available</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00072.html">Re: New revision of SRFI 26 available</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00070.html">Re: New revision of SRFI 26 available</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00072.html">Re: New revision of SRFI 26 available</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00071"><strong>Date</strong></a></li>
<li><a href="threads.html#00071"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
