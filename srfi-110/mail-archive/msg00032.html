<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: how useful are collecting lists? -->
<!--X-From-R13: Rnivq Hnaqrefba <qnivq.inaqrefbaNtznvy.pbz> -->
<!--X-Date: Thu, 14 Mar 2013 23:06:43 +0000 (UTC) -->
<!--X-Message-Id: 514257F9.9070408@gmail.com -->
<!--X-Content-Type: multipart/mixed -->
<!--X-Reference: 513EAE55.80204@gmail.com -->
<!--X-Reference: E1UFYz2&#45;0001Am&#45;U6@taishi.runbox.com -->
<!--X-Reference: 513FD6A2.50307@gmail.com -->
<!--X-Reference: E1UFbme&#45;0002nk&#45;2g@taishi.runbox.com -->
<!--X-Reference: CAF+kUQXGcbBydOv&#45;0xriFb2om96c2jmw8qdmv50XKD0GseLhhw@mail.gmail.com -->
<!--X-Reference: E1UFvDh&#45;0001ID&#45;06@rmm6prod02.runbox.com -->
<!--X-Reference: 514125BC.1080106@gmail.com -->
<!--X-Reference: E1UFxob&#45;0005DJ&#45;3A@rmm6prod02.runbox.com -->
<!--X-Reference: 514137EF.6060209@gmail.com -->
<!--X-Reference: E1UFyc7&#45;0002z1&#45;GT@rmm6prod02.runbox.com -->
<!--X-Reference: 514159DF.9080301@gmail.com -->
<!--X-Reference: E1UGFpN&#45;0006Z9&#45;Vb@rmm6prod02.runbox.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: how useful are collecting lists?</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00031.html">Date Prev</a>][<a href="msg00033.html">Date Next</a>][<a href="msg00031.html">Thread Prev</a>][<a href="msg00033.html">Thread Next</a>][<a href="maillist.html#00032">Date Index</a>][<a href="threads.html#00032">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: how useful are collecting lists?</h1>
<p style="max-width: 30em;">This page is part of the web mail archives of <a href="http://srfi.schemers.org/srfi-110">SRFI 110</a> from before July 7th, 2015.  The new archives for SRFI 110 are <a href="http://srfi-email.schemers.org/srfi-110/">here</a>.  Eventually, the entire history will be moved there, including any new messages.</p>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: <a href="mailto:srfi-110@DOMAIN.HIDDEN">srfi-110@xxxxxxxxxxxxxxxxx</a></li>
<li><em>Subject</em>: Re: how useful are collecting lists?</li>
<li><em>From</em>: David Vanderson &lt;<a href="mailto:david.vanderson@DOMAIN.HIDDEN">david.vanderson@xxxxxxxxx</a>&gt;</li>
<li><em>Date</em>: Thu, 14 Mar 2013 16:06:33 -0700</li>
<li><em>Delivered-to</em>: <a href="mailto:srfi-110@DOMAIN.HIDDEN">srfi-110@xxxxxxxxxxxxxxxxx</a></li>
<li><em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=gmail.com; s=20120113;        h=x-received:message-id:date:from:user-agent:mime-version:to:subject         :references:in-reply-to:content-type;        bh=UdhBZ1504bsD/lmDOJmJcLKQ37pH0HO5xYWpW2oAeek=;        b=0d4KTd3O2g0k90aV6h9cjqffPE/+9AWPr25j2iacfeSNWyG3mkuqIytwgONKbpVlN2         Ff2IKkxSQ3nDeaQuiw4mRfOD2gjJIf8JvBz6m8QukjLznO4eaAmPs2Ro8EqLZQZNO87A         plixf0wRAfL2BHDVmgo+wmfKzclxF4G88sIQJw8F4Jw+qP50SDJplqIAf+J1xETVE1rW         3qzj9symqv8SlLNCoDN7URx3Gqypj+dvgUszhmdcGJ5HSAPfW5ygLI88g6YPrrz0b/k8         wf8ggVwcNuwIaSFxnR5HUZX9EblDTb3lphixjRJyNcfyuDOzGq/1XhffrCab8Ul/blVU         C7wA==</li>
<li><em>In-reply-to</em>: &lt;<a href="mailto:E1UGFpN-0006Z9-Vb@DOMAIN.HIDDEN">E1UGFpN-0006Z9-Vb@xxxxxxxxxxxxxxxxxxxxx</a>&gt;</li>
<li><em>References</em>: &lt;<a href="mailto:513EAE55.80204@DOMAIN.HIDDEN">513EAE55.80204@xxxxxxxxx</a>&gt; &lt;<a href="mailto:E1UFYz2-0001Am-U6@DOMAIN.HIDDEN">E1UFYz2-0001Am-U6@xxxxxxxxxxxxxxxxx</a>&gt;	&lt;<a href="mailto:513FD6A2.50307@DOMAIN.HIDDEN">513FD6A2.50307@xxxxxxxxx</a>&gt; &lt;<a href="mailto:E1UFbme-0002nk-2g@DOMAIN.HIDDEN">E1UFbme-0002nk-2g@xxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:CAF%2BkUQXGcbBydOv-0xriFb2om96c2jmw8qdmv50XKD0GseLhhw@DOMAIN.HIDDEN">CAF+kUQXGcbBydOv-0xriFb2om96c2jmw8qdmv50XKD0GseLhhw@xxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:E1UFvDh-0001ID-06@DOMAIN.HIDDEN">E1UFvDh-0001ID-06@xxxxxxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:514125BC.1080106@DOMAIN.HIDDEN">514125BC.1080106@xxxxxxxxx</a>&gt; &lt;<a href="mailto:E1UFxob-0005DJ-3A@DOMAIN.HIDDEN">E1UFxob-0005DJ-3A@xxxxxxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:514137EF.6060209@DOMAIN.HIDDEN">514137EF.6060209@xxxxxxxxx</a>&gt; &lt;<a href="mailto:E1UFyc7-0002z1-GT@DOMAIN.HIDDEN">E1UFyc7-0002z1-GT@xxxxxxxxxxxxxxxxxxxxx</a>&gt; &lt;<a href="mailto:514159DF.9080301@DOMAIN.HIDDEN">514159DF.9080301@xxxxxxxxx</a>&gt; &lt;<a href="mailto:E1UGFpN-0006Z9-Vb@DOMAIN.HIDDEN">E1UGFpN-0006Z9-Vb@xxxxxxxxxxxxxxxxxxxxx</a>&gt;</li>
<li><em>User-agent</em>: Mozilla/5.0 (X11; Linux x86_64; rv:17.0) Gecko/20130308 Thunderbird/17.0.4</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">

On 03/14/2013 02:36 PM, David A. Wheeler wrote:
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
David Vanderson &lt;david.vanderson@xxxxxxxxx&gt; wrote:
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
First attempt attached.  Please let me know if I'm going in a decent direction.
</pre></blockquote><pre style="margin: 0em;">
Since you said &quot;First attempt&quot;, I'm assuming that you're going to make some further changes and then submit it, which is fine.

If that's not your intent, and you want me to just start by accepting and then editing this, that's fine too.  Just let me know.

I think it'd be easier to take smaller changes and do them incrementally, where we can.

--- David A. Wheeler

</pre></blockquote><tt>Good point.  I've attached an updated diff incorporating the feedback so 
</tt><tt>far, but don't have anything else right now.  Please accept and edit as 
</tt><tt>you like.  I'll try to do smaller changes in the future.
</tt><pre style="margin: 0em;">

Thanks,
Dave
</pre><pre>diff --git a/SRFI-110.html b/SRFI-110.html
index 41a93b2..feeb62e 100644
--- a/SRFI-110.html
+++ b/SRFI-110.html
@@ -3152,58 +3152,14 @@ is a single datum.
 
 &lt;h3 id=&quot;collecting-lists&quot;&gt;Collecting lists (&amp;lt;* ... *&amp;gt;)&lt;/h3&gt;
 &lt;p&gt;
-Sweet-expressions without collecting lists (&amp;lt;* ... *&amp;gt;)
-work well in a vast number of circumstances.
-However, they can be somewhat awkward for two use cases:
+Each sweet-expression is ended with a blank line, which is usually what you
+want.  There is one circumstance where that behavior is awkward: a long
+sequence of definitions within an initial statement.  The solution is also
+useful for 1-2 variable let-like statements.
 &lt;/p&gt;
-&lt;ol&gt;
-&lt;li&gt;A long sequence of definitions contained within an initial statement.
-This situation occurs in many library definition structures such as
-Scheme R7RS &lt;tt&gt;define-library&lt;/tt&gt; and in some larger data structures.&lt;/li&gt;
-&lt;li&gt;A let-style statement with one or two variables
-with short initial values.&lt;/li&gt;
-&lt;/ol&gt;
-&lt;p&gt;
-Let&amp;#8217;s begin with the first use case.
-When there is a long sequence of definitions contained within an
-initial statement, and no special notation like collecting lists,
-all the definitions in the long sequence must be
-indented and none can be separated by a blank line
-(since that would end the entire sequence, not just a definition).
-Indenting almost an entire file is annoying, and needing no blank lines
-for that long invites mistakes.
-&lt;/p&gt;
-
-&lt;p&gt;
-For example, here&amp;#8217;s an example from the R7RS Scheme specification
-for define-library:
-&lt;/p&gt;
-&lt;pre&gt;
-(define-library
-  (example grid)
-  (export make rows cols ref each (rename put! set!))
-  (import (scheme base))
-  (begin
-    (define (make n m)
-      (let ((grid (make-vector n)))
-        (do ((i 0 (+ i 1)))
-            ((= i n) grid)
-          (let ((v (make-vector m #f alse)))
-            (vector-set! grid i v)))))
-    (define (rows grid) (vector-length grid))
-    (define (cols grid)
-      (vector-length (vector-ref grid 0)))
-    (define (ref grid n m)
-      (and (&amp;lt; -1 n (rows grid))
-           (&amp;lt; -1 m (cols grid))
-           (vector-ref (vector-ref grid n) m)))
-    (define (put! grid n m v)
-      (vector-set! (vector-ref grid n) m v))))
-&lt;/pre&gt;
 &lt;p&gt;
-This is easily reformatted into this sweet-expression, but
-notice the long sequence of indented definitions that, if long,
-loses a lot of horizontal space and can invite mistakes:
+An accidental blank line between two internal definitions will end the initial
+statement:
 &lt;/p&gt;
 &lt;pre&gt;
 define-library
@@ -3218,6 +3174,8 @@ define-library
         ! let (v(make-vector(m #f alse))) vector-set!(grid i v)
     define rows(grid) vector-length(grid)
     define cols(grid) vector-length(vector-ref(grid 0))
+
+; above blank line prematurely ends define-library
     define ref(grid n m)
       and
         {-1 &amp;lt; n &amp;lt; rows(grid)}
@@ -3225,9 +3183,57 @@ define-library
         vector-ref vector-ref(grid n) m
     define put!(grid n m v) vector-set!(vector-ref(grid n) m v)
 &lt;/pre&gt;
+&lt;p&gt;
+You can work around this for short sequences by removing the blank lines or
+replacing them with one of:
+&lt;/p&gt;
+&lt;ol&gt;
+&lt;li&gt;a &lt;code&gt;;&lt;/code&gt; comment (optionally indented)&lt;/li&gt;
+&lt;li&gt;a correctly-indented GROUP (&lt;code&gt;\\&lt;/code&gt;) symbol&lt;/li&gt;
+&lt;li&gt;a correctly-indented special comment (&lt;code&gt;#|...|#&lt;/code&gt; or &lt;code&gt;#;...&lt;/code&gt;)&lt;/li&gt;
+&lt;/ol&gt;
+&lt;p&gt;
+For longer sequences, use collecting lists (&amp;lt;* ... *&amp;gt;).  The &amp;lt;* and
+*&amp;gt; represent opening and closing parentheses, but restart indentation
+processing at the beginning, and collect any sweet-expressions inside.  In a
+collecting list, horizontal spaces after the initial &amp;lt;* are consumed, and
+then sweet-expressions are read.  These t-expressions must not be indented
+(though you can indent lines with only ;-comments).
+&lt;/p&gt;
 
 &lt;p&gt;
-But wholesale changes to sweet-expressions do not seem warranted
+Here an example of using collecting lists for the library structure above:
+&lt;/p&gt;
+&lt;pre&gt;
+define-library
+  example grid
+  export make rows cols ref each rename(put! set!)
+  import scheme(base)
+  &amp;lt;* begin
+
+define make(n m)
+  let (grid(make-vector(n)))
+    do (i(0 {i + 1}))
+    ! {i = n} grid
+    ! let (v(make-vector(m #f alse))) vector-set!(grid i v)
+
+define rows(grid) vector-length(grid)
+define cols(grid) vector-length(vector-ref(grid 0))
+
+define ref(grid n m)
+  and
+    {-1 &amp;lt; n &amp;lt; rows(grid)}
+    {-1 &amp;lt; m &amp;lt; cols(grid)}
+    vector-ref vector-ref(grid n) m
+
+define put!(grid n m v) vector-set!(vector-ref(grid n) m v)
+*&amp;gt;
+&lt;/pre&gt;
+&lt;p&gt;
+Why a new construct?  
+&lt;/p&gt;
+&lt;p&gt;
+Wholesale changes to sweet-expressions do not seem warranted
 for this special case, because
 there are reasons that sweet-expressions are defined the way they are.
 It is fundamental that a child line is indented from its parent, since
@@ -3240,9 +3246,57 @@ Ending a definition at a blank line is very convenient for interactive use,
 and interactive and file notation should be identical
 (since people often switch between them).
 &lt;/p&gt;
+&lt;p&gt;
+Note: Python works around this by having different semantics for files vs.
+interactive use.
+&lt;/p&gt;
+&lt;p&gt;
+The collecting list symbols are carefully chosen.
+The characters &amp;lt; and &amp;gt; are natural character pairs that are
+available in ASCII.
+What is more, they are not delimiters, so any underlying
+Scheme reader will not immediately stop on reading them
+(making it easier to reuse).
+The &amp;#8220;*&amp;#8221; is more arbitrary, but the collecting list markers
+need to be multiple
+characters to distinguish them from the less-than and greater-than procedures,
+and this seemed to be a fairly distinctive token that is rarely used
+in existing code.
+&lt;/p&gt;
+&lt;p&gt;
+For schemes with implicit begin, collecting lists can be used after a .:
+&lt;/p&gt;
+&lt;pre&gt;
+define-library . &amp;lt;*
+
+example grid
+export make rows cols ref each rename(put! set!)
+import scheme(base)
+
+define make(n m)
+  let (grid(make-vector(n)))
+    do (i(0 {i + 1}))
+    ! {i = n} grid
+    ! let (v(make-vector(m #f alse))) vector-set!(grid i v)
+
+define rows(grid) vector-length(grid)
+define cols(grid) vector-length(vector-ref(grid 0))
+
+define ref(grid n m)
+  and
+    {-1 &amp;lt; n &amp;lt; rows(grid)}
+    {-1 &amp;lt; m &amp;lt; cols(grid)}
+    vector-ref vector-ref(grid n) m
+
+define put!(grid n m v) vector-set!(vector-ref(grid n) m v)
+*&amp;gt;
+&lt;/pre&gt;
 
 &lt;p&gt;
-Now let&amp;#8217;s look at the second use case.
+Happily, collecting lists can also help a let-style statement with one or
+two variables with short initial values.
+&lt;/p&gt;
+&lt;p&gt;
 The sweet-expression notation cleanly handles cases where let-expression
 variables have complex values (e.g., using \\), but for simple cases
 (1-2 variables having short initial values)
@@ -3293,52 +3347,6 @@ let (x(5) y(7))
 &lt;/pre&gt;
 
 &lt;p&gt;
-A &lt;i&gt;collecting list&lt;/i&gt; is surrounded by the markers &amp;lt;* and *&amp;gt;.
-The &amp;lt;* and *&amp;gt; represent opening and closing
-parentheses, but restart indentation processing
-at the beginning instead of disabling indentation processing,
-and collect any sweet-expressions inside.
-The purpose of collecting lists is to make it easy to clearly
-express these and similar use cases.
-&lt;/p&gt;
-
-&lt;p&gt;
-In a collecting list, horizontal spaces after the initial &amp;lt;*
-are consumed, and then sweet-expressions are read.
-These t-expressions must not be indented (though you can indent
-lines with only ;-comments).
-&lt;/p&gt;
-
-&lt;p&gt;
-Here an example of using collecting lists for the library structure above:
-&lt;/p&gt;
-&lt;pre&gt;
-define-library
-  example grid
-  export make rows cols ref each rename(put! set!)
-  import scheme(base)
-  &amp;lt;* begin
-
-define make(n m)
-  let (grid(make-vector(n)))
-    do (i(0 {i + 1}))
-    ! {i = n} grid
-    ! let (v(make-vector(m #f alse))) vector-set!(grid i v)
-
-define rows(grid) vector-length(grid)
-define cols(grid) vector-length(vector-ref(grid 0))
-
-define ref(grid n m)
-  and
-    {-1 &amp;lt; n &amp;lt; rows(grid)}
-    {-1 &amp;lt; m &amp;lt; cols(grid)}
-    vector-ref vector-ref(grid n) m
-
-define put!(grid n m v) vector-set!(vector-ref(grid n) m v)
-*&amp;gt;
-&lt;/pre&gt;
-
-&lt;p&gt;
 Here are some examples of collecting lists for the let-variable cases:
 &lt;/p&gt;
 &lt;pre&gt;
@@ -3352,19 +3360,6 @@ let &amp;lt;* x 5 \\ y 7 *&amp;gt;
 &lt;/pre&gt;
 
 
-&lt;p&gt;
-The collecting list symbols are carefully chosen.
-The characters &amp;lt; and &amp;gt; are natural character pairs that are
-available in ASCII.
-What is more, they are not delimiters, so any underlying
-Scheme reader will not immediately stop on reading them
-(making it easier to reuse).
-The &amp;#8220;*&amp;#8221; is more arbitrary, but the collecting list markers
-need to be multiple
-characters to distinguish them from the less-than and greater-than procedures,
-and this seemed to be a fairly distinctive token that is rarely used
-in existing code.
-&lt;/p&gt;
 
 &lt;h3 id=&quot;reserved&quot;&gt;Reserved marker ($$$)&lt;/h3&gt;
 &lt;p&gt;
</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00033" href="msg00033.html">Re: how useful are collecting lists?</a></strong>
<ul><li><em>From:</em> Alan Manuel Gloria</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00008" href="msg00008.html">how useful are collecting lists?</a></strong>
<ul><li><em>From:</em> David Vanderson</li></ul></li>
<li><strong><a name="00010" href="msg00010.html">Re: how useful are collecting lists?</a></strong>
<ul><li><em>From:</em> David A. Wheeler</li></ul></li>
<li><strong><a name="00011" href="msg00011.html">Re: how useful are collecting lists?</a></strong>
<ul><li><em>From:</em> David Vanderson</li></ul></li>
<li><strong><a name="00012" href="msg00012.html">Re: how useful are collecting lists?</a></strong>
<ul><li><em>From:</em> David A. Wheeler</li></ul></li>
<li><strong><a name="00013" href="msg00013.html">Re: how useful are collecting lists?</a></strong>
<ul><li><em>From:</em> Alan Manuel Gloria</li></ul></li>
<li><strong><a name="00014" href="msg00014.html">Re: how useful are collecting lists?</a></strong>
<ul><li><em>From:</em> David A. Wheeler</li></ul></li>
<li><strong><a name="00019" href="msg00019.html">Re: how useful are collecting lists?</a></strong>
<ul><li><em>From:</em> David Vanderson</li></ul></li>
<li><strong><a name="00020" href="msg00020.html">Re: how useful are collecting lists?</a></strong>
<ul><li><em>From:</em> David A. Wheeler</li></ul></li>
<li><strong><a name="00021" href="msg00021.html">Re: how useful are collecting lists?</a></strong>
<ul><li><em>From:</em> David Vanderson</li></ul></li>
<li><strong><a name="00022" href="msg00022.html">Re: how useful are collecting lists?</a></strong>
<ul><li><em>From:</em> David A. Wheeler</li></ul></li>
<li><strong><a name="00024" href="msg00024.html">Re: how useful are collecting lists?</a></strong>
<ul><li><em>From:</em> David Vanderson</li></ul></li>
<li><strong><a name="00031" href="msg00031.html">Re: how useful are collecting lists?</a></strong>
<ul><li><em>From:</em> David A. Wheeler</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00031.html">Re: how useful are collecting lists?</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00033.html">Re: how useful are collecting lists?</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00031.html">Re: how useful are collecting lists?</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00033.html">Re: how useful are collecting lists?</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00032"><strong>Date</strong></a></li>
<li><a href="threads.html#00032"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
