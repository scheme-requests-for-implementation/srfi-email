<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: datum comments of sweet&#45;expressions -->
<!--X-From-R13: Oyna [nahry Uybevn <nyzxtybeNtznvy.pbz> -->
<!--X-Date: Fri, 12 Jul 2013 04:21:16 +0200 (MST) -->
<!--X-Message-Id: CAF+kUQXsC7WpB3vfW3FNPk=70WNhxay7jNvxpigyL3SjswDR9A@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 87sj1647r6.fsf@tines.lan -->
<!--X-Reference: E1Ux6G0&#45;0008SR&#45;IE@rmm6prod02.runbox.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: datum comments of sweet-expressions</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00195.html">Date Prev</a>][<a href="msg00197.html">Date Next</a>][<a href="msg00195.html">Thread Prev</a>][<a href="msg00197.html">Thread Next</a>][<a href="maillist.html#00196">Date Index</a>][<a href="threads.html#00196">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: datum comments of sweet-expressions</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: <a href="mailto:dwheeler@DOMAIN.HIDDEN">dwheeler@xxxxxxxxxxxx</a></li>
<li><em>Subject</em>: Re: datum comments of sweet-expressions</li>
<li><em>From</em>: Alan Manuel Gloria &lt;<a href="mailto:almkglor@DOMAIN.HIDDEN">almkglor@xxxxxxxxx</a>&gt;</li>
<li><em>Date</em>: Fri, 12 Jul 2013 10:14:53 +0800</li>
<li><em>Cc</em>: mhw &lt;<a href="mailto:mhw@DOMAIN.HIDDEN">mhw@xxxxxxxxxx</a>&gt;, srfi-110 &lt;<a href="mailto:srfi-110@DOMAIN.HIDDEN">srfi-110@xxxxxxxxxxxxxxxxx</a>&gt;, 	&quot;<a href="mailto:readable-discuss@DOMAIN.HIDDEN">readable-discuss@xxxxxxxxxxxxxxxxxxxxx</a>&quot; &lt;<a href="mailto:readable-discuss@DOMAIN.HIDDEN">readable-discuss@xxxxxxxxxxxxxxxxxxxxx</a>&gt;</li>
<li><em>Delivered-to</em>: <a href="mailto:srfi-110@DOMAIN.HIDDEN">srfi-110@xxxxxxxxxxxxxxxxx</a></li>
<li><em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=gmail.com; s=20120113;        h=mime-version:in-reply-to:references:date:message-id:subject:from:to         :cc:content-type:content-transfer-encoding;        bh=IBzd//JPkIPF/erc4Hs8wdnPe76rn1xk81WVzZ35wkc=;        b=UwzJg9iWKakBf08LulVe16amW8CVH4zmg11FrfSblallD0HJJgW+l424JHcWWYVGHO         FBqlazjWsQSCs5e4Y9SvaVsKdePiioI53Vpnm+Z7BnFdIyfvp0HfK3LurCrKttfNxtJC         5jvCSM/9QnmvF9VB+xo9JqxRZG9FnZKwj/Cr7IGnkH8t+YsvRVXjO+ksnnmb7vdJ6P9c         Ua0WJOx+kOzQYLIpkmszZg1Ik6NEcESuCVNKsB1ddnkoCvTgSxmg3S3793Oi65pMJJ2T         ajdTY9mZYv+4BSXAc/P8BTCo+sfhb2W8qGOKo57enlN8ct+HeWT0aU0xMKDocq0/kQfs         E9Ng==</li>
<li><em>In-reply-to</em>: &lt;<a href="mailto:E1Ux6G0-0008SR-IE@DOMAIN.HIDDEN">E1Ux6G0-0008SR-IE@xxxxxxxxxxxxxxxxxxxxx</a>&gt;</li>
<li><em>References</em>: &lt;<a href="mailto:87sj1647r6.fsf@DOMAIN.HIDDEN">87sj1647r6.fsf@xxxxxxxxx</a>&gt;	&lt;<a href="mailto:E1Ux6G0-0008SR-IE@DOMAIN.HIDDEN">E1Ux6G0-0008SR-IE@xxxxxxxxxxxxxxxxxxxxx</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>On 7/11/13, David A. Wheeler &lt;dwheeler@xxxxxxxxxxxx&gt; wrote:
&gt; On 29 May 2013 02:31:25 -0400, Mark H Weaver posted a long set of comments.
&gt; One recommendation was to supporting datum comments of sweet-expressions
&gt; (#; + whitespace).  The idea makes sense, and I did anticipate this.
&gt; However, the obvious ways imply some additional trickiness in grammar
&gt; and implementation.  Here's how I'm thinking about tackling this, but
&gt; if anyone has a better idea, *please* speak up!!
&gt;
&gt;
&gt; The current SRFI-110 says:
&gt; &quot;Scheme&#x2019;s datum comments (#;datum) comment out the next neoteric
&gt; expression, not the next sweet expression (and please don&#x2019;t follow the
&gt; semicolon with whitespace).&quot;
&gt;
&gt; Mark H Weaver recommends:
&gt; &quot;I often put &quot;#;&quot; on the preceeding line, which you're now asking me
&gt; not to do. What is the purpose of this request? Also, &quot;#;&quot; becomes
&gt; much less useful if it cannot comment out an entire sweet expression.
&gt; Perhaps &quot;#;&quot; should have a similar rule as the traditional
&gt; abbreviations: if it is followed by whitespace, then the following
&gt; /sweet expression/ is ignored, otherwise the following /neoteric
&gt; expression/ is ignored. What do you think?&quot;
&gt;
&gt; I have *definitely* thought about this.  Indeed, I wrote the text
&gt; &quot;don't follow the semicolon with whitespace&quot; so that supporting
&gt; datum comments of sweet-expressions could be added as a future addition.
&gt;
&gt; But if we add this as a *requirement*
&gt; to SRFI-110, then the grammar rules and sample implementation
&gt; have to be modified to handle it.  For example:
&gt; a b
&gt;   c
&gt;   #; e
&gt;      f
&gt;   g
&gt; =&gt; (a b c g)
&gt;
&gt;
&gt; THE CHALLENGE: Properly supporting this requires properly supporting
&gt; datum comments of a sweet-expression if it is the *last* item, e.g.:
&gt; fee fie
&gt;   foe
&gt;   fum
&gt;   #; blood
&gt;     Englishman
&gt; =&gt; (fee fie foe fum)
&gt;
&gt; Handling *last* items turns out to be trickier to do, and I think
&gt; that trickiness has nothing to do with whether or not the grammar is LL(1).
&gt; Currently there isn't a good way to handle lines that produce no value.
&gt; In particular, the &quot;it_expr&quot; rule *must* return a datum.
&gt; In the case of lines that begin with &quot;#!sweet&quot;, the grammar rules
&gt; recurse so they can have something to return.  This recursion
&gt; is why the GROUP_SPLIT rule is so complicated.  That approach
&gt; won't work here, because the datum comment might be the last group
&gt; at that indent level.
&gt;
&gt; So for the moment, let's say that we'll try to fix up the existing
&gt; LL(1) rules instead of rewriting the grammar rules in a completely
&gt; different notation.  Even if we do that, I want to do that as a separate
&gt; stage, and I think we should explore simplification further first.
&gt; So...  how could we do this?
&gt;
&gt; One approach would be to fiddle with all the grammar rules that
&gt; invoke it_expr.  However, I think that would be really ugly and involve
&gt; a lot of repetition in the rules.  The problem is that the calling
&gt; rules each have to handle identification of the situation AND
&gt; invoke a different action rule for that case.  Ugh.
&gt;
&gt; I think a better approach would be to modify the
&gt; key production &quot;it_expr&quot; so that it can return an &quot;EMPTY&quot; value,
&gt; distinct from a valid datum like (), that indicates
&gt; &quot;no value at all&quot;.  This would require some the action rules
&gt; to handle &quot;EMPTY&quot; values.  I think that could be handled by
&gt; a few tweaked procedures, e.g., some &quot;cons&quot; can be replaced with &quot;econs&quot;
&gt; (aka &quot;empty-handling cons&quot;):
&gt; (define (econs x y)
&gt;   (cond
&gt;     ((eq? y EMPTY) x)
&gt;     ((eq? x EMPTY) y)
&gt;     (#t (cons x y))))
&gt;
&gt; If we do this, one side-effect is that the GROUP_SPLIT rules could
&gt; probably become much simpler.  We'd no longer need to recurse deeply,
&gt; because there'd be a way to signal that we saw an empty result.
&gt;
&gt; Thoughts?  Comments?  Is there a better way I'm not seeing?

Haha more nasty tagging values hahahaha!  We never seem to get rid of them!

; unique tagging value
(define EMPTY (cons '() '()))

Basically, our previous (before SRFI-110) implementations made use of
lots of these objects.  There's even a dangling &quot;special tag to denote
comment return from hash-processing&quot; which no longer comments anything
at all, the special tag having been removed.

This is problematic for Scheme implementations that support some kind
of extension for dispatching on &quot;#&quot;.  Although I guess that's the
problem of the implementation.  Such # extensions are cute but make
life hard for us indentation-formatting guys.

That said our old implementations of sweet-expressions used such
unique nasty tagging values, so I don't see why we can't use them
again if it greatly simplifies our code.


Sincerely,
AmkG

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00197" href="msg00197.html">Re: datum comments of sweet-expressions</a></strong>
<ul><li><em>From:</em> David A. Wheeler</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00179" href="msg00179.html">More comments, and the ANTLR code is too complex</a></strong>
<ul><li><em>From:</em> Mark H Weaver</li></ul></li>
<li><strong><a name="00195" href="msg00195.html">datum comments of sweet-expressions</a></strong>
<ul><li><em>From:</em> David A. Wheeler</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00195.html">datum comments of sweet-expressions</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00197.html">Re: datum comments of sweet-expressions</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00195.html">datum comments of sweet-expressions</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00197.html">Re: datum comments of sweet-expressions</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00196"><strong>Date</strong></a></li>
<li><a href="threads.html#00196"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
