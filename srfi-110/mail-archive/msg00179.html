<!-- MHonArc v2.6.16 -->
<!--X-Subject: More comments, and the ANTLR code is too complex -->
<!--X-From-R13: [nex V Irnire <zujNargevf.bet> -->
<!--X-Date: Wed, 29 May 2013 09:04:34 +0200 (MST) -->
<!--X-Message-Id: 87sj1647r6.fsf@tines.lan -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>More comments, and the ANTLR code is too complex</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00178.html">Date Prev</a>][<a href="msg00180.html">Date Next</a>][<a href="msg00159.html">Thread Prev</a>][<a href="msg00180.html">Thread Next</a>][<a href="maillist.html#00179">Date Index</a>][<a href="threads.html#00179">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>More comments, and the ANTLR code is too complex</h1>
<p style="max-width: 30em;">This page is part of the web mail archives of <a href="http://srfi.schemers.org/srfi-110">SRFI 110</a> from before July 7th, 2015.  The new archives for SRFI 110 are <a href="http://srfi-email.schemers.org/srfi-110/">here</a>.  The new archives contain all messages, not just those from before July 7th, 2015.</p>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: <a href="mailto:srfi-110@DOMAIN.HIDDEN">srfi-110@xxxxxxxxxxxxxxxxx</a></li>
<li><em>Subject</em>: More comments, and the ANTLR code is too complex</li>
<li><em>From</em>: Mark H Weaver &lt;<a href="mailto:mhw@DOMAIN.HIDDEN">mhw@xxxxxxxxxx</a>&gt;</li>
<li><em>Date</em>: Wed, 29 May 2013 02:31:25 -0400</li>
<li><em>Delivered-to</em>: <a href="mailto:srfi-110@DOMAIN.HIDDEN">srfi-110@xxxxxxxxxxxxxxxxx</a></li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>I've made another attempt to understand SRFI-110 clearly enough to
implement it, and once again I've failed to do so before losing
patience.

This is the first time I've attempted to read and understand the ANTLR
grammar, and I'm sorry to say that I'm very unhappy with it.  If it
cannot be made simpler and more easily comprehensible than it is now,
then I'm unlikely to implement SRFI-110 in Guile.  I suspect other
implementors would feel similarly.

In the interest of encouraging implementors, I'd recommend making a
serious effort to rewrite the grammar to be as conceptually simple and
clear as possible.

Here are some specific comments about the ANTLR code:

* &quot;BLOCK_COMMENT : '#|' // This is #| ... #|&quot;
   That should be &quot;#| ... |#&quot;

* EOL_SEQUENCE is never used.  EOL is used instead, even though it is
  not defined.

* APOSW, QUASIQUOTEW, UNQUOTEW, and UNQUOTE_SPLICEW are not defined.

* Inconsistent syntax is used within {} in the ANTLR.  In most places
  standard Scheme syntax is used, but in 'collecting_tail', the syntax
  is more like C.

* Why are the action rules in 'n_expr' simply expressions that refer to
  values such as '$n1', but the action rules of 'collecting_tail' are
  instead assignment statements that refer to values such as '$more.v'?

* Why is there special handling of (FF | VT)+ EOL ?

* What does 'isperiodp' do exactly?  What if the datum really is &quot;.&quot; or
  the symbol whose name is a single period? (written #{.}# in Guile).

* The non-terminals 'body' and 'it_expr' use the symbol 'same' even
  though the text implies that no extra symbol is generated by the
  preprocessing step in that case.  Where does 'same' come from?

And here are some comments about the tutorial:

* &quot;Scheme&#xE2;s datum comments (#;datum) comment out the next neoteric
  expression, not the next sweet expression (and please don&#xE2;t follow the
  semicolon with whitespace).&quot;

   I often put &quot;#;&quot; on the preceeding line, which you're now asking me
   not to do.  What is the purpose of this request?  Also, &quot;#;&quot; becomes
   much less useful if it cannot comment out an entire sweet expression.
   Perhaps &quot;#;&quot; should have a similar rule as the traditional
   abbreviations: if it is followed by whitespace, then the following
   /sweet expression/ is ignored, otherwise the following /neoteric
   expression/ is ignored.  What do you think?

* I'd like to see a few more examples for improper lists, such as:

     f
       a .
       b

  and:

     f
       a b
       . c

* In the tutorial, I found the examples of $ (SUBLIST) a bit confusing:

    a b $ c d          ==&gt;   (a b (c d))

    a b $ c d e f $ g  ==&gt;   (a b (c d e f g))
                             ; Not (a b (c d e f (g)))

   This leaves me uncertain of whether the second case is somehow
   caused by two $'s on one line, or because there's only one item
   after the $.  I'd like to see an example like &quot;a b $ c&quot; or
   &quot;a b $ c d e $ f g&quot; to clarify.

* &quot;A sweet-expression reader MUST support three modes: indentation
  processing, enclosed, and initial indent.&quot;
  [...]
  &quot;A marker MUST only have its special meaning when indentation
  processing is enabled,&quot;

   This sounds as if &quot;*&gt;&quot; MUST not be recognized, because the reader
   will be in &quot;enclosed&quot; mode at that point, no?

* &quot;2. If top is the empty string and the indentation length is nonzero,
   symbol INITIAL_INDENT is generated and the reader changes to initial
   indent mode. When an end-of-line sequence is reached the mode changes
   back to indentation processing.&quot;

   If the reader was in &quot;enclosed&quot; mode, then presumably the mode
   should not change back to indentation processing, right?

* &quot;1. If an end-of-line sequence immediately follows the indentation and
      the indentation length is nonzero:
       a. If the indentation contains &#xE2;!&#xE2;, it is ignored; an
          implementation MUST consume the end-of-line sequence and start
          applying these rules again, from the beginning, with the next
          line.
       b. If the indentation does not contain &#xE2;!&#xE2;, it is considered a
          line with no characters (thus indentation has zero length) and
          the rest of these rules are applied.&quot;

   I vaguely recall that the distinction here was going to be removed
   as a simplification of the rules.  What that idea scrapped?

* &quot;A marker MUST only have its special meaning when indentation
  processing is enabled, it is preceded by indentation or hspace, it is
  followed by an hspace or end-of-line, and when it starts with the
  character shown (e.g., neither |$| nor '$ contains a marker).&quot;

   The last clause here, &quot;when it starts with the character shown&quot;, is
   poorly worded IMO, and redundant with the requirement that &quot;it is
   preceded by indentation or hspace&quot;.

     Regards,
       Mark

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00180" href="msg00180.html">Re: More comments, and the ANTLR code is too complex</a></strong>
<ul><li><em>From:</em> David A. Wheeler</li></ul></li>
<li><strong><a name="00181" href="msg00181.html">Re: More comments, and the ANTLR code is too complex</a></strong>
<ul><li><em>From:</em> David A. Wheeler</li></ul></li>
<li><strong><a name="00182" href="msg00182.html">Re: More comments, and the ANTLR code is too complex</a></strong>
<ul><li><em>From:</em> David A. Wheeler</li></ul></li>
<li><strong><a name="00183" href="msg00183.html">Re: More comments, and the ANTLR code is too complex</a></strong>
<ul><li><em>From:</em> David A. Wheeler</li></ul></li>
<li><strong><a name="00194" href="msg00194.html">Re: More comments, and the ANTLR code is too complex</a></strong>
<ul><li><em>From:</em> David A. Wheeler</li></ul></li>
<li><strong><a name="00195" href="msg00195.html">datum comments of sweet-expressions</a></strong>
<ul><li><em>From:</em> David A. Wheeler</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00178.html">Re: sweet-expressions are not homoiconic</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00180.html">Re: More comments, and the ANTLR code is too complex</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00159.html">Updated SRFI-110 posted!</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00180.html">Re: More comments, and the ANTLR code is too complex</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00179"><strong>Date</strong></a></li>
<li><a href="threads.html#00179"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
