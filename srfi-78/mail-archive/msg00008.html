<!-- MHonArc v2.6.15 -->
<!--X-Subject: Re: duplication of SRFIs -->
<!--X-From-R13: Bre Pbguare <creNobguare.pbz> -->
<!--X-Date: Thu, 24 Nov 2005 22:41:21 +0100 (CET) -->
<!--X-Message-Id: 4386337A.7040805@bothner.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: OF77212EC1.066D0132&#45;ONC12570C0.003BD9DE&#45;C12570C0.004D1863@philips.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: duplication of SRFIs</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00007.html">Date Prev</a>][<a href="msg00009.html">Date Next</a>][<a href="msg00006.html">Thread Prev</a>][<a href="msg00009.html">Thread Next</a>][<a href="maillist.html#00008">Date Index</a>][<a href="threads.html#00008">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: duplication of SRFIs</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: Sebastian Egner &lt;<a href="mailto:sebastian.egner@DOMAIN.HIDDEN">sebastian.egner@xxxxxxxxxxx</a>&gt;</li>
<li><em>Subject</em>: Re: duplication of SRFIs</li>
<li><em>From</em>: Per Bothner &lt;<a href="mailto:per@DOMAIN.HIDDEN">per@xxxxxxxxxxx</a>&gt;</li>
<li><em>Date</em>: Thu, 24 Nov 2005 13:41:14 -0800</li>
<li><em>Cc</em>: <a href="mailto:srfi-78@DOMAIN.HIDDEN">srfi-78@xxxxxxxxxxxxxxxxx</a></li>
<li><em>Delivered-to</em>: <a href="mailto:srfi-78@DOMAIN.HIDDEN">srfi-78@xxxxxxxxxxxxxxxxx</a></li>
<li><em>In-reply-to</em>: &lt;<a href="mailto:OF77212EC1.066D0132-ONC12570C0.003BD9DE-C12570C0.004D1863@DOMAIN.HIDDEN">OF77212EC1.066D0132-ONC12570C0.003BD9DE-C12570C0.004D1863@xxxxxxxxxxx</a>&gt;</li>
<li><em>References</em>: &lt;<a href="mailto:OF77212EC1.066D0132-ONC12570C0.003BD9DE-C12570C0.004D1863@DOMAIN.HIDDEN">OF77212EC1.066D0132-ONC12570C0.003BD9DE-C12570C0.004D1863@xxxxxxxxxxx</a>&gt;</li>
<li><em>User-agent</em>: Mozilla Thunderbird 1.0.6-1.1.fc4 (X11/20050720)</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">
Sebastian Egner wrote:
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">

Per Bothner wrote:
</pre></blockquote><pre style="margin: 0em;">
 &gt;  &gt; One of the reasons for SRFI-64 is that I think the Scheme world
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
 &gt; needs a standard for test-suites: Specifically,there should be can
 &gt; expectation that SRFIs should come with a portable suitesuite.

SRFIs come with whatever the authors choose to include, within the limits
of the SRFI process, and nothing more. Having any other expectation is
self-deception or wishful thinking.
</pre></blockquote><pre style="margin: 0em;">

Ok - SRFIs authors should be &quot;encouraged&quot; to include a test-suite.
Having a standard test-suite format makes that both easier and
more useful.

</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
If the authors of a SRFI choose to include some testing code for their
reference implementation that is great, but should by no means be
'expected' by you or anybody else.
</pre></blockquote><pre style="margin: 0em;">

Any non-toy application or library needs systematic testing.  The
best way to do that is with an automaticly-executable testsuite.
The SRFI process is quite loose and informal, but we should at
least *encourage* test suites.

&gt;It should be even less expected
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
that the authors of a SRFI choose SRFI 64 (or SRFI 78 or any other SRFI)
as their framework for testing, just because you put it forward as the
&quot;standard for test-suites.&quot;
</pre></blockquote><pre style="margin: 0em;">

Well, a &quot;standard for test-suites&quot; would be a good thing for Scheme.
Ideally there would be consensus on a standard.  It needs to be simple
to write test suites, it should satisfy the most common API
(non-interactive non-graphical) testing needs, and at least the basic
functionality must be trivially portable to on most/all Scheme
implementations.  Otherwise I'm not too wedded to anything specific,
but I think the SRFI-64 satisfies those needs, and I've tried to
listen to other Scheme implementors.

SRFI-64 does provide more &quot;hooks&quot;/features than minimally needed.
If that is a concern, I'm open to splitting it up into a core API
for writing basic testsuites, and an extended API for pluggable
test-runners, control over which tests get run etc.  There is an
issue though about conditionalizing tests and noting that tests
are expected to fail - are those basic or extended features?

</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
When SRFI 64 came out, I took it as a first step towards an 'industrial
strength' testing environment for Scheme. This is not the intention with
SRFI 78, never was, and never will be. I did not even occur to me that
you intend to put SRFI 64 forward as 'the one and only' testing mechanism.
</pre></blockquote><pre style="margin: 0em;">

Not the &quot;the one and only&quot; testing mechanism, obviously.  But it would
be good to have a standard way to write *test suites*.  Not the &quot;one
and only&quot; of course, but the default which one could expect to
be available.

Note I'm less concerned about standardizing &quot;mechanism&quot; than I am about
stdandardizing a way to write test suites.

</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
Many people are consistently lazy. Tests get written when
it is either not a burden, or when it is undeniably necessary.
</pre></blockquote><pre style="margin: 0em;">

Well, yes.  But quality software development does seem to require
test suites - at the very least regression tests.  I.e. I'm not
expecting exhaustive tests that check for all features of an any.
But when you implement a feature, you should write a minimal test
suite, even it contains just a simple &quot;hello world&quot;-type test.
It is then easier to add to to the testsuite as you develop or
maintain it.

Having a standard API makes this easier.

</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
My main problem with SRFI 64 is that I do not want to learn about all the
nice little things you define like XPASS etc.
</pre></blockquote><pre style="margin: 0em;">

Well, perhaps we could leave that out of the core testing API, and
keep it in the extended API.  Or we need a simple tutorial.

&gt; The only thing that I need from a testing
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
framework is:
CHECK and CHECK-EC as specified in SRFI 78
</pre></blockquote><pre style="margin: 0em;">

(check &lt;expr&gt;  =&gt;          &lt;expected&gt;)
seems to be the same as:
(test-equal &lt;expr&gt; &lt;expected&gt;)

(check &lt;expr&gt; &lt;equal?&gt;
is the same as using test-eq or test-eqv when &lt;equal?&gt; is eq? or
eqv?, respectively, or more generally:
(test-assert (&lt;equal?&gt; &lt;expr&gt; &lt;expected&gt;))

I'm not opposed to the =&gt; syntax; my main concern is getting consensus,
and I think some people will prefer a more traditional function syntax.

I also don't feel strongly about &quot;test-&quot; vs &quot;check-&quot; as long as there
is agreement on a single prefix for the testing API.

The problem with check-ec is that it pre-supposes another SRFI which
is not that widely implemented.  That isn't in itself a problem, if
there is a portable implementation.  I'm more concerned about design:
you're complaining about having to understand XPASS.  I'm more concerned
about people having to learn and understand SRFI-42-style comprehensions
in order to read, write, and update test suites.  This seems a bit
premature, until SRFI-42-style comprehensions become more established.
(I also note that Olin Shivers is working on a more general loop macro
- see ICFP '05.)

I'm not sure:
(check-ec &lt;qualifier&gt;^* &lt;expr&gt;  =&gt;          &lt;expected&gt; (&lt;argument&gt;^*))
is enough of an improvement over:
(do-ec &lt;qualifier&gt;^
  (test-equal (format &quot;~s&quot; &lt;argument&gt;) &lt;expr&gt; &lt;expected&gt;))
The main advantage (besides being slightly shorter) is that the
check-ec stops after the first failed check.  That's useful but a
global &quot;exit after first failure&quot; option may be even more useful.

&gt; and a way to print the report
</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
'here and now' without any setup or any concepts like a test runners etc.
</pre></blockquote><pre style="margin: 0em;">

SRFI-64 does that.  Just a test-begin and test-end - look at the intial
example.  That's a complete executable test suite.

</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><tt>Controlling the verbosity of output, switching off the tests, and 
</tt><tt>dealing with
</tt><tt>test runners explicitly, groups of tests etc. is all more advanced stuff 
</tt><tt>that I
</tt><pre style="margin: 0em;">
want to be able to bring in when it becomes unavoidable.
</pre></blockquote><pre style="margin: 0em;">

Well, you do have some non-basic controls for that: check-set-mode!,
check-passed?, etc.  Where you draw the line between simple and
advanced is not obvious.  Those functions seems to be more for
controlling test execution (i.e. the test runner) rather than writing
test suites.

</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><pre style="margin: 0em;">
One other thing I
</pre><tt>noticed is that it is useful to print test results immediately when they 
</tt><tt>become
</tt><tt>available one by one, this gives you a way of tracking things up to a 
</tt><tt>crash.
</tt></blockquote><pre style="margin: 0em;">

The default &quot;simple runner&quot; in SRFI-64 does that.

</pre><blockquote style="border-left: #5555EE solid 0.2em; margin: 0em; padding-left: 0.85em"><tt>Do you see any way of incorporating this stuff into SRFI 64? If so, how 
</tt><tt>would
</tt><pre style="margin: 0em;">
you go about it? If not, what would be the problem?
</pre></blockquote><pre style="margin: 0em;">

The main issues I see are:
(1) names and syntax: i.e. test vs check and the =&gt; syntax.
Here I feel: whichever we can get most Scheme and library
implementors to go along with.

(2) Whether to split SRFI-64 into a core and an extended API.
An advantage of a split that people who just want to just
write/maintain test suites can read a smaller document rather
than be intimidated by a more complex document.  But that should
perhaps be dealt with a separate &quot;how to write simple test cases&quot;
tutorial document.

(3) begin/end-wrappers.  Your check-report is handled by my test-end,
except that test-end supports nesting.  (That is probably not a core
feature.)  Having a test-begin is useful and not burdensome; it is
similar to check-reset!, but always required at the beginning.

(4) check-ec (or test-ec).  I'm not sure that belongs in SRFI-64 (or
a &quot;core&quot; framework in general).  However, it makes perfect sense to
have that as a separate SRFI, as long as it is stylistically compatible
(i.e. consistency about syntax), and can be implemented using SRFI-42
plus the core API.

(5) check-set-mode! is basically a function for tweaking the
test-runner.  It should easy enough to add the desired functionality.
My implementation by default writes a detailed log to a file, and a
quick summary with failing tests to the standard output port.  It might
be reasonable to only write the first failure to stadard output.
--
	--Per Bothner
per@xxxxxxxxxxx   <a  rel="nofollow" href="http://per.bothner.com/">http://per.bothner.com/</a>

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00009" href="msg00009.html">Re: duplication of SRFIs</a></strong>
<ul><li><em>From:</em> Thien-Thi Nguyen</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00006" href="msg00006.html">Re: duplication of SRFIs</a></strong>
<ul><li><em>From:</em> Sebastian Egner</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00007.html">Re: duplication of SRFIs</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00009.html">Re: duplication of SRFIs</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00006.html">Re: duplication of SRFIs</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00009.html">Re: duplication of SRFIs</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00008"><strong>Date</strong></a></li>
<li><a href="threads.html#00008"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
