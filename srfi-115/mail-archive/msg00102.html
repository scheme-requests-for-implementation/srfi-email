<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: regexp and valid&#45;sre? -->
<!--X-From-R13: Oyrk Euvaa <nyrkfuvaaNtznvy.pbz> -->
<!--X-Date: Tue, 26 Nov 2013 23:21:29 +0100 (MET) -->
<!--X-Message-Id: CAMMPzYNybyJuBgWffZ+&#45;tAbxZD&#45;tmCLn1zeqm_GQKZuqw9+QXA@mail.gmail.com -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: 529416A8.2030506@gmail.com -->
<!--X-Reference: CAMMPzYO_nUTm2GwOV9hKMgkZCaQf8CR7_C7gnWtAGMpcLt=nRQ@mail.gmail.com -->
<!--X-Reference: 20131126141712.GC18148@frohike.xs4all.nl -->
<!--X-Reference: 5294E1AA.3090305@gmail.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: regexp and valid-sre?</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00101.html">Date Prev</a>][<a href="msg00103.html">Date Next</a>][<a href="msg00129.html">Thread Prev</a>][<a href="msg00104.html">Thread Next</a>][<a href="maillist.html#00102">Date Index</a>][<a href="threads.html#00102">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: regexp and valid-sre?</h1>
<p style="max-width: 30em;">This page is part of the web mail archives of <a href="http://srfi.schemers.org/srfi-115">SRFI 115</a> from before July 7th, 2015.  The new archives for SRFI 115 are <a href="http://srfi-email.schemers.org/srfi-115/">here</a>.  The new archives contain all messages, not just those from before July 7th, 2015.</p>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: Michael Montague &lt;<a href="mailto:mikemon@DOMAIN.HIDDEN">mikemon@xxxxxxxxx</a>&gt;</li>
<li><em>Subject</em>: Re: regexp and valid-sre?</li>
<li><em>From</em>: Alex Shinn &lt;<a href="mailto:alexshinn@DOMAIN.HIDDEN">alexshinn@xxxxxxxxx</a>&gt;</li>
<li><em>Date</em>: Wed, 27 Nov 2013 07:21:28 +0900</li>
<li><em>Cc</em>: SRFI-115 discussion list &lt;<a href="mailto:srfi-115@DOMAIN.HIDDEN">srfi-115@xxxxxxxxxxxxxxxxx</a>&gt;</li>
<li><em>Delivered-to</em>: <a href="mailto:srfi-115@DOMAIN.HIDDEN">srfi-115@xxxxxxxxxxxxxxxxx</a></li>
<li><em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=gmail.com; s=20120113;        h=mime-version:in-reply-to:references:date:message-id:subject:from:to         :cc:content-type;        bh=2TODotIM72mkEVLVUNyxPwQYjWUpFz28YkGYnInR36o=;        b=T25fN/B5XMBEyY529wUWbCS40rDmiewP3MwtaKa8pqf1SgTFIbzueA7ZkRZCrTSpKL         NFZp/2bBtM/Ac4/p9HfuF5cPfSLvKi0EcT3gvs8m0jzxhMBATkOOIWUhOL/Iznd7ao+x         fIkk/1pXwk22Msjk2J5Z4/arRs3YSfF1Tn37fHz41IPZGa0OU9n6VUpAUJ2eV3JMJXNx         t6PZZP+Fu64erLXLxrY/T7G1rEzabY/faNS33b3cVmSlMpFTRmI3anfiGf2FRcsq78qS         ontqJh87zuR47D7ktllA2TQwYyiT2Kfo9CrzzZ8qTeFf+/y+ee2OX2XQF4xMatkfr49P         gzpg==</li>
<li><em>In-reply-to</em>: &lt;<a href="msg00081.html">5294E1AA.3090305@gmail.com</a>&gt;</li>
<li><em>References</em>: &lt;<a href="msg00072.html">529416A8.2030506@gmail.com</a>&gt;	&lt;CAMMPzYO_nUTm2GwOV9hKMgkZCaQf8CR7_C7gnWtAGMpcLt=nRQ@mail.gmail.com&gt;	&lt;<a href="msg00076.html">20131126141712.GC18148@frohike.xs4all.nl</a>&gt;	&lt;<a href="msg00081.html">5294E1AA.3090305@gmail.com</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<div dir="ltr"><div class="gmail_extra"><div class="gmail_quote">On Wed, Nov 27, 2013 at 3:00 AM, Michael Montague <span dir="ltr">&lt;<a rel="nofollow" href="mailto:mikemon@xxxxxxxxx" target="_blank">mikemon@xxxxxxxxx</a>&gt;</span> wrote:<br>
<blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex"><div class=""><div class="h5">On 11/26/2013 6:17 AM, Peter Bex wrote:<br>

<blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex">
On Tue, Nov 26, 2013 at 09:44:27PM +0900, Alex Shinn wrote:<br>
<blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex">
On Tue, Nov 26, 2013 at 12:34 PM, Michael Montague &lt;<a rel="nofollow" href="mailto:mikemon@xxxxxxxxx" target="_blank">mikemon@xxxxxxxxx</a>&gt;wrote:<br>
<br>
<blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex">
Why can the procedure &#39;regexp&#39; be called with an already compiled &lt;re&gt;<br>
which is just returned?<br>
</blockquote></blockquote>
Convenience, I&#39;d say. &#xA0;That way you can create modules which have an<br>
interface that accepts either SREs or regexp objects (like irregex does),<br>
having it automatically compile SREs.<br>
<br>
<blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex"><blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex">

Why is the procedure &#39;valid-sre?&#39; necessary? You could just call &#39;regexp&#39;<br>
and use &#39;guard&#39; to check for any errors.<br>
<br>
</blockquote>
Indeed, in fact `valid-sre?&#39; could be defined as:<br>
<br>
&#xA0; &#xA0;(define (valid-sre? x)<br>
&#xA0; &#xA0; &#xA0;(guard (else (exn #f)) (regexp x)))<br>
<br>
Whether you want to test in advance or catch errors<br>
after the fact is a matter of personal style.<br>
</blockquote>
And in some implementations compiling might be a lot more expensive than<br>
simply checking, and if you&#39;re just providing on-the-fly feedback to a<br>
user while building a regex dynamically (for example), it might be better<br>
or more efficient to use valid-sre? instead of compiling.<br>
<br>
I&#39;m sure that in Irregex at least the DFA compilation is much more<br>
expensive for complex regexes than a simple &quot;is it valid&quot;-type check<br>
would be.<br>
</blockquote></div></div>
I don&#39;t think that these are strong arguments for having &#39;valid-sre?&#39;. An implementation for which compiling is expensive, could easily internally do the &quot;is it valid&quot;-type check before compiling. Having it in the interface adds no functionality that is not already easily available.<br>
</blockquote><div><br></div><div>DFA compilation can actually require exponential time</div><div>(and space) in the worst-case, so performance is a concern</div><div>here.</div><div><br></div><div>As a use-case consider something like (apologies if this</div>
<div>is somewhat contrived):</div><div><br></div><div>&#xA0; (define (search db re)</div><div>&#xA0; &#xA0; (if (not (valid-sre? re))</div><div>&#xA0; &#xA0; &#xA0; &#xA0; (log-bad-sre re)</div><div>&#xA0; &#xA0; &#xA0; &#xA0; (filter (lambda (s) (regexp-matches? re s)) (lookup db field))))</div>
<div><br></div><div>where 1) we&#39;re part of a running server and don&#39;t want to throw</div><div>uncaught exceptions, and 2) we don&#39;t want to make the lookup call</div><div>at all if the re is not valid. &#xA0;The alternative satisfying these conditions</div>
<div>is to inline the above definition of `valid-sre?&#39;:</div><div><br></div><div><div>&#xA0; (define (search db re)</div><div>&#xA0; &#xA0; (if (guard (else (exn #f)) (regexp re) #t)</div><div>&#xA0; &#xA0; &#xA0; &#xA0; (log-bad-sre re)</div><div>&#xA0; &#xA0; &#xA0; &#xA0; (filter (lambda (s) (regexp-matches? re s)) (lookup db field))))</div>
</div><div><br></div><div>This is longer and harder to read. &#xA0;I prefer having the `valid-sre?&#39;</div><div>utility here.</div><div><br></div><blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex">

I propose dropping &#39;valid-sre?&#39;.<br>
</blockquote></div><br></div><div class="gmail_extra">I and all the others in the discussion seem to disagree with you.</div><div class="gmail_extra"><br></div><div class="gmail_extra">--&#xA0;</div><div class="gmail_extra">Alex</div>
<div class="gmail_extra"><br></div></div>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00104" href="msg00104.html">Re: regexp and valid-sre?</a></strong>
<ul><li><em>From:</em> Michael Montague</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00072" href="msg00072.html">regexp and valid-sre?</a></strong>
<ul><li><em>From:</em> Michael Montague</li></ul></li>
<li><strong><a name="00074" href="msg00074.html">Re: regexp and valid-sre?</a></strong>
<ul><li><em>From:</em> Alex Shinn</li></ul></li>
<li><strong><a name="00076" href="msg00076.html">Re: regexp and valid-sre?</a></strong>
<ul><li><em>From:</em> Peter Bex</li></ul></li>
<li><strong><a name="00081" href="msg00081.html">Re: regexp and valid-sre?</a></strong>
<ul><li><em>From:</em> Michael Montague</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00101.html">Re: english names for symbolic SREs</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00103.html">Re: integrating PCREs</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00129.html">Re: regexp and valid-sre?</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00104.html">Re: regexp and valid-sre?</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00102"><strong>Date</strong></a></li>
<li><a href="threads.html#00102"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
