<!-- MHonArc v2.6.18 -->
<!--X-Subject: Re: benefits of SRE syntax -->
<!--X-From-R13: Oyrk Euvaa <nyrkfuvaaNtznvy.pbz> -->
<!--X-Date: Sun, 20 Oct 2013 16:21:49 +0200 (MST) -->
<!--X-Message-Id: CAMMPzYOY8QU=inm=PO7FpDy4LViPZhL91KMvpUbPuG0e91EpTA@mail.gmail.com -->
<!--X-Content-Type: multipart/alternative -->
<!--X-Reference: 525EDE98.90901@gmail.com -->
<!--X-Reference: 525EE587.5000209@bothner.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Re: benefits of SRE syntax</title>
</head>
<body>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00042.html">Date Prev</a>][<a href="msg00044.html">Date Next</a>][<a href="msg00023.html">Thread Prev</a>][<a href="msg00046.html">Thread Next</a>][<a href="maillist.html#00043">Date Index</a>][<a href="threads.html#00043">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: benefits of SRE syntax</h1>
<p style="max-width: 30em;">This page is part of the web mail archives of <a href="http://srfi.schemers.org/srfi-115">SRFI 115</a> from before July 7th, 2015.  The <a href="http://srfi-email.schemers.org/srfi-115">new archives</a> for SRFI 115 contain all messages, not just those from before July 7th, 2015.</p>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><em>To</em>: Per Bothner &lt;<a href="mailto:per@DOMAIN.HIDDEN">per@xxxxxxxxxxx</a>&gt;</li>
<li><em>Subject</em>: Re: benefits of SRE syntax</li>
<li><em>From</em>: Alex Shinn &lt;<a href="mailto:alexshinn@DOMAIN.HIDDEN">alexshinn@xxxxxxxxx</a>&gt;</li>
<li><em>Date</em>: Sun, 20 Oct 2013 23:21:47 +0900</li>
<li><em>Cc</em>: Michael Montague &lt;<a href="mailto:mikemon@DOMAIN.HIDDEN">mikemon@xxxxxxxxx</a>&gt;, 	SRFI-115 discussion list &lt;<a href="mailto:srfi-115@DOMAIN.HIDDEN">srfi-115@xxxxxxxxxxxxxxxxx</a>&gt;</li>
<li><em>Delivered-to</em>: <a href="mailto:srfi-115@DOMAIN.HIDDEN">srfi-115@xxxxxxxxxxxxxxxxx</a></li>
<li><em>Dkim-signature</em>: v=1; a=rsa-sha256; c=relaxed/relaxed;        d=gmail.com; s=20120113;        h=mime-version:in-reply-to:references:date:message-id:subject:from:to         :cc:content-type;        bh=sV8jbBe7m05dgCONw/3khMKH5Y2TeH4GdUdXnCgIIAs=;        b=P2jo5gxwP9c64GgfRTDXceE+rfjf0dKOjTFrNXL2jqBXPywnkbybGImPKi7fkm/Qdc         OEQb6TgCksTfMTRLxZPqtHeyZ/galdp4v0uFJgGLWe5QR9NSjNyVbCpm1zrHAgVsxbE7         Cd35H+blyDUx1aD9fNtm9ZGnbPZiwoQCynFJRXAcMGKLshHpSy+2efjX9U47rTDBcQD0         yp3a2b4+9aeRP2v+zgRxXvMaMk9w1zqjPwULXEdjaNWDuWpl2BTJwdHzYoD4EevXphuH         YhWlZdFu4Up/D9HyFyjTv/ImGCYmyOwcbpyEqSNtFRezmXwJW9V1qlHeLkxq81yesCBo         FLLw==</li>
<li><em>In-reply-to</em>: &lt;<a href="msg00023.html">525EE587.5000209@bothner.com</a>&gt;</li>
<li><em>References</em>: &lt;<a href="msg00021.html">525EDE98.90901@gmail.com</a>&gt;	&lt;<a href="msg00023.html">525EE587.5000209@bothner.com</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<div dir="ltr">On Thu, Oct 17, 2013 at 4:14 AM, Per Bothner <span dir="ltr">&lt;<a rel="nofollow" href="mailto:per@xxxxxxxxxxx" target="_blank">per@xxxxxxxxxxx</a>&gt;</span> wrote:<br><div class="gmail_extra"><div class="gmail_quote"><blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex">
<div class="im">On 10/16/2013 11:44 AM, Michael Montague wrote:<br>
<blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex">
Maybe I am being a heretic, but what are the benefits of the SRE syntax?<br>
</blockquote>
<br></div>
I think structured regular expressions make sense when integrated<br>
with a general pattern-matching framework (by which I mean something<br>
like <a rel="nofollow" href="http://docs.racket-lang.org/reference/match.html" target="_blank">http://docs.racket-lang.org/<u></u>reference/match.html</a>). Also,<br>
sub-matches should produce variable bindings.<br>
<br>
Without that, I also see little value is yet another ad hoc<br>
string-only pattern-matching syntax, which is likely to<br>
be have different syntax from any general pattern-matching framework.<br></blockquote><div><br></div><div><div>I think it would be strange to provide regexp</div><div>matching as part of a general matching framework</div>
<div>without providing access to the underlying regexp</div><div>library.</div></div><div><br></div><div>It can also be handy to build macro utilities on top</div><div>of SREs. &#xA0;There are a number of regexp-case utilities</div>
<div>out there, but the following allows referring to named</div><div>submatches directly (preserving hygiene):</div><div><br></div><div><div>(define-syntax regexp-case</div><div>&#xA0; (syntax-rules ()</div><div>&#xA0; &#xA0; ((regexp-case str (pat . body) ...)</div>
<div>&#xA0; &#xA0; &#xA0;(let ((s str))</div><div>&#xA0; &#xA0; &#xA0; &#xA0;(rx-case s () (pat . body) ...)))))</div><div><br></div><div>(define-syntax rx-case</div><div>&#xA0; (syntax-rules ()</div><div>&#xA0; &#xA0; ((rx-case s ((pat (vars ...) . body) ...))</div><div>
&#xA0; &#xA0; &#xA0;(cond</div><div>&#xA0; &#xA0; &#xA0; ((regexp-match `pat s)</div><div>&#xA0; &#xA0; &#xA0; &#xA0;=&gt; (lambda (m)</div><div>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; (let ((vars (rx-match-submatch m s &#39;vars)) ...)</div><div>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; . body)))</div><div>&#xA0; &#xA0; &#xA0; ...</div><div>
&#xA0; &#xA0; &#xA0; (else</div><div>&#xA0; &#xA0; &#xA0; &#xA0;(error &quot;no patterns matched&quot;))))</div><div>&#xA0; &#xA0; ((rx-case s pats (pat . body) . rest)</div><div>&#xA0; &#xA0; &#xA0;(rx-extract pat (rx-case-step s pats (pat . body) . rest)))))</div><div><br></div>
<div>(define-syntax rx-case-step</div><div>&#xA0; (syntax-rules ()</div><div>&#xA0; &#xA0; ((rx-case-step vars s (pats ...) (pat . body) . rest)</div><div>&#xA0; &#xA0; &#xA0;(rx-case s (pats ... (pat vars . body)) . rest))))</div><div><br></div><div>
(define-syntax rx-extract</div><div>&#xA0; (syntax-rules (=&gt; submatch-named unquote unquote-splicing)</div><div>&#xA0; &#xA0; ((rx-extract (=&gt; var sre ...) (k args ...))</div><div>&#xA0; &#xA0; &#xA0;(rx-extract (sre ...) (rx-append (var) (k args ...))))</div>
<div>&#xA0; &#xA0; ((rx-extract (submatch-named var sre ...) (k args ...))</div><div>&#xA0; &#xA0; &#xA0;(rx-extract (sre ...) (rx-append (var) (k args ...))))</div><div>&#xA0; &#xA0; ((rx-extract (unquote x) (k args ...))</div><div>&#xA0; &#xA0; &#xA0;(k () args ...))</div>
<div>&#xA0; &#xA0; ((rx-extract (unquote-splicing x) (k args ...))</div><div>&#xA0; &#xA0; &#xA0;(k () args ...))</div><div>&#xA0; &#xA0; ((rx-extract (x . y) (k args ...))</div><div>&#xA0; &#xA0; &#xA0;(rx-extract x (rx-extract-step y (k args ...))))</div><div>&#xA0; &#xA0; ((rx-extract x (k args ...))</div>
<div>&#xA0; &#xA0; &#xA0;(k () args ...))))</div><div><br></div><div>(define-syntax rx-extract-step</div><div>&#xA0; (syntax-rules ()</div><div>&#xA0; &#xA0; ((rx-extract-step ls y (k ...))</div><div>&#xA0; &#xA0; &#xA0;(rx-extract y (rx-append ls (k ...))))))</div>
<div><br></div><div>(define-syntax rx-append</div><div>&#xA0; (syntax-rules ()</div><div>&#xA0; &#xA0; ((rx-append (a ...) (b ...) (k args ...))</div><div>&#xA0; &#xA0; &#xA0;(k (a ... b ...) args ...))))</div></div><div><br></div><div>A sample usage is:</div>
<div><br></div><div><div>;; Utility to liberally parse dates in any of a variety of common</div><div>;; formats, returning a SRFI-19 date object.</div><div>(define parse-date</div><div>&#xA0; (let ()</div><div>&#xA0; &#xA0; (define (i x) (or (and (string? x) (string-&gt;number x)) 0))</div>
<div>&#xA0; &#xA0; (define (abbrev-rx x n)</div><div>&#xA0; &#xA0; &#xA0; (let ((str (symbol-&gt;string x)))</div><div>&#xA0; &#xA0; &#xA0; &#xA0; `(: ,(substring str 0 n) (? ,(substring str n)))))</div><div>&#xA0; &#xA0; (define (abbrev-ls ls n)</div><div>&#xA0; &#xA0; &#xA0; `(or ,@(map (lambda (x) (abbrev-rx x n)) ls)))</div>
<div>&#xA0; &#xA0; (define wday-en</div><div>&#xA0; &#xA0; &#xA0; &#39;(Sunday Monday Tuesday Wednesday Thursday Friday Saturday))</div><div>&#xA0; &#xA0; (define rx-wday-en (abbrev-ls wday-en 3))</div><div>&#xA0; &#xA0; (define mon-en</div><div>&#xA0; &#xA0; &#xA0; &#39;(January February March April May June July</div>
<div>&#xA0; &#xA0; &#xA0; &#xA0; August September October November December))</div><div>&#xA0; &#xA0; (define rx-mon-en (abbrev-ls mon-en 3))</div><div>&#xA0; &#xA0; (define sep &#39;(: (* space) (? (&quot;-_,;:/&quot;)) (* space)))</div><div>&#xA0; &#xA0; (define d2 &#39;(= 2 digit))</div>
<div>&#xA0; &#xA0; (define d4 &#39;(= 4 digit))</div><div>&#xA0; &#xA0; (define rx-tz</div><div>&#xA0; &#xA0; &#xA0; &#39;(or (: (&quot;+-&quot;) (= 2 digit) (&quot;013&quot;) (&quot;05&quot;))</div><div>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;(: word &quot;/&quot; word)</div><div>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;(: (? &quot;(&quot;) (= 3 alpha) (? &quot;)&quot;))))</div>
<div>&#xA0; &#xA0; (lambda (str)</div><div>&#xA0; &#xA0; &#xA0; (regexp-case</div><div>&#xA0; &#xA0; &#xA0; &#xA0;str</div><div>&#xA0; &#xA0; &#xA0; &#xA0;;; RFC-822 day-month-year-time family</div><div>&#xA0; &#xA0; &#xA0; &#xA0;((w/nocase</div><div>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0;(? ,rx-wday-en ,sep) (=&gt; day ,d2) ,sep</div>
<div>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0;(=&gt; mon ,rx-mon-en) ,sep (=&gt; year ,d4)</div><div>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0;(? ,sep (=&gt; hour ,d2) ,sep (=&gt; min ,d2) ,sep (=&gt; sec ,d2))</div><div>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0;(? ,sep (=&gt; tz ,rx-tz)))</div><div>&#xA0; &#xA0; &#xA0; &#xA0; (make-date 0 (i sec) (i min) (i hour) (i day)</div>
<div>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;(month-&gt;number mon) (i year) (tz-&gt;number tz)))</div><div>&#xA0; &#xA0; &#xA0; &#xA0;;; Unix month-day-time-year family</div><div>&#xA0; &#xA0; &#xA0; &#xA0;((w/nocase</div><div>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0;(? ,rx-wday-en ,sep) (=&gt; mon ,rx-mon-en) ,sep (=&gt; day ,d2)</div>
<div>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0;(? ,sep (=&gt; hour ,d2) ,sep (=&gt; min ,d2) ,sep (=&gt; sec ,d2))</div><div>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0;(? ,sep (=&gt; tz ,rx-tz)) ,sep (=&gt; year ,d4))</div><div>&#xA0; &#xA0; &#xA0; &#xA0; (make-date 0 (i sec) (i min) (i hour) (i day)</div><div>
&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;(month-&gt;number mon) (i year) (tz-&gt;number tz)))&#xA0;</div><div>&#xA0; &#xA0; &#xA0; &#xA0;;; YYYY-MM-DD family</div><div>&#xA0; &#xA0; &#xA0; &#xA0;((w/nocase</div><div>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0;(=&gt; year ,d4) ,sep (=&gt; mon ,d2) ,sep (=&gt; day ,d2)</div>
<div>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0;(? (? &quot;T&quot;) ,sep (=&gt; hour ,d2) ,sep (=&gt; min ,d2) ,sep (=&gt; sec ,d2)</div><div>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; (? ,sep (=&gt; tz ,rx-tz))))</div><div>&#xA0; &#xA0; &#xA0; &#xA0; (make-date 0 (i sec) (i min) (i hour) (i day)</div><div>
&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;(month-&gt;number mon) (i year) (tz-&gt;number tz)))))))</div></div><div><br></div><div><div>(define (month-&gt;number x)</div><div>&#xA0; (case (string-&gt;symbol</div><div>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0;(string-downcase (if (symbol? x) (symbol-&gt;string x) x)))</div>
<div>&#xA0; &#xA0; ((jan) 1) ((feb) 2) ((mar) 3) ((apr) 4)</div><div>&#xA0; &#xA0; ((may) 5) ((jun) 6) ((jul) 7) ((aug) 8)</div><div>&#xA0; &#xA0; ((sep) 9) ((oct) 10) ((nov) 11) ((dec) 12)</div><div>&#xA0; &#xA0; (else #f)))</div><div><br></div><div>(define time-zone-abbrevs</div>
<div>&#xA0; `((&quot;CDT&quot; . ,(* -5 60 60))</div><div>&#xA0; &#xA0; (&quot;CST&quot; . ,(* -6 60 60))</div><div>&#xA0; &#xA0; (&quot;EDT&quot; . ,(* -4 60 60))</div><div>&#xA0; &#xA0; (&quot;EST&quot; . ,(* -5 60 60))</div><div>&#xA0; &#xA0; (&quot;PDT&quot; . ,(* -7 60 60))</div>
<div>&#xA0; &#xA0; (&quot;PST&quot; . ,(* -8 60 60))</div><div>&#xA0; &#xA0; (&quot;NDT&quot; . ,(+ (* -2 60 60) (* -30 60)))</div><div>&#xA0; &#xA0; (&quot;NST&quot; . ,(+ (* -3 60 60) (* -30 60)))</div><div>&#xA0; &#xA0; (&quot;JST&quot; . ,(+ 9 60 60))</div>
<div>&#xA0; &#xA0; (&quot;GMT&quot; . 0)</div><div>&#xA0; &#xA0; (&quot;UTC&quot; . 0)))</div><div><br></div><div>(define (tz-&gt;number x)</div><div>&#xA0; (cond</div><div>&#xA0; &#xA0;((and (string? x)</div><div>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0;(regexp-match &#39;(: ($ (&quot;+-&quot;) (= 2 digit)) ($ (* digit))) x))</div>
<div>&#xA0; &#xA0; =&gt; (lambda (m)</div><div>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0;(* 60 (+ (* 60 (rx-match-submatch m 1)) (rx-match-submatch m 2)))))</div><div>&#xA0; &#xA0;((assoc x time-zone-abbrevs) =&gt; cdr)</div><div>&#xA0; &#xA0;(else 0)))</div></div><div><br></div><blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex">

I have no problem with it as a SRFI, but I think it would be a<br>
mistake for RnRS.<br></blockquote><div><br></div><div>The intention is to include this in the &quot;large&quot; language,</div><div>which is intended to be very large indeed. &#xA0;If you look</div><div>through the &quot;Work Item Dockets&quot; for WG&quot; at</div>
<div><br></div><div>&#xA0; <a rel="nofollow" href="http://trac.sacrideo.us/wg/wiki">http://trac.sacrideo.us/wg/wiki</a><br></div><div><br></div><div>you&#39;ll get an idea of the scope of the large language,</div><div>including threads, networking, gettext, formatting combinators,</div>
<div>loop syntax, pattern matching, and &quot;posix&quot; (which itself includes</div><div>regexps), to name a few. &#xA0;It would be very strange not to include</div><div>a regexp library in this language.</div><div><br></div>
<div>That said, I think regexps are often overused. &#xA0;They</div><div>are just one of many tools, but they&#39;re a tool programmers</div><div>expect to have these days.</div><div><br></div><div>--&#xA0;</div><div>Alex</div><div>
<br></div></div></div></div>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00046" href="msg00046.html">Re: benefits of SRE syntax</a></strong>
<ul><li><em>From:</em> John Cowan</li></ul></li>
<li><strong><a name="00047" href="msg00047.html">Re: benefits of SRE syntax</a></strong>
<ul><li><em>From:</em> Per Bothner</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00021" href="msg00021.html">benefits of SRE syntax</a></strong>
<ul><li><em>From:</em> Michael Montague</li></ul></li>
<li><strong><a name="00023" href="msg00023.html">Re: benefits of SRE syntax</a></strong>
<ul><li><em>From:</em> Per Bothner</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00042.html">Re: Two typos</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00044.html">Re: Two typos</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00023.html">Re: benefits of SRE syntax</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00046.html">Re: benefits of SRE syntax</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00043"><strong>Date</strong></a></li>
<li><a href="threads.html#00043"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</body>
</html>
